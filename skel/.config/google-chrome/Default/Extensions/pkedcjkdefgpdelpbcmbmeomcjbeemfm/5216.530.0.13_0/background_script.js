'use strict';window.navigator.userAgent.match(/Chrome\/([0-9]+)/);var si=function(a,b){this.type=a;this.entryPoint=b};m("castApp.frontEnd.ExtensionMessage",si,void 0);var ti=function(a){return"urn:x-cast:com.google.cast."+a},ui=ti("tp.connection"),vi=ti("receiver"),wi=ti("media"),xi=ti("webrtc"),yi=Xb({dba:ui,eba:ti("tp.heartbeat"),xaa:vi,uL:wi,B$:ti("media.universalRemote.optIn"),wba:xi});var zi={v$:0,m$:1},Ai={rba:0,QL:1,yaa:2},Bi={DIAL:0,z$:1,A$:2,q9:3},Ci={V$:0,TIMEOUT:1,y9:2},Di={qz:0,I8:1,i9:2,L9:3,c9:4,H$:5},Ei=function(a){kh("MediaRouter.Cast.Session.Ended",a,Ai)},Fi=function(a){kh("MediaRouter.Cast.Discovery.Type",a,Bi)},Gi=function(a){kh("MediaRouter.Cast.Session.Fail",a,Ci)};var Hi=function(a){return"available"==a||"available_rescan"==a};var Ii=function(a,b,c,e,f){this.id=a;this.friendlyName=b;this.iconType=c||"generic";this.description=e||null;this.domain=f||null;this.isLaunching_=!1};var Ji=function(a,b){this.cc=this.Re=this.Tf=this.kb=this.la=null;this.nd=new Ii(Rf.O().Bp(b),a);this.Fe={};this.Ao={};this.bl=this.Gv=!1};d=Ji.prototype;d.cg=function(){return this.nd};d.Zl=function(){return this.nd.friendlyName};d.u4=function(a){this.cc=a;return this};d.getId=function(){return this.nd.id};d.Gr=function(a){this.nd.id=a;return this};d.Ir=function(a){this.Gv=a;return this};d.tJ=function(a){this.bl=a;return this};
d.update=function(a){if(this.getId()!=a.getId())return!1;var b=!1;this.nd.friendlyName!=a.nd.friendlyName&&(this.nd.friendlyName=a.nd.friendlyName,b=!0);this.Tf!=a.Tf&&(this.Tf=a.Tf,b=!0);this.Re!=a.Re&&(this.Re=a.Re,b=!0);this.la!=a.la&&(this.la=a.la,b=!0);this.kb!=a.kb&&(this.kb=a.kb,b=!0);return b};d.a4=function(a){this.la=a;return this};d.ub=function(){return this.kb};d.Tk=function(a){this.kb=a;return this};d.x3=function(a){this.Tf=a;return this};d.w3=function(a){this.Re=a;return this};
d.Kd=function(a){return this.Fe[a]||"unknown"};d.GQ=function(a){return this.Ao[a]||null};d.En=function(a,b){this.Fe[a]=b;this.Ao[a]=t();return this};d.ZJ=function(){return"name = "+this.nd.friendlyName+(this.la?", ip = "+this.la:"")+(this.cc?", model = "+this.cc:"")+", apps = "+JSON.stringify(this.Fe)};var Ki=function(a){var b=new Ji(a.nd.friendlyName,"");b.nd.id=a.nd.id;b.la=a.la;b.kb=a.kb;b.Tf=a.Tf;b.Re=a.Re;b.cc=a.cc;b.Fe=a.Fe;b.Ao=a.Ao;b.Gv=a.Gv;b.bl=a.bl;return b};var Mi=function(a,b,c,e,f,g){this.Xd=new Ii(Li(a),b,this.ED(e));this.cc=c||null;this.Zc=e||null;this.la=f||null;this.kb=g||null;this.Fe={};this.Ml=!1},Li=function(a){return Rf.O().Bp(a)},Ni=function(a){if(!a.cc)return null;var b=a.cc;if(!a.la)return null;var c=a.la,e=a.cg().id,f;f=a.cg().friendlyName;f=-1!=f.indexOf("&")?"document"in h?Za(f):$a(f):f;b=new Mi(e,f,b,void 0,c,Rf.O().xl||8009);b.Xd.id=a.cg().id;b.BI(!0);return b};d=Mi.prototype;
d.update=function(a,b,c,e){var f=!1;this.Xd.friendlyName!=a&&(this.Xd.friendlyName=a,f=!0);this.la!=b&&(this.la=b,f=!0);this.kb!=c&&(this.kb=c,f=!0);this.Zc!=e&&(this.Zc=e,f=!0);return f};d.cg=function(){return this.Xd};d.Zl=function(){return this.Xd.friendlyName};d.ED=function(a){return a&1?"cast":a&32?"cast_audio_group":"cast_audio"};d.c3=function(a){this.Zc=a;this.Xd.iconType=this.ED(this.Zc)};d.getId=function(){return this.Xd.id};d.ub=function(){return this.kb};
d.Kd=function(a){return this.Fe[a]||"unknown"};d.En=function(a,b){this.Fe[a]=b};d.ZJ=function(){return"name = "+this.Xd.friendlyName+(this.la?", ip = "+this.la:"")+(this.cc?", model = "+this.cc:"")+", capabilities = "+this.Zc+", apps = "+JSON.stringify(this.Fe)};d.BI=function(a){this.Ml=a};var Oi=function(a,b){this.we=b;this.pA=a;this.pA.W=this.W.bind(this);this.jh=r(this.lH,this);this.Fc=new A;this.Yk=new A;this.jf=new A;this.nw=null;this.zm=this.rg="";this.jj=null;this.mE=this.rm=!1};Oi.prototype.a=C("mr.cast.SinkDiscoveryService");var Pi={serviceType:"_googlecast._tcp.local"};d=Oi.prototype;d.init=function(){qf(this);this.rm&&(this.iF(),this.bC())};d.iF=function(){F(this.a,"Start listening to network changes");chrome.networkingPrivate.onNetworksChanged.addListener(this.bC.bind(this))};
d.start=function(){var a=t();if(chrome.mdns.onServiceList.hasListener(this.jh)){if(6E4>a-this.nw)return;F(this.a,"Forcing mdns discovery");this.nw=a;chrome.mdns.forceDiscovery(ya);chrome.mdns.onServiceList.removeListener(this.jh)}F(this.a,"Adding mdns listener");this.nw=a;chrome.mdns.onServiceList.addListener(this.jh,Pi)};d.stop=function(){F(this.a,"Removing mdns listener");chrome.mdns.onServiceList.removeListener(this.jh)};
d.SO=function(a){if(-1==a.serviceName.indexOf("._googlecast."))return null;var b={};a.serviceData.forEach(function(a){0==a.search(/[a-z]{2}=.+/)&&(b[a.substring(0,2)]=a.substring(3))});var c=b.id;if(!c)return E(this.a,"Missing ID"),null;var e=Li(c),f=Number(a.serviceHostPort.substring(a.serviceHostPort.indexOf(":")+1));if(isNaN(f)||0>f||65535<f)return E(this.a,"Missing or invalid port"),null;if(this.jf.Oa(e)){var g=this.jf.get(e);if(g.la==a.ipAddress&&g.ub()==f)return E(this.a,"Sink has pending connection "+
e),null;E(this.a,"Pending sink changed ip "+e);this.jf.remove(e)}g=b.fn;if(!g||!a.ipAddress)return E(this.a,"Missing friendly name or IP address"),null;var k=Number(b.ca),k=isNaN(k)?0:k;if(e=this.Fc.get(e))return e.update(g,a.ipAddress,f,k)&&(e.BI(!1),this.we.Qc(e)),null;e=b.md;return e?new Mi(c,g,e,k,a.ipAddress,f):(E(this.a,"Missing model name"),null)};d.refresh=function(){G(this.a,"Executing forceDiscovery.");chrome.mdns.forceDiscovery(ya)};
d.lH=function(a){F(this.a,"Registering "+a.length+" devices");this.TO(a).forEach(this.OX,this)};d.uA=function(a,b){this.jf.Oa(a.getId())||(this.jf.set(a.getId(),a),this.yl(a).then(function(c){c?(c=this.Fc.get(a.getId()),b&&(c?c.Ml&&Fi(3):Fi(1)),this.so(a)):F(this.a,"Inaccessible sink: "+a.getId())},null,this).Bb(function(){this.jf.remove(a.getId());0==this.jf.N()&&this.ir()},this))};d.OX=function(a){this.uA(a,!0)};d.TO=function(a){var b=[];a.forEach(function(a){(a=this.SO(a))&&b.push(a)},this);return b};
d.so=function(a){F(this.a,"Adding sink "+a.getId());var b=this.Fc.get(a.getId()),c=null,e=a.la,f=a.ub();null!=e&&null!=f&&(c=this.Yk.get(e+":"+f));if(b&&!c){var g=a.la,k=a.ub();g&&k&&this.Yk.remove(g+":"+k)}c&&!b&&this.Fc.remove(c.getId());this.Fc.set(a.getId(),a);null!=e&&null!=f&&this.Yk.set(e+":"+f,a);this.rm||(this.rm=!0,this.iF());this.we.$h(a);Rf.O().gi=new Qf(a.cc,a.la)};d.xw=function(a){F(this.a,"Channel error for sink "+a);this.nn(a)};
d.nn=function(a){var b=this.Fc.get(a);if(b){F(this.a,"Removing sink "+a);this.Fc.remove(a);a=b.la;var c=b.ub();null!=a&&null!=c&&this.Yk.remove(a+":"+c);this.we.Xq(b)}};d.e1=function(){var a=this.Fc.A();this.Fc.clear();this.Yk.clear();a.forEach(this.we.Xq,this.we)};d.yl=function(a){G(this.a,"Checking access to "+a.getId());return this.pA.cj(a).then(function(b){if(a.Ml){var c=4;b.audioOnly||(c|=1);a.c3(c)}return!0},function(){return!1})};
d.ir=function(){F(this.a,"Pruning inactive sinks.");Gc(this.km(),function(a){this.jf.set(a.getId(),a);this.yl(a).then(function(b){b||this.nn(a.getId())},null,this).Bb(function(){this.jf.remove(a.getId())},this)},this)};d.W=function(a){return this.Fc.get(a,null)};d.JU=function(a,b){return this.Yk.get(a+":"+b)};d.KU=function(a){var b=[];Gc(this.km(),function(c){Hi(c.Kd(a))&&b.push(c)});return b};d.km=function(){return this.Fc.lv()};d.Qc=function(a){this.we.Qc(a)};d.mc=function(){return this.Fc.A()};
var Qi=function(a,b){this.sinkMap=a;this.networkIds=b;this.version=2},Ri=function(a){this.hasSavedSinks=a};d=Oi.prototype;d.Ra=function(){return"cast.SinkDiscoveryService"};d.getData=function(){var a={};Gc(this.Fc.VC(),function(b){var c;c=this.Fc.get(b);c={id:c.getId(),ip:c.la,port:c.ub(),friendlyName:c.Zl(),modelName:c.cc,capabilities:c.Zc};a[b]=c},this);return[new Qi(a,this.zm),new Ri(this.rm)]};
d.wb=function(){var a=nf(this);a&&2==a.version&&(this.zm=a.networkIds,this.mF(a.sinkMap));if(a=of(this))this.rm=a.hasSavedSinks};d.mF=function(a){this.mE=0<Object.keys(a).length;for(var b in a){var c;c=a[b];var e=new Mi("",c.friendlyName,c.modelName,c.capabilities,c.ip,c.port);e.Xd.id=c.id;c=e;this.W(c.getId())||this.uA(c,!1)}};
d.bC=function(){F(this.a,"Fetching networks state");this.jj&&yf(this.jj);chrome.networkingPrivate.getNetworks({networkType:"All",visible:!0,configured:!0},function(a){for(var b=[],c=0;c<a.length;c++)"Connected"==a[c].ConnectionState&&b.push(a[c].GUID);this.z7(b.sort().join(","))}.bind(this))};
d.z7=function(a){F(this.a,"Update current network "+Si(a));a!=this.rg&&(this.jj&&(pf.remove(this.jj.Ra()),this.jj=null),a?(this.zm&&a!=this.zm?this.e1():this.ir(),this.zm=this.rg=a,this.jj=new Ti(this,this.rg)):this.rg="")};var Si=function(a){for(var b=0,c=0;c<a.length;c++)b+=a.charCodeAt(c);return b},Ti=function(a,b){this.Vc=a;this.rg=b;qf(this)};Ti.prototype.Ra=function(){return"cast.NetworkSink."+this.rg};
Ti.prototype.getData=function(){var a=null,b=this.Vc.getData();b&&(this.Vc.mE||0<this.Vc.mc().length)&&(a=b[0]);F(this.Vc.a,"Saving sink data for network "+Si(this.rg));return[null,a]};Ti.prototype.wb=function(){F(this.Vc.a,"Restoring sink data for network "+Si(this.rg));var a=of(this);a&&2==a.version&&this.Vc.mF(a.sinkMap)};var Ui={STOP_MEDIA:"STOP",MEDIA_SET_VOLUME:"SET_VOLUME",MEDIA_GET_STATUS:"GET_STATUS"};var Vi=function(){this.type="GET_STATUS";this.requestId=0};var Wi=function(a){this.type="LAUNCH";this.requestId=0;this.appId=a;this.language=null};var Xi=function(a){this.type="STOP";this.requestId=0;this.sessionId=a||null};var Yi=function(a,b){this.requestId=a;this.j7=b;this.YJ=null};Yi.prototype.Aw=function(){};var Zi=function(){this.Jb=new A};Zi.prototype.Ez=function(a){this.Jb.set(a.requestId,a);a.YJ=setTimeout(this.SZ.bind(this,a),a.j7)};Zi.prototype.ln=function(a){var b=this.Jb.get(a);if(!b)return null;clearTimeout(b.YJ);this.Jb.remove(a);return b};Zi.prototype.xh=function(a){return this.Jb.get(a,null)};Zi.prototype.SZ=function(a){this.Jb.remove(a.requestId);a.Aw()};var aj=function(a){this.S6=a;this.mk=1E3*Math.floor(1E6*Math.random())};d=aj.prototype;d.vB=function(){qf(this)};d.Tp=function(){var a=this.mk++;0==a&&(a=this.mk++);return a};d.Ra=function(){return"IdGenerator."+this.S6};d.getData=function(){return[this.mk]};d.wb=function(){var a=nf(this);a&&(this.mk=a)};var bj=function(a,b){this.vc=a;this.Uc=b;this.ci=new Zi;this.zH=new aj("cast.RequestIdGenerator")};bj.prototype.init=function(){this.zH.vB()};var cj=function(a,b,c,e){Yi.call(this,a,c);this.mb=b;this.sourceId=e};u(cj,Yi);cj.prototype.Aw=function(){this.mb.reject(dj)};bj.prototype.Fz=function(a,b,c){var e=this.zH.Tp();a.requestId=e;a=J();b=new cj(e,a,q(b)&&0<b?b:6E5,c);this.ci.Ez(b);return b};bj.prototype.ux=function(a){this.ci.ln(a.requestId)};bj.prototype.ln=function(a){return this.ci.ln(a)};
var dj=Error("Timeout"),ej=Error("Failed to send message");bj.prototype.sendRequest=function(a,b,c,e,f,g){if(!yi.hasOwnProperty(c))return I(Error("Custom namespace is not supported"));var k=this.Fz(a,l(e)?e:3E3,f),p=k.mb;this.vc.xr(b,c,a,f||this.Uc,g).then(null,function(){this.ux(k);p.reject(ej)},this);return p.promise};
bj.prototype.sendMessage=function(a,b,c,e,f,g){var k=this.Fz(a,l(e)?e:3E3,f),p=k.mb;this.vc.xr(b,c,a,f||this.Uc,g).then(function(){this.ux(k);p.resolve(!0)},function(){this.ux(k);p.reject(ej)},this);return p.promise};bj.prototype.D1=function(a,b){var c=new Wi(a.appId);c.language=a.language?a.language:chrome.i18n.getUILanguage?chrome.i18n.getUILanguage():chrome.runtime.getManifest().default_locale;return this.sendRequest(c,b,vi,a.requestSessionTimeout)};
bj.prototype.G1=function(a,b){return this.sendRequest(new Xi(a),b,vi)};var fj=function(a,b){this.type="cast_app";this.originId=window["castApp.eventPage.Message.OriginID"]||void 0;this.subtype=a;this.devices=b};m("castApp.eventPage.Message",fj,void 0);var gj=function(a,b,c){this.ipAddress=a;this.appId=b;this.sessionId=c};fj.DeviceData=gj;var hj=function(a,b){this.sc=a;this.$c=b;this.nj=new A;this.kh=new Sc;this.VE=0;this.ZX=new A("serviceCheck",this.WV.bind(this),"startDeviceMonitor",this.dW.bind(this),"releaseDeviceMonitor",this.RV.bind(this));chrome.runtime.onMessage.addListener(this.MV.bind(this));chrome.runtime.onMessageExternal.addListener(this.GV.bind(this));this.te("serviceReady")};d=hj.prototype;d.a=C("castApp.eventPage.Service");d.wL=3E4;
d.bW=function(){if(this.vA()){var a=new Sc;Gc(this.sc.km(),function(b){var e=b.la;a.add(e);this.nj.Oa(e)||this.$c.sendRequest(new Vi,b,vi)}.bind(this));var b=!1;this.nj.cb().forEach(function(c){a.contains(c)||(this.nj.remove(c),b=!0)}.bind(this));b&&this.pt()}};
d.zV=function(a,b){if(this.vA()&&yi.hasOwnProperty(b.namespace_)&&(a=a.la)&&(b=JSON.parse(b.data),"RECEIVER_STATUS"===b.type)){var c=b.status&&b.status.applications&&b.status.applications[0],e=b=null;c&&(c.appId&&(b=c.appId),c.sessionId&&(e=c.sessionId));c=this.nj.get(a);this.nj.set(a,new gj(a,b,e));c&&c.appId===b||this.pt()}};
d.vA=function(){if(0===this.kh.N())return!1;var a=t();if(a-this.VE>this.wL){this.VE=a;var b=[];chrome.extension.getViews().forEach(function(a){(a=a["castApp.eventPage.Message.OriginID"])&&b.push(a)}.bind(this));this.kh=this.kh.zE(b);F(this.a,"monitor client count: "+this.kh.N())}return 0<this.kh.N()};
d.MV=function(a,b,c){if("object"!==typeof a||"cast_app"!==a.type)return!1;var e=this.ZX.get(a.subtype);if(!e)return!1;if(!a.originId)return hb("Missing origin ID in the incoming message."),!1;try{var f=e(a,b,c);f&&c(f)}catch(g){D(this.a,"Error while handling request",g)}return!1};d.te=function(a,b){a=new fj(a,b);F(this.a,"Sending message: "+JSON.stringify(a));chrome.runtime.sendMessage(a)};d.WV=function(){this.te("serviceReady")};
d.dW=function(a){F(this.a,"Registering monitor client: "+a.originId);this.kh.add(a.originId);this.pt();this.V0()};d.RV=function(a){F(this.a,"Unregistering monitor client: "+a.originId);this.kh.remove(a.originId)};d.pt=function(){var a=this.nj.A();this.te("devices",a)};d.V0=function(){this.sc.refresh();this.sc.mc().forEach(function(a){this.$c.sendRequest(new Vi,a,vi)}.bind(this))};
d.GV=function(a,b,c){switch(a.type){case "handshake":c(new si("handshake"));break;case "launch":b=b.tab&&q(b.tab.id)?b.tab.id:null,null===b||"setup"!==a.entryPoint&&"offers"!==a.entryPoint&&"devices"!==a.entryPoint||chrome.tabs.update(b,{url:"chrome-extension://"+chrome.runtime.id+"/cast_setup/"+a.entryPoint+".html"})}};chrome.cast.Be={CUSTOM_CONTROLLER_SCOPED:"custom_controller_scoped",TAB_AND_ORIGIN_SCOPED:"tab_and_origin_scoped",ORIGIN_SCOPED:"origin_scoped",PAGE_SCOPED:"page_scoped"};m("chrome.cast.AutoJoinPolicy",chrome.cast.Be,void 0);chrome.cast.mo={CREATE_SESSION:"create_session",CAST_THIS_TAB:"cast_this_tab"};m("chrome.cast.DefaultActionPolicy",chrome.cast.mo,void 0);chrome.cast.Bf={VIDEO_OUT:"video_out",AUDIO_OUT:"audio_out",VIDEO_IN:"video_in",AUDIO_IN:"audio_in",MULTIZONE_GROUP:"multizone_group"};
m("chrome.cast.Capability",chrome.cast.Bf,void 0);chrome.cast.Ce={CANCEL:"cancel",TIMEOUT:"timeout",API_NOT_INITIALIZED:"api_not_initialized",INVALID_PARAMETER:"invalid_parameter",EXTENSION_NOT_COMPATIBLE:"extension_not_compatible",EXTENSION_MISSING:"extension_missing",RECEIVER_UNAVAILABLE:"receiver_unavailable",SESSION_ERROR:"session_error",CHANNEL_ERROR:"channel_error",LOAD_MEDIA_FAILED:"load_media_failed"};m("chrome.cast.ErrorCode",chrome.cast.Ce,void 0);chrome.cast.RL={AVAILABLE:"available",UNAVAILABLE:"unavailable"};
m("chrome.cast.ReceiverAvailability",chrome.cast.RL,void 0);chrome.cast.aM={CHROME:"chrome",IOS:"ios",ANDROID:"android"};m("chrome.cast.SenderPlatform",chrome.cast.aM,void 0);chrome.cast.oo={CAST:"cast",DIAL:"dial",HANGOUT:"hangout",CUSTOM:"custom"};m("chrome.cast.ReceiverType",chrome.cast.oo,void 0);chrome.cast.fL={RUNNING:"running",STOPPED:"stopped",ERROR:"error"};m("chrome.cast.DialAppState",chrome.cast.fL,void 0);chrome.cast.nl={CAST:"cast",STOP:"stop"};
m("chrome.cast.ReceiverAction",chrome.cast.nl,void 0);chrome.cast.mz={CONNECTED:"connected",DISCONNECTED:"disconnected",STOPPED:"stopped"};m("chrome.cast.SessionStatus",chrome.cast.mz,void 0);chrome.cast.VERSION=[1,2];m("chrome.cast.VERSION",chrome.cast.VERSION,void 0);chrome.cast.Y7=!0;m("chrome.cast.usingPresentationApi",chrome.cast.Y7,void 0);chrome.cast.Error=function(a,b,c){this.code=a;this.description=b||null;this.details=c||null};m("chrome.cast.Error",chrome.cast.Error,void 0);chrome.cast.$L=function(a){this.platform=a;this.packageId=this.url=null};m("chrome.cast.SenderApplication",chrome.cast.$L,void 0);chrome.cast.Image=function(a){this.url=a;this.width=this.height=null};
m("chrome.cast.Image",chrome.cast.Image,void 0);chrome.cast.Volume=function(a,b){this.level=l(a)?a:null;this.muted=l(b)?b:null};m("chrome.cast.Volume",chrome.cast.Volume,void 0);chrome.cast.YK=function(a,b,c,e,f){this.sessionRequest=a;this.sessionListener=b;this.receiverListener=c;this.autoJoinPolicy=e||chrome.cast.Be.TAB_AND_ORIGIN_SCOPED;this.defaultActionPolicy=f||chrome.cast.mo.CREATE_SESSION;this.customDialLaunchCallback=null;this.invisibleSender=!1;this.additionalSessionRequests=[]};m("chrome.cast.ApiConfig",chrome.cast.YK,void 0);chrome.cast.hL=function(a,b){this.appName=a;this.launchParameter=b||null};m("chrome.cast.DialRequest",chrome.cast.hL,void 0);
chrome.cast.ez=function(a,b,c){this.receiver=a;this.appState=b;this.extraData=c||null};m("chrome.cast.DialLaunchData",chrome.cast.ez,void 0);chrome.cast.gL=function(a,b){this.doLaunch=a;this.launchParameter=b||null};m("chrome.cast.DialLaunchResponse",chrome.cast.gL,void 0);chrome.cast.lz=function(a,b,c){this.appId=a;this.capabilities=Ca(b)?b:[chrome.cast.Bf.VIDEO_OUT,chrome.cast.Bf.AUDIO_OUT];this.requestSessionTimeout=c||chrome.cast.timeout.requestSession;this.dialRequest=this.language=null};
m("chrome.cast.SessionRequest",chrome.cast.lz,void 0);chrome.cast.Ms=function(a,b,c,e){this.label=a;this.friendlyName=b;this.capabilities=c||[];this.volume=e||null;this.receiverType=chrome.cast.oo.CAST;this.displayStatus=this.isActiveInput=null};m("chrome.cast.Receiver",chrome.cast.Ms,void 0);chrome.cast.SL=function(a,b){this.statusText=a;this.appImages=b;this.showStop=null};m("chrome.cast.ReceiverDisplayStatus",chrome.cast.SL,void 0);
chrome.cast.pz=function(){this.requestSession=6E4;this.sendCustomMessage=this.setReceiverVolume=this.stopSession=this.leaveSession=3E3};m("chrome.cast.Timeout",chrome.cast.pz,void 0);chrome.cast.timeout=new chrome.cast.pz;m("chrome.cast.timeout",chrome.cast.timeout,void 0);chrome.cast.XK="auto-join";chrome.cast.iz="cast-session_";chrome.cast.media.ml={PAUSE:"pause",SEEK:"seek",STREAM_VOLUME:"stream_volume",STREAM_MUTE:"stream_mute"};m("chrome.cast.media.MediaCommand",chrome.cast.media.ml,void 0);chrome.cast.media.yd={GENERIC:0,MOVIE:1,TV_SHOW:2,MUSIC_TRACK:3,PHOTO:4};m("chrome.cast.media.MetadataType",chrome.cast.media.yd,void 0);chrome.cast.media.no={IDLE:"IDLE",PLAYING:"PLAYING",PAUSED:"PAUSED",BUFFERING:"BUFFERING"};m("chrome.cast.media.PlayerState",chrome.cast.media.no,void 0);
chrome.cast.media.Ns={OFF:"REPEAT_OFF",ALL:"REPEAT_ALL",SINGLE:"REPEAT_SINGLE",ALL_AND_SHUFFLE:"REPEAT_ALL_AND_SHUFFLE"};m("chrome.cast.media.RepeatMode",chrome.cast.media.Ns,void 0);chrome.cast.media.TL={PLAYBACK_START:"PLAYBACK_START",PLAYBACK_PAUSE:"PLAYBACK_PAUSE"};m("chrome.cast.media.ResumeState",chrome.cast.media.TL,void 0);chrome.cast.media.nz={BUFFERED:"BUFFERED",LIVE:"LIVE",OTHER:"OTHER"};m("chrome.cast.media.StreamType",chrome.cast.media.nz,void 0);
chrome.cast.media.nL={CANCELLED:"CANCELLED",INTERRUPTED:"INTERRUPTED",FINISHED:"FINISHED",ERROR:"ERROR"};m("chrome.cast.media.IdleReason",chrome.cast.media.nL,void 0);chrome.cast.media.kM={TEXT:"TEXT",AUDIO:"AUDIO",VIDEO:"VIDEO"};m("chrome.cast.media.TrackType",chrome.cast.media.kM,void 0);chrome.cast.media.hM={SUBTITLES:"SUBTITLES",CAPTIONS:"CAPTIONS",DESCRIPTIONS:"DESCRIPTIONS",CHAPTERS:"CHAPTERS",METADATA:"METADATA"};m("chrome.cast.media.TextTrackType",chrome.cast.media.hM,void 0);
chrome.cast.media.dM={NONE:"NONE",OUTLINE:"OUTLINE",DROP_SHADOW:"DROP_SHADOW",RAISED:"RAISED",DEPRESSED:"DEPRESSED"};m("chrome.cast.media.TextTrackEdgeType",chrome.cast.media.dM,void 0);chrome.cast.media.iM={NONE:"NONE",NORMAL:"NORMAL",ROUNDED_CORNERS:"ROUNDED_CORNERS"};m("chrome.cast.media.TextTrackWindowType",chrome.cast.media.iM,void 0);
chrome.cast.media.eM={SANS_SERIF:"SANS_SERIF",MONOSPACED_SANS_SERIF:"MONOSPACED_SANS_SERIF",SERIF:"SERIF",MONOSPACED_SERIF:"MONOSPACED_SERIF",CASUAL:"CASUAL",CURSIVE:"CURSIVE",SMALL_CAPITALS:"SMALL_CAPITALS"};m("chrome.cast.media.TextTrackFontGenericFamily",chrome.cast.media.eM,void 0);chrome.cast.media.fM={NORMAL:"NORMAL",BOLD:"BOLD",BOLD_ITALIC:"BOLD_ITALIC",ITALIC:"ITALIC"};m("chrome.cast.media.TextTrackFontStyle",chrome.cast.media.fM,void 0);chrome.cast.media.lL=function(){this.customData=null};m("chrome.cast.media.GetStatusRequest",chrome.cast.media.lL,void 0);chrome.cast.media.EL=function(){this.customData=null};m("chrome.cast.media.PauseRequest",chrome.cast.media.EL,void 0);chrome.cast.media.GL=function(){this.customData=null};m("chrome.cast.media.PlayRequest",chrome.cast.media.GL,void 0);chrome.cast.media.ZL=function(){this.customData=this.resumeState=this.currentTime=null};m("chrome.cast.media.SeekRequest",chrome.cast.media.ZL,void 0);
chrome.cast.media.bM=function(){this.customData=null};m("chrome.cast.media.StopRequest",chrome.cast.media.bM,void 0);chrome.cast.media.nM=function(a){this.volume=a;this.customData=null};m("chrome.cast.media.VolumeRequest",chrome.cast.media.nM,void 0);chrome.cast.media.qL=function(a){this.type="LOAD";this.requestId=0;this.sessionId=null;this.media=a;this.activeTrackIds=null;this.autoplay=!0;this.customData=this.currentTime=null};m("chrome.cast.media.LoadRequest",chrome.cast.media.qL,void 0);
chrome.cast.media.jL=function(a,b){this.requestId=0;this.activeTrackIds=a||null;this.textTrackStyle=b||null};m("chrome.cast.media.EditTracksInfoRequest",chrome.cast.media.jL,void 0);chrome.cast.media.kL=function(){this.metadataType=this.type=chrome.cast.media.yd.GENERIC;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.title=null};m("chrome.cast.media.GenericMediaMetadata",chrome.cast.media.kL,void 0);
chrome.cast.media.yL=function(){this.metadataType=this.type=chrome.cast.media.yd.MOVIE;this.releaseDate=this.releaseYear=this.images=this.subtitle=this.studio=this.title=null};m("chrome.cast.media.MovieMediaMetadata",chrome.cast.media.yL,void 0);chrome.cast.media.lM=function(){this.metadataType=this.type=chrome.cast.media.yd.TV_SHOW;this.originalAirdate=this.releaseYear=this.images=this.episode=this.episodeNumber=this.season=this.seasonNumber=this.episodeTitle=this.title=this.seriesTitle=null};
m("chrome.cast.media.TvShowMediaMetadata",chrome.cast.media.lM,void 0);chrome.cast.media.zL=function(){this.metadataType=this.type=chrome.cast.media.yd.MUSIC_TRACK;this.releaseDate=this.releaseYear=this.images=this.discNumber=this.trackNumber=this.artistName=this.songName=this.composer=this.artist=this.albumArtist=this.title=this.albumName=null};m("chrome.cast.media.MusicTrackMediaMetadata",chrome.cast.media.zL,void 0);
chrome.cast.media.FL=function(){this.metadataType=this.type=chrome.cast.media.yd.PHOTO;this.creationDateTime=this.height=this.width=this.longitude=this.latitude=this.images=this.location=this.artist=this.title=null};m("chrome.cast.media.PhotoMediaMetadata",chrome.cast.media.FL,void 0);chrome.cast.media.xL=function(a,b){this.contentId=a;this.streamType=chrome.cast.media.nz.BUFFERED;this.contentType=b;this.customData=this.textTrackStyle=this.tracks=this.duration=this.metadata=null};
m("chrome.cast.media.MediaInfo",chrome.cast.media.xL,void 0);chrome.cast.media.IL=function(a){this.itemId=null;this.media=a;this.autoplay=!0;this.startTime=0;this.playbackDuration=null;this.preloadTime=0;this.customData=this.activeTrackIds=null};m("chrome.cast.media.QueueItem",chrome.cast.media.IL,void 0);chrome.cast.media.dL="CC1AD845";m("chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID",chrome.cast.media.dL,void 0);chrome.cast.media.timeout={};
m("chrome.cast.media.timeout",chrome.cast.media.timeout,void 0);chrome.cast.media.timeout.load=0;chrome.cast.media.timeout.load=chrome.cast.media.timeout.load;chrome.cast.media.timeout.Qa=0;chrome.cast.media.timeout.getStatus=chrome.cast.media.timeout.Qa;chrome.cast.media.timeout.play=0;chrome.cast.media.timeout.play=chrome.cast.media.timeout.play;chrome.cast.media.timeout.pause=0;chrome.cast.media.timeout.pause=chrome.cast.media.timeout.pause;chrome.cast.media.timeout.seek=0;
chrome.cast.media.timeout.seek=chrome.cast.media.timeout.seek;chrome.cast.media.timeout.stop=0;chrome.cast.media.timeout.stop=chrome.cast.media.timeout.stop;chrome.cast.media.timeout.Uk=0;chrome.cast.media.timeout.setVolume=chrome.cast.media.timeout.Uk;chrome.cast.media.timeout.bu=0;chrome.cast.media.timeout.editTracksInfo=chrome.cast.media.timeout.bu;chrome.cast.media.timeout.z0=0;chrome.cast.media.timeout.queue=chrome.cast.media.timeout.z0;
chrome.cast.media.jM=function(a,b){this.trackId=a;this.trackContentType=this.trackContentId=null;this.type=b;this.customData=this.subtype=this.language=this.name=null};m("chrome.cast.media.Track",chrome.cast.media.jM,void 0);chrome.cast.media.gM=function(){this.customData=this.fontStyle=this.fontGenericFamily=this.fontFamily=this.fontScale=this.windowRoundedCornerRadius=this.windowColor=this.windowType=this.edgeColor=this.edgeType=this.backgroundColor=this.foregroundColor=null};
m("chrome.cast.media.TextTrackStyle",chrome.cast.media.gM,void 0);chrome.cast.media.KL=function(a){this.type="QUEUE_LOAD";this.sessionId=this.requestId=null;this.items=a;this.startIndex=0;this.repeatMode=chrome.cast.media.Ns.OFF;this.customData=null};m("chrome.cast.media.QueueLoadRequest",chrome.cast.media.KL,void 0);chrome.cast.media.HL=function(a){this.type="QUEUE_INSERT";this.sessionId=this.requestId=null;this.items=a;this.customData=this.insertBefore=null};
m("chrome.cast.media.QueueInsertItemsRequest",chrome.cast.media.HL,void 0);chrome.cast.media.OL=function(a){this.type="QUEUE_UPDATE";this.sessionId=this.requestId=null;this.items=a;this.customData=null};m("chrome.cast.media.QueueUpdateItemsRequest",chrome.cast.media.OL,void 0);chrome.cast.media.JL=function(){this.type="QUEUE_UPDATE";this.customData=this.jump=this.currentItemId=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueJumpRequest",chrome.cast.media.JL,void 0);
chrome.cast.media.NL=function(){this.type="QUEUE_UPDATE";this.customData=this.repeatMode=this.sessionId=this.requestId=null};m("chrome.cast.media.QueueSetPropertiesRequest",chrome.cast.media.NL,void 0);chrome.cast.media.LL=function(a){this.type="QUEUE_REMOVE";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=null};m("chrome.cast.media.QueueRemoveItemsRequest",chrome.cast.media.LL,void 0);
chrome.cast.media.ML=function(a){this.type="QUEUE_REORDER";this.sessionId=this.requestId=null;this.itemIds=a;this.customData=this.insertBefore=null};m("chrome.cast.media.QueueReorderItemsRequest",chrome.cast.media.ML,void 0);chrome.cast.media.u=function(a,b){this.sessionId=a;this.mediaSessionId=b;this.media=null;this.playbackRate=1;this.playerState=chrome.cast.media.no.IDLE;this.currentTime=0;this.QE=-1;this.supportedMediaCommands=[];this.volume=new chrome.cast.Volume;this.items=this.preloadedItemId=this.loadingItemId=this.currentItemId=this.customData=this.activeTrackIds=this.idleReason=null;this.repeatMode=chrome.cast.media.Ns.OFF};m("chrome.cast.media.Media",chrome.cast.media.u,void 0);
chrome.cast.media.u.prototype.Qa=function(){};chrome.cast.media.u.prototype.getStatus=chrome.cast.media.u.prototype.Qa;chrome.cast.media.u.prototype.play=function(){};chrome.cast.media.u.prototype.play=chrome.cast.media.u.prototype.play;chrome.cast.media.u.prototype.pause=function(){};chrome.cast.media.u.prototype.pause=chrome.cast.media.u.prototype.pause;chrome.cast.media.u.prototype.seek=function(){};chrome.cast.media.u.prototype.seek=chrome.cast.media.u.prototype.seek;
chrome.cast.media.u.prototype.stop=function(){};chrome.cast.media.u.prototype.stop=chrome.cast.media.u.prototype.stop;chrome.cast.media.u.prototype.Uk=function(){};chrome.cast.media.u.prototype.setVolume=chrome.cast.media.u.prototype.Uk;chrome.cast.media.u.prototype.bu=function(){};chrome.cast.media.u.prototype.editTracksInfo=chrome.cast.media.u.prototype.bu;chrome.cast.media.u.prototype.C0=function(){};chrome.cast.media.u.prototype.queueInsertItems=chrome.cast.media.u.prototype.C0;
chrome.cast.media.u.prototype.A0=function(){};chrome.cast.media.u.prototype.queueAppendItem=chrome.cast.media.u.prototype.A0;chrome.cast.media.u.prototype.M0=function(){};chrome.cast.media.u.prototype.queueUpdateItems=chrome.cast.media.u.prototype.M0;chrome.cast.media.u.prototype.H0=function(){};chrome.cast.media.u.prototype.queuePrev=chrome.cast.media.u.prototype.H0;chrome.cast.media.u.prototype.G0=function(){};chrome.cast.media.u.prototype.queueNext=chrome.cast.media.u.prototype.G0;
chrome.cast.media.u.prototype.D0=function(a){this.Ku(a)};chrome.cast.media.u.prototype.queueJumpToItem=chrome.cast.media.u.prototype.D0;chrome.cast.media.u.prototype.L0=function(){};chrome.cast.media.u.prototype.queueSetRepeatMode=chrome.cast.media.u.prototype.L0;chrome.cast.media.u.prototype.J0=function(){};chrome.cast.media.u.prototype.queueRemoveItems=chrome.cast.media.u.prototype.J0;chrome.cast.media.u.prototype.I0=function(a){this.Ku(a)};chrome.cast.media.u.prototype.queueRemoveItem=chrome.cast.media.u.prototype.I0;
chrome.cast.media.u.prototype.K0=function(){};chrome.cast.media.u.prototype.queueReorderItems=chrome.cast.media.u.prototype.K0;chrome.cast.media.u.prototype.F0=function(a,b,c,e){a=this.Ku(a);0>a||(0>b?e&&e(new chrome.cast.Error(chrome.cast.Ce.INVALID_PARAMETER)):a==b&&c&&c())};chrome.cast.media.u.prototype.queueMoveItemToNewIndex=chrome.cast.media.u.prototype.F0;chrome.cast.media.u.prototype.a7=function(a){return-1<this.supportedMediaCommands.indexOf(a)};
chrome.cast.media.u.prototype.supportsCommand=chrome.cast.media.u.prototype.a7;chrome.cast.media.u.prototype.ZR=function(){if(this.playerState==chrome.cast.media.no.PLAYING&&0<=this.QE){var a=(t()-this.QE)/1E3,a=this.currentTime+this.playbackRate*a;this.media&&null!=this.media.duration&&a>this.media.duration&&(a=this.media.duration);0>a&&(a=0);return a}return this.currentTime};chrome.cast.media.u.prototype.getEstimatedTime=chrome.cast.media.u.prototype.ZR;chrome.cast.media.u.prototype.Ys=function(){};
chrome.cast.media.u.prototype.addUpdateListener=chrome.cast.media.u.prototype.Ys;chrome.cast.media.u.prototype.wx=function(){};chrome.cast.media.u.prototype.removeUpdateListener=chrome.cast.media.u.prototype.wx;chrome.cast.media.u.prototype.Ku=function(a){return pb(this.items,function(b){return b.itemId==a})};var ij=function(a,b,c){this.sessionId=a;this.namespaceName=b;this.message=c};var jj=function(a){this.$c=a;this.a=C("mr.cast.ReceiverStatusQuerier")};jj.prototype.G6=function(a){return(new Sf(r(this.y0,this,a),3500,5)).Cr(2).start().na(function(b){F(this.a,"Failed to get receiver status from "+a.getId());throw b;},this)};jj.prototype.y0=function(a){F(this.a,"Query receiver status: "+a.getId());return this.$c.sendRequest(new Vi,a,vi)};var kj=function(a,b){this.type="SET_VOLUME";this.requestId=0;this.volume=a;this.expectedVolume=b||null};chrome.cast.T=function(a,b,c,e,f){this.sessionId=a;this.appId=b;this.displayName=c;this.statusText=null;this.appImages=e;this.receiver=f;this.senderApps=[];this.namespaces=[];this.media=[];this.status=chrome.cast.mz.CONNECTED;this.transportId=""};m("chrome.cast.Session",chrome.cast.T,void 0);chrome.cast.T.prototype.l5=function(a,b,c){a=new kj(new chrome.cast.Volume(a,null),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverVolumeLevel=chrome.cast.T.prototype.l5;
chrome.cast.T.prototype.k5=function(a,b,c){a=new kj(new chrome.cast.Volume(null,a),this.receiver.volume);null.setReceiverVolume(this.sessionId,a,b,c)};chrome.cast.T.prototype.setReceiverMuted=chrome.cast.T.prototype.k5;chrome.cast.T.prototype.leave=function(a,b){null.leaveSession(this.sessionId,a,b)};chrome.cast.T.prototype.leave=chrome.cast.T.prototype.leave;chrome.cast.T.prototype.stop=function(){};chrome.cast.T.prototype.stop=chrome.cast.T.prototype.stop;chrome.cast.T.prototype.sendMessage=function(){};
chrome.cast.T.prototype.sendMessage=chrome.cast.T.prototype.sendMessage;chrome.cast.T.prototype.Ys=function(){};chrome.cast.T.prototype.addUpdateListener=chrome.cast.T.prototype.Ys;chrome.cast.T.prototype.wx=function(){};chrome.cast.T.prototype.removeUpdateListener=chrome.cast.T.prototype.wx;chrome.cast.T.prototype.EM=function(){};chrome.cast.T.prototype.addMessageListener=chrome.cast.T.prototype.EM;chrome.cast.T.prototype.DM=function(){};chrome.cast.T.prototype.addMediaListener=chrome.cast.T.prototype.DM;
chrome.cast.T.prototype.p1=function(){};chrome.cast.T.prototype.removeMediaListener=chrome.cast.T.prototype.p1;chrome.cast.T.prototype.q1=function(){};chrome.cast.T.prototype.removeMessageListener=chrome.cast.T.prototype.q1;chrome.cast.T.prototype.wX=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.loadMedia=chrome.cast.T.prototype.wX;chrome.cast.T.prototype.E0=function(a){a.sessionId=this.sessionId};chrome.cast.T.prototype.queueLoad=chrome.cast.T.prototype.E0;var nj=function(a,b){if(!b.applications||1!=b.applications.length)return null;var c=b.applications[0];a=lj(a);a=new chrome.cast.T(c.sessionId,c.appId,c.displayName,c.appImages,a);a.senderApps=c.senderApps;a.namespaces=c.namespaces||[];a.transportId=c.transportId;a.statusText=c.statusText;if(!a.sessionId||!(a.namespaces&&0!=a.namespaces.length||mj(a)))return null;a.receiver.volume=b.volume;"boolean"==typeof b.isActiveInput&&(a.receiver.isActiveInput=b.isActiveInput);return a},oj=function(a){var b=
[];if(!a)return b;a&1&&b.push(chrome.cast.Bf.VIDEO_OUT);a&2&&b.push(chrome.cast.Bf.VIDEO_IN);a&4&&b.push(chrome.cast.Bf.AUDIO_OUT);a&8&&b.push(chrome.cast.Bf.AUDIO_IN);a&32&&b.push(chrome.cast.Bf.MULTIZONE_GROUP);return b},lj=function(a){return new chrome.cast.Ms(a.getId(),a.Zl(),oj(a.Zc))},pj=function(a,b){if(a.statusText!=b.statusText)return!0;var c=a.namespaces||[],e=b.namespaces||[];if(c.length!=e.length)return!0;for(var f=0;f<c.length;f++)if(!e.some(function(a){return a.name==c[f].name}))return!0;
return a.receiver.volume.level!==b.receiver.volume.level||a.receiver.volume.muted!==b.receiver.volume.muted?!0:!1},qj=function(a){Ca(a)?a.forEach(qj):Fa(a)&&Object.keys(a).forEach(function(b){null===a[b]?delete a[b]:(Fa(a[b])||Ca(a[b]))&&qj(a[b])})},rj=function(a,b){return a.namespaces.some(function(a){return a.name==b})},sj=["MultizoneLeader","MultizoneFollower"],mj=function(a){return null!==a&&"MultizoneLeader"==a.appId},tj=function(a){return"E8C28D3C"==a||"00000000-0000-0000-0000-000000000000"==
a};var uj=function(a){this.$c=a;this.a=C("mr.cast.SessionLauncher")};uj.prototype.gw=function(a,b){kh("MediaRouter.Cast.Session.Type",0,zi);return this.$c.D1(a,b).then(r(this.JV,this,b),function(a){a&&dj==a?Gi(1):Gi(0);return I(a)})};uj.prototype.JV=function(a,b){G(this.a,"Got launch result from "+a.getId());if("LAUNCH_ERROR"==b.type)throw Gi(2),Error(b.reason);a=nj(a,b.status);F(this.a,"Launched session: "+a.sessionId);return a};var vj=function(a,b,c,e){this.type=a;this.message=b;this.sequenceNumber=l(c)?c:-1;this.timeoutMillis=e||0;this.clientId=""};var wj=function(a,b){this.vg=a;this.Db=b;this.$j=[];this.ci=new Zi},xj=function(a,b){Yi.call(this,a,3E4);this.mb=b};u(xj,Yi);xj.prototype.Aw=function(){this.mb.resolve(!1)};d=wj.prototype;d.a=C("mr.cast.ApiMessenger");d.Wp=function(a){return(a=this.Db.dd(a))?a.routeId:null};d.listen=function(a,b){this.$j[a]=b};d.Lk=function(a,b,c){G(this.a,"Sending to "+b);G(this.a,JSON.stringify(c));c.clientId=b;this.vg.rP(a,c)};
d.tf=function(a,b){var c=this.Db.dd(a);c&&c.Dv?this.Lk(c.routeId,a,b):this.connect(a).then(function(c){c?(c=this.Wp(a))?this.Lk(c,a,b):E(this.a,"No route for "+a):E(this.a,"No connected client "+a)},null,this)};d.Rm=function(a){G(this.a,"App "+a);var b=this.Wp(a);if(b){if(b=this.ci.ln(b))(a=this.Db.dd(a))?(a.Dv=!0,b.mb.resolve(!0)):b.mb.resolve(!1)}else E(this.a,"No route for client "+a)};
d.oY=function(a){G(this.a,"Received: "+a);a=JSON.parse(a);var b=a.clientId;"client_connect"==a.type?this.Rm(b):this.Wp(b)?(b=this.$j[a.type])&&b(a):E(this.a,"No route for "+b)};d.connect=function(a){if(this.LW(a))return H(!0);var b=this.Wp(a);if(!b)return E(this.a,"No route for client "+a),H(!1);if(a=this.ci.xh(b))return a.mb.promise;var c=J();a=new xj(b,c);this.ci.Ez(a);return c.promise};d.LW=function(a){a=this.Db.dd(a);return null!=a&&a.Dv};var yj=function(a,b){this.rj=this.ze=this.Eg="";this.kb=null;this.Vf=this.qd="";this.hd=this.WW=!1;var c;a instanceof yj?(this.hd=l(b)?b:a.hd,this.Pr(a.Eg),this.ky(a.nm()),this.Pk(a.Zf()),this.Tk(a.ub()),this.Hg(a.qd),this.Lr(a.lf.clone()),this.Fr(a.Vf)):a&&(c=String(a).match(gf))?(this.hd=!!b,this.Pr(c[1]||"",!0),this.ky(c[2]||"",!0),this.Pk(c[3]||"",!0),this.Tk(c[4]),this.Hg(c[5]||"",!0),this.Lr(c[6]||"",!0),this.Fr(c[7]||"",!0)):(this.hd=!!b,this.lf=new zj(null,null,this.hd))};d=yj.prototype;
d.toString=function(){var a=[],b=this.Eg;b&&a.push(Aj(b,Bj,!0),":");var c=this.Zf();if(c||"file"==b)a.push("//"),(b=this.nm())&&a.push(Aj(b,Bj,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.ub(),null!=c&&a.push(":",String(c));if(c=this.qd)this.sv()&&"/"!=c.charAt(0)&&a.push("/"),a.push(Aj(c,"/"==c.charAt(0)?Cj:Dj,!0));(c=this.XR())&&a.push("?",c);(c=this.Vf)&&a.push("#",Aj(c,Ej));return a.join("")};
d.resolve=function(a){var b=this.clone(),c=a.nW();c?b.Pr(a.Eg):c=a.oW();c?b.ky(a.nm()):c=a.sv();c?b.Pk(a.Zf()):c=a.lW();var e=a.qd;if(c)b.Tk(a.ub());else if(c=a.kE()){if("/"!=e.charAt(0))if(this.sv()&&!this.kE())e="/"+e;else{var f=b.qd.lastIndexOf("/");-1!=f&&(e=b.qd.substr(0,f+1)+e)}f=e;if(".."==f||"."==f)e="";else if(-1!=f.indexOf("./")||-1!=f.indexOf("/.")){for(var e=Ma(f,"/"),f=f.split("/"),g=[],k=0;k<f.length;){var p=f[k++];"."==p?e&&k==f.length&&g.push(""):".."==p?((1<g.length||1==g.length&&
""!=g[0])&&g.pop(),e&&k==f.length&&g.push("")):(g.push(p),e=!0)}e=g.join("/")}else e=f}c?b.Hg(e):c=a.mW();c?b.Lr(a.xR()):c=a.jW();c&&b.Fr(a.Vf);return b};d.clone=function(){return new yj(this)};d.Pr=function(a,b){this.nh();if(this.Eg=b?Fj(a,!0):a)this.Eg=this.Eg.replace(/:$/,"");return this};d.nW=function(){return!!this.Eg};d.nm=function(){return this.ze};d.ky=function(a,b){this.nh();this.ze=b?Fj(a):a;return this};d.oW=function(){return!!this.ze};d.Zf=function(){return this.rj};
d.Pk=function(a,b){this.nh();this.rj=b?Fj(a,!0):a;return this};d.sv=function(){return!!this.rj};d.ub=function(){return this.kb};d.Tk=function(a){this.nh();if(a){a=Number(a);if(isNaN(a)||0>a)throw Error("Bad port number "+a);this.kb=a}else this.kb=null;return this};d.lW=function(){return null!=this.kb};d.Hg=function(a,b){this.nh();this.qd=b?Fj(a,!0):a;return this};d.kE=function(){return!!this.qd};d.mW=function(){return""!==this.lf.toString()};
d.Lr=function(a,b){this.nh();a instanceof zj?(this.lf=a,this.lf.Zx(this.hd)):(b||(a=Aj(a,Gj)),this.lf=new zj(a,null,this.hd));return this};d.XR=function(){return this.lf.toString()};d.xR=function(){return this.lf.k7()};d.Fr=function(a,b){this.nh();this.Vf=b?Fj(a):a;return this};d.jW=function(){return!!this.Vf};d.nh=function(){if(this.WW)throw Error("Tried to modify a read-only Uri");};d.Zx=function(a){this.hd=a;this.lf&&this.lf.Zx(a);return this};
var Fj=function(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""},Aj=function(a,b,c){return n(a)?(a=encodeURI(a).replace(b,Hj),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null},Hj=function(a){a=a.charCodeAt(0);return"%"+(a>>4&15).toString(16)+(a&15).toString(16)},Bj=/[#\/\?@]/g,Dj=/[\#\?:]/g,Cj=/[\#\?]/g,Gj=/[\#\?@]/g,Ej=/#/g,zj=function(a,b,c){this.Ia=this.gb=null;this.Uf=a||null;this.hd=!!c};
zj.prototype.Se=function(){if(!this.gb&&(this.gb=new A,this.Ia=0,this.Uf)){var a=this;jf(this.Uf,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)})}};var Ij=function(a,b,c){b=Nc(a);if("undefined"==typeof b)throw Error("Keys are undefined");c=new zj(null,null,c);a=Mc(a);for(var e=0;e<b.length;e++){var f=b[e],g=a[e];Ca(g)?c.zJ(f,g):c.add(f,g)}return c};d=zj.prototype;d.N=function(){this.Se();return this.Ia};
d.add=function(a,b){this.Se();this.Wj();a=this.Dj(a);var c=this.gb.get(a);c||this.gb.set(a,c=[]);c.push(b);this.Ia+=1;return this};d.remove=function(a){this.Se();a=this.Dj(a);return this.gb.Oa(a)?(this.Wj(),this.Ia-=this.gb.get(a).length,this.gb.remove(a)):!1};d.clear=function(){this.Wj();this.gb=null;this.Ia=0};d.Eb=function(){this.Se();return 0==this.Ia};d.Oa=function(a){this.Se();a=this.Dj(a);return this.gb.Oa(a)};d.ej=function(a){var b=this.A();return sb(b,a)};
d.cb=function(){this.Se();for(var a=this.gb.A(),b=this.gb.cb(),c=[],e=0;e<b.length;e++)for(var f=a[e],g=0;g<f.length;g++)c.push(b[e]);return c};d.A=function(a){this.Se();var b=[];if(n(a))this.Oa(a)&&(b=Bb(b,this.gb.get(this.Dj(a))));else{a=this.gb.A();for(var c=0;c<a.length;c++)b=Bb(b,a[c])}return b};d.set=function(a,b){this.Se();this.Wj();a=this.Dj(a);this.Oa(a)&&(this.Ia-=this.gb.get(a).length);this.gb.set(a,[b]);this.Ia+=1;return this};
d.get=function(a,b){a=a?this.A(a):[];return 0<a.length?String(a[0]):b};d.zJ=function(a,b){this.remove(a);0<b.length&&(this.Wj(),this.gb.set(this.Dj(a),y(b)),this.Ia+=b.length)};d.toString=function(){if(this.Uf)return this.Uf;if(!this.gb)return"";for(var a=[],b=this.gb.cb(),c=0;c<b.length;c++)for(var e=b[c],f=encodeURIComponent(String(e)),e=this.A(e),g=0;g<e.length;g++){var k=f;""!==e[g]&&(k+="="+encodeURIComponent(String(e[g])));a.push(k)}return this.Uf=a.join("&")};d.k7=function(){return Fj(this.toString())};
d.Wj=function(){this.Uf=null};d.clone=function(){var a=new zj;a.Uf=this.Uf;this.gb&&(a.gb=this.gb.clone(),a.Ia=this.Ia);return a};d.Dj=function(a){a=String(a);this.hd&&(a=a.toLowerCase());return a};d.Zx=function(a){a&&!this.hd&&(this.Se(),this.Wj(),this.gb.forEach(function(a,c){var e=c.toLowerCase();c!=e&&(this.remove(c),this.zJ(e,a))},this));this.hd=a};d.extend=function(a){for(var b=0;b<arguments.length;b++)Pc(arguments[b],function(a,b){this.add(b,a)},this)};var Jj=function(a,b,c,e,f,g,k,p){this.bt=a;this.ad=b||null;this.Fo=c||null;this.fp=e||null;this.Cq=l(f)?f:null;this.ct=g||null;this.jB=k||null;this.zv=p||!1},Kj=/(^\w+)(?:\(([\w,\ ]*)\))?$/,Lj=function(a,b){return(a=a.match(b+"=([^/]*)"))?a[1]:null},Mj=function(a){a=a.match(/__castAppId__=([^/]*)/g);return null==a?[]:mb(x(a,function(a){a=Lj(a,"__castAppId__");if(!a)return null;a=a.match(Kj);if(!a||0==a.length)return null;var c=[];3==a.length&&a[2]&&(c=a[2].split(","));return{appId:a[1],capabilities:c}}),
function(a){return null!=a})},Nj=function(a){return Lj(a,"__castClientId__")};d=Jj.prototype;d.Tl=function(){return x(this.bt,function(a){return a.appId})};d.eC=function(){return this.ct};d.Xb=function(){return this.ad};d.yu=function(){return this.Fo?this.Fo:chrome.cast.Be.TAB_AND_ORIGIN_SCOPED};d.yR=function(){return this.fp?this.fp:chrome.cast.mo.CREATE_SESSION};d.KS=function(){return null==this.Cq?chrome.cast.timeout.requestSession:this.Cq};
d.toString=function(){var a=new yj;a.Pr("https");a.Pk("google.com");a.Hg("/cast");var b=[];v(this.bt,function(a){var e="__castAppId__="+a.appId;a.capabilities&&0<a.capabilities.length&&(e=e+"("+a.capabilities.join(","),e+=")");b.push(e)});this.ad&&b.push("__castClientId__="+this.ad);this.Fo&&b.push("__castAutoJoinPolicy__="+this.Fo);this.fp&&b.push("__castDefaultActionPolicy__="+this.fp);null!=this.Cq&&b.push("__castLaunchTimeout__="+this.Cq);this.ct&&b.push("__dialAppName__="+this.ct);this.jB&&b.push("__dialPostData__="+
this.jB);this.zv&&b.push("__castInvisibleSender__=true");a.Fr(b.join("/"));return a.toString()};d.bX=function(a){var b=this.Tl(),c=Oj(a);return nb(b,function(a){return sb(c,a)})};
var Pj=function(a){var b=(new yj(a)).Vf;a=Mj(b);if(!a||0==a.length)return null;var c=Nj(b),e=Lj(b,"__castAutoJoinPolicy__"),f=Lj(b,"__castDefaultActionPolicy__"),g;g=Lj(b,"__castLaunchTimeout__");null==g?g=null:(g=Number(g),g=!isNaN(g)&&0<=g?g:null);var k=Lj(b,"__dialAppName__"),p=Lj(b,"__dialPostData__"),b=Lj(b,"__castInvisibleSender__");return new Jj(a,c,e,f,g,k,p,null===b?null:"true"==b)},Oj=function(a){return(a=Pj(a))?a.Tl():null},Qj=function(a){return(a=Pj(a))?a.Xb():null};var Rj=function(a,b,c,e,f,g){this.pf=a;this.V=b;this.Db=c;this.ja=e;this.vc=f;this.vg=g;this.Hc=new wj(g,c);this.Q0=new jj(this.pf);this.L2=new uj(this.pf)};d=Rj.prototype;d.a=C("mr.cast.ApiHandler");d.init=function(){this.Db.init();this.Hc.listen("v2_message",this.WZ.bind(this));this.Hc.listen("app_message",this.tY.bind(this));this.Hc.listen("leave_session",this.VY.bind(this))};d.Sd=function(a,b){this.Hc.oY(b)};
d.Gx=function(a,b,c,e){a=this.ja.qC(a);c&&0==a.length&&a.push(c.clientId);a.slice().forEach(function(a){a!=e&&this.ZH(a,b)},this)};d.ZH=function(a,b){b.clientId=a;this.Hc.tf(a,b)};d.bI=function(a,b,c){b={receiver:lj(b),action:c};this.ZH(a,new vj("receiver_action",b))};
d.WZ=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ja.ev(c);if(e)if(c=this.ja.FD(c))if(c=this.V.W(c))switch(b.type){case "STOP":this.qY(a,c);break;case "LOAD":case "PAUSE":case "PLAY":case "SEEK":case "STOP_MEDIA":case "MEDIA_SET_VOLUME":case "MEDIA_GET_STATUS":case "EDIT_TRACKS_INFO":case "QUEUE_LOAD":case "QUEUE_INSERT":case "QUEUE_UPDATE":case "QUEUE_REMOVE":case "QUEUE_REORDER":this.nY(a,c,e);break;case "SET_VOLUME":this.pY(a,c);break;default:E(this.a,"Unknown request")}else this.Jk(a,
chrome.cast.Ce.INVALID_PARAMETER,"No receiver");else this.Jk(a,chrome.cast.Ce.INVALID_PARAMETER,"No sink ID");else this.Jk(a,chrome.cast.Ce.INVALID_PARAMETER,"Unknown session ID")}else this.Jk(a,chrome.cast.Ce.INVALID_PARAMETER,"No session ID")};d.Jk=function(a,b,c){b=new chrome.cast.Error(b,c);this.Fx(a,b)};d.Fx=function(a,b){this.Hc.tf(a.clientId,new vj("error",b,a.sequenceNumber))};
d.qY=function(a,b){var c=a.message;jh("MediaRouter.Cast.Session.End");var e=c.sessionId,f=this.ja.Od(e);f&&(f.wq=!0);this.pf.sendRequest(c,b,vi,a.timeoutMillis,a.clientId).Bb(function(){this.vx(e,a)},this)};d.nY=function(a,b,c){var e=a.message,f=e.type;f in Ui&&(e.type=Ui[f]);this.pf.sendRequest(e,b,wi,a.timeoutMillis,a.clientId,c.transportId).then(function(b){this.ZG(c,b);this.Hc.tf(a.clientId,new vj("v2_message",b,a.sequenceNumber))},function(b){this.Fx(a,b)},this)};
d.pY=function(a,b){var c=a.message;delete c.sessionId;this.pf.sendRequest(c,b,vi,a.timeoutMillis,a.clientId).then(function(){this.Hc.tf(a.clientId,new vj("v2_message",null,a.sequenceNumber))},function(b){this.Fx(a,b)},this)};
d.tY=function(a){var b=a.message,c=b.sessionId;if(c){var e=this.ja.FD(c);e?(e=this.V.W(e))?(c=this.ja.ev(c),qb(c.namespaces,function(a){return a.name==b.namespaceName})?this.vc.xr(e,b.namespaceName,b.message,a.clientId,c.transportId).then(function(){this.Hc.tf(a.clientId,new vj("app_message",null,a.sequenceNumber))},function(){this.Jk(a,chrome.cast.Ce.CHANNEL_ERROR,"Channel to receiver not available")},this):this.Jk(a,chrome.cast.Ce.INVALID_PARAMETER,"Invalid namespace")):E(this.a,"No receiver from sinkId"):
E(this.a,"No sinkId from sessionId")}else E(this.a,"No sessionId")};d.s1=function(a){a.td.slice().forEach(function(a){this.vg.AU(a)||this.vg.Ck(a,!0)}.bind(this))};d.Xq=function(a){(a=this.ja.gm(a))&&a.session&&this.vx(a.session.sessionId)};
d.VY=function(a){F(this.a,"Leave session");var b=a.message,c=this.ja.Od(b);if(c){var e=a.clientId,f=this.Db.dd(e);if(f){var g=[],k=[],p=f.tabId,w=f.origin,B=f.autoJoinPolicy;c.Ke.forEach(function(a){var b=this.Db.dd(a);B==chrome.cast.Be.TAB_AND_ORIGIN_SCOPED&&p==b.tabId&&w==b.origin||B==chrome.cast.Be.ORIGIN_SCOPED&&w==b.origin?g.push(a):k.push(a)},this);this.Hc.tf(e,new vj("leave_session",null,a.sequenceNumber));g.forEach(function(a){this.Hc.tf(a,new vj("disconnect_session",b))},this);c.Ke=k}else E(this.a,
"No client record")}else E(this.a,"No session")};d.cH=function(a,b){rj(a,wi)&&this.pf.sendRequest(new Vi,b,wi,void 0,void 0,a.transportId).na(ya)};d.dH=function(a,b){var c=a.getId();F(this.a,"Query status for "+c);this.Q0.G6(a).then(function(e){this.rG(c,e);b&&(e=this.ja.Yp(c))&&this.cH(e,a)},ya,this)};d.CZ=function(a,b){yi.hasOwnProperty(b.namespace_)?this.zZ(a,b):this.yZ(a,b)};
d.hX=function(a){if("*"==a.destinationId)return!0;a=a.destinationId;if(a==this.vc.yD()||null!=this.Db.dd(a))return!0;F(this.a,"Invalid destination "+a);return!1};
d.zZ=function(a,b){G(this.a,"Cast message: "+JSON.stringify(b));if(this.hX(b))if(b.namespace_==xi)(a=this.ja.gm(a))&&a.td.forEach(function(a){this.vg.qP(a,b)}.bind(this));else{var c=JSON.parse(b.data),e=this.PV(c),e=e?e.sourceId:void 0;switch(c.type){case "RECEIVER_STATUS":this.rG(a,c);break;case "MEDIA_STATUS":this.BZ(a,b,e)}}else this.vc.HA(a,b.destinationId,b.sourceId,!0)};
d.PV=function(a){var b=this.pf.ln(a.requestId);if(!b)return null;var c=b.mb;switch(a.type){case "LAUNCH_ERROR":case "INVALID_REQUEST":case "LOAD_CANCELLED":case "LOAD_FAILED":case "INVALID_PLAYER_STATE":delete a.requestId,c.reject(new chrome.cast.Error(chrome.cast.Ce.SESSION_ERROR,a.reason||a.type,a));default:c.resolve(a)}return b};
d.yZ=function(a,b){G(this.a,"App message: "+JSON.stringify(b));if(a=this.ja.Yp(a)){var c=[],c="*"==b.destinationId?this.ja.qC(a.sessionId):[b.destinationId],e=new ij(a.sessionId,b.namespace_,b.data);c.forEach(function(a){this.Hc.tf(a,new vj("app_message",e))},this)}else E(this.a,"No session for incoming app message")};
var Sj=function(a,b){a.forEach(function(a){a.sessionId=b;var e=a.supportedMediaCommands,f=[];e&1&&f.push(chrome.cast.media.ml.PAUSE);e&2&&f.push(chrome.cast.media.ml.SEEK);e&4&&f.push(chrome.cast.media.ml.STREAM_VOLUME);e&8&&f.push(chrome.cast.media.ml.STREAM_MUTE);a.supportedMediaCommands=f});return a};d=Rj.prototype;d.ZG=function(a,b){a=a.sessionId;b.sessionId=a;this.ja.C5(a,Sj(b.status,a))};d.gZ=function(a,b,c){this.Hc.tf(c,new vj("new_session",a));this.cH(a,b)};
d.mn=function(a){if(a=this.ja.Yp(a)){a=a.sessionId;var b=this.ja.Od(a);b&&b.wq||this.vx(a)}};d.vx=function(a,b){this.Gx(a,new vj("remove_session",a,b?b.sequenceNumber:void 0),b);(b=this.ja.Od(a))&&this.s1(b);this.ja.t1(a)};
d.rG=function(a,b){G(this.a,"Receiver status for "+a);var c=b.status;if(c)if(b=this.V.W(a)){var c=nj(b,c),e=this.ja.gm(a);e?c?c.sessionId==e.session.sessionId?this.aW(e,c):(this.dE(a),this.vg.de(null,b,null,c)):this.dE(a):c&&this.vg.de(null,b,null,c)}else jh("MediaRouter.Cast.Error.Sink.Missing.From.Discovery.Service"),E(this.a,"Got message from receiver "+a+", but sink is no longer available.")};
d.aW=function(a,b){var c=a.session;pj(c,b)&&(G(this.a,"Updating session "+b.sessionId),c.statusText=b.statusText,c.namespaces=b.namespaces,c.receiver.volume=b.receiver.volume,this.vg.K7(a),this.Gx(c.sessionId,new vj("update_session",c),void 0))};d.dE=function(a){this.mn(a,"receiver-app-end");Ei(1)};d.BZ=function(a,b,c){if(a=this.ja.Yp(a))if(b=JSON.parse(b.data))this.ZG(a,b),this.Gx(b.sessionId,new vj("v2_message",b),void 0,c)};
d.hO=function(a,b){var c=oj(b.Zc);return(b=qb(a.bt,function(a){return ob(a.capabilities,function(a){return sb(c,a)})}))?b.appId:a.Tl()[0]};d.gw=function(a,b){var c=Pj(a);if(!c)return I(Error("Invalid source "+a));a=this.hO(c,b);var c=c.KS(),e=new bh("MediaRouter.Cast.Session.Launch");return this.L2.gw(new chrome.cast.lz(a,void 0,c),b).then(function(a){e.end("Success");return H(a)},function(a){e.end("Failure");return I(a)},this)};var Tj=C("mr.RuntimeErrorUtils"),Uj=function(){chrome.runtime.lastError&&Tj.NB(chrome.runtime.lastError.message||"unknown runtime error")};var Vj=function(){this.a=C("mr.cast.ChannelFactory");this.Sw=new A;this.Tw=new A;this.Ym=new A};d=Vj.prototype;d.cj=function(a,b){var c=a.getId(),e=a.la+":"+a.ub(),f=this.Sw.get(c);if(f){if(this.Ym.get(c)==e)return G(this.a,"Using pending creation to "+c),f;F(this.a,"Device "+c+" IP changed from "+this.Ym.get(a.getId())+" to "+e);this.pM(a)}a=this.vP(a,b).then(function(a){this.Ft(c);return a},function(a){e==this.Ym.get(c)&&this.Ft(c);return I(a)},this);this.Sw.set(c,a);this.Ym.set(c,e);return a};
d.pM=function(a){a=a.getId();G(this.a,"Aborting connection to device "+a);var b=this.Tw.get(a);b&&b.abort();this.Ft(a)};d.Ft=function(a){this.Sw.remove(a);this.Tw.remove(a);this.Ym.remove(a)};d.vP=function(a,b){if(1===b)return this.EG(a);var c=q(b)&&1<b?b:3;b=new Sf(r(this.EG,this,a),1E3,c);this.Tw.set(a.getId(),b);return b.Cr(1.5).start().then(null,function(b){F(this.a,"Failed to create channel to "+a.getId()+" after "+c+" attempts.");return I(b)},this)};
d.EG=function(a){var b=Wj++;F(this.a,"Connecting to (id "+b+") "+a.getId());var c=new bh("MediaRouter.Cast.Mdns.Channel.Open");return this.YZ(a).then(function(a){F(this.a,"Channel opened (id "+b+"): "+JSON.stringify(a));c.end("Success");return a},function(a){F(this.a,"Channel did not open (id "+b+").");c.end("Failure");return I(a)},this)};var Wj=0;
Vj.prototype.YZ=function(a){a={ipAddress:a.la,port:a.ub(),auth:"ssl_verified",timeout:1E4,livenessTimeout:1E4,pingInterval:5E3,capabilities:0};F(this.a,"Opening channel to "+JSON.stringify(a));var b=J();chrome.cast.channel.open(a,r(function(a){Uj();"open"==a.readyState?b.resolve(a):(chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this)),b.reject(Error(a.errorState)))},this));return b.promise};var Xj=function(a,b,c,e){return{namespace_:a,data:n(b)?b:JSON.stringify(b),sourceId:c,destinationId:e}};var Zj=function(a){this.type="CONNECT";this.origin={};this.userAgent=hc;var b=this.userAgent.indexOf("(")+1,b=this.userAgent.substr(b,this.userAgent.indexOf(")",b)-1-b+1);this.senderInfo={sdkType:2,version:chrome.runtime.getManifest().version,browserVersion:qi,platform:Yj(),systemVersion:b,connectionType:1};this.connType=a?0:2},Yj=function(){switch(ph()){case "ChromeOS":return 5;case "Windows":return 3;case "Mac":return 4;case "Linux":return 6}return 0};var ak=function(){this.Ae=new A};za(ak);d=ak.prototype;d.init=function(){qf(this)};d.Iw=function(a,b,c,e){this.GA(a,b,c,!1);var f=Xj(ui,new Zj(e),b,c);chrome.cast.channel.send(a,f,r(this.YB,this));this.Ae.set(this.Qv(a,b,c),e)};d.GA=function(a,b,c,e){if(this.oE(a,b,c)){var f=0;this.Ae.forEach(function(a,b){b=b.split("#")[2];a&&b==c&&f++});if(e||1<f)this.vH(a,b,c),b=Xj(ui,{type:"CLOSE"},b,c),chrome.cast.channel.send(a,b,r(this.YB,this))}};d.vH=function(a,b,c){this.Ae.remove(this.Qv(a,b,c))};
d.v1=function(a){this.Ae.cb().forEach(function(b){b.split("#")[0]==a.channelId.toString()&&this.Ae.remove(b)},this)};d.hY=function(a,b){this.Ae.forEach(function(c,e){var f=e.split("#");f[0]==a.channelId.toString()&&(this.Iw(b,f[1],f[2],c),this.Ae.remove(e))},this)};d.OP=function(a,b,c){this.oE(a,b,c)||this.Iw(a,b,c,0==c.indexOf("receiver-0"))};d.oE=function(a,b,c){return this.Ae.Oa(this.Qv(a,b,c))};d.YB=function(){Uj()};d.Qv=function(a,b,c){return[a.channelId,b,c].join("#")};
var bk=function(a){this.JK=a};ak.prototype.Ra=function(){return"cast.VirtualConnectionManager"};ak.prototype.getData=function(){var a=this.Ae.b();return[new bk(a)]};ak.prototype.wb=function(){var a=nf(this);if(a)for(var b in a.JK)this.Ae.set(b,a.JK[b])};var ck=function(a,b){this.Ct=b;this.Uc=a;this.a=C("mr.cast.ChannelService");this.zg=new A;this.Jf=new A;this.Ji=ak.O();this.ZN=new Vj;this.W=null};d=ck.prototype;d.init=function(){chrome.cast.channel.onMessage.addListener(r(this.AY,this));chrome.cast.channel.onError.addListener(r(this.yY,this));this.Ji.init();qf(this)};d.yD=function(){return this.Uc};d.xr=function(a,b,c,e,f){var g=e||this.Uc,k=f||"receiver-0";return this.cj(a).then(function(a){return this.E2(a,b,c,g,k)},null,this)};
d.ZZ=function(a,b,c,e){return this.cj(a).then(function(a){this.Ji.Iw(a,b,c,e)},null,this)};d.HA=function(a,b,c,e){(a=this.zg.get(a))&&this.Ji.GA(a,b,c,e)};
d.AY=function(a,b){var c=this.Jf.get(a.channelId);if(c){var e=this.W(c);if(e){if(yi.hasOwnProperty(b.namespace_)){c=JSON.parse(b.data);if("CLOSE"==c.type){this.Ji.vH(a,b.destinationId,b.sourceId);return}F(this.a,"Got message "+(c.type||c.responseType)+" from "+e.getId())}else F(this.a,"Got message in "+b.namespace_+" from "+e.getId());this.Ct.zY(e,b)}else E(this.a,"Receiver "+c+" not found.")}else E(this.a,"This message is from unknown receiver.")};
d.IA=function(a){chrome.cast.channel.close(a,function(){chrome.runtime.lastError||G(this.a,"Channel close success")}.bind(this));var b=this.Jf.get(a.channelId);b&&(this.Jf.remove(a.channelId),this.zg.remove(b))};d.yY=function(a,b){E(this.a,"Channel error: "+JSON.stringify(a)+(b?", "+JSON.stringify(b):""));b&&this.yM(b.errorState,b);this.FA(a)};
d.yM=function(a,b){switch(a){case "unknown":a=0;break;case "authentication_error":a=1;break;case "connect_error":a=2;break;default:return}if(b){if(-8192<=b.nssErrorCode&&-7192>b.nssErrorCode||2==b.challengeReplyErrorType||8==b.challengeReplyErrorType||9==b.challengeReplyErrorType||11==b.challengeReplyErrorType||-200>=b.netReturnValue&&-300<b.netReturnValue||30==b.eventType||31==b.eventType||32==b.eventType)a=3;if(26==b.eventType||-201==b.netReturnValue||-8181==b.nssErrorCode||-8162==b.nssErrorCode||
-8161==b.nssErrorCode)a=4;-138==b.netReturnValue&&(a=5);if(-8182==b.nssErrorCode||10==b.eventType||12==b.eventType)a=1}E(this.a,"Channel error code: "+a);kh("MediaRouter.Cast.Channel.Error",a,Di)};d.FA=function(a){var b=this.Jf.get(a.channelId);this.IA(a);if(b){var c=this.W(b);c&&this.cj(c).then(function(b){F(this.a,"Re-connected to receiver: "+c.getId());this.Ji.hY(a,b);this.Ct.BY(c)},function(){F(this.a,"Failed to re-connect to receiver: "+c.getId());this.Ji.v1(a);this.Ct.xw(c,a.errorState)},this)}};
d.cj=function(a){var b=a.getId(),c=this.zg.get(b);return c&&"open"==c.readyState?H(c):this.ZN.cj(a).then(function(a){if(this.Jf.Oa(a.channelId))return a;this.zg.get(b)&&(E(this.a,"Duplicate channel to a receiver "+b),this.IA(this.zg.get(b)));F(this.a,"Connected to: "+b);this.zg.set(b,a);this.Jf.set(a.channelId,b);return a},null,this)};
d.E2=function(a,b,c,e,f){this.Ji.OP(a,e,f);qj(c);var g=Xj(b,c,e,f);F(this.a,"Channel is sending message");G(this.a,"....message was: "+JSON.stringify(g));return new ie(function(b,c){chrome.cast.channel.send(a,g,r(function(a){Uj();a.errorState?(c(Error("Failed to send message")),this.FA(a)):b(!0)},this))},this)};var dk=function(a,b){this.P0=a;this.$N=b};ck.prototype.Ra=function(){return"cast.ChannelService"};ck.prototype.getData=function(){return[new dk(this.zg.b(),this.Jf.b())]};
ck.prototype.wb=function(){var a=nf(this);a&&(this.zg.addAll(a.P0),this.Jf.addAll(a.$N))};var ek=function(){this.requestId=0;this.type="GET_APP_AVAILABILITY";this.appId=[]};var fk=function(a,b){this.pf=a;this.V=b;this.Jb=new Sc;this.gc=new A};d=fk.prototype;d.a=C("mr.cast.AppDiscoveryService");d.init=function(){qf(this)};d.lx=function(a){var b=this.gc.get(a);b?b.nx++:this.gc.set(a,{nx:1});this.n2()};d.Gy=function(a){var b=this.gc.get(a);b&&(b.nx--,0<b.nx||(Gc(this.V.km(),function(b){switch(b.Kd(a)){case "available":b.En(a,"available_rescan");break;case "unavailable":b.En(a,"unavailable_rescan")}}),this.gc.remove(a)))};
d.n2=function(){F(this.a,"Scanning sinks for app availability");Gc(this.V.km(),this.xn,this)};
d.xn=function(a){Gc(this.gc.VC(),function(b){var c;a:{switch(a.Kd(b)){case "unknown":case "available_rescan":case "unavailable_rescan":c=!0;break a}c=!1}if(c){var e=a.getId()+":"+b;this.Jb.contains(e)||(this.Jb.add(e),(new Sf(this.cO.bind(this,a,b),5500,3)).Cr(2).start().then(this.pK.bind(this,a,b),function(){D(this.a,"Failed to get app availability response for "+a.getId()+", appId "+b+" after 3 attempts.");this.pK(a,b,"unknown")},this).Bb(function(){this.Jb.remove(e)},this))}},this)};
d.pK=function(a,b,c){c!=a.Kd(b)&&(F(this.a,b+" on "+a.getId()+" is "+c),a.En(b,c),this.V.Qc(a))};
d.cO=function(a,b){var c=new ek;c.appId=[b];var e=new bh("MediaRouter.Cast.App.Availability");return this.pf.sendRequest(c,a,vi,5E3).then(function(a){e.end("Success");G(this.a,"App availability response "+JSON.stringify(a));for(var b in a.availability){if("APP_AVAILABLE"==a.availability[b])return"available";if("APP_UNAVAILABLE"==a.availability[b])return"unavailable"}return"unknown"},function(c){e.end("Failure");D(this.a,"checkAppAvailability_ failed for "+a.getId()+", appId "+b);throw c;},this)};
var gk=function(a){this.b1=a};fk.prototype.Ra=function(){return"cast.AppDiscoveryService"};fk.prototype.getData=function(){return[new gk(this.gc.b())]};fk.prototype.wb=function(){var a=nf(this);a&&this.gc.addAll(a.b1)};var hk=function(a,b){this.sinks=a;this.origins=b||null},ik=new hk([]);var jk=function(){},kk=function(a){if(!Ma(a,"urn:x-org.chromium:media:route:"))return null;var b=a.substring(31);if(!b)return null;b=fb(b,"/",2);if(3!=b.length)return null;var c=fb(b[1],"-",1);if(2!=c.length)return null;var e=new jk;e.lka=a;e.TG=b[0];e.uja=c[0];e.Hka=c[1];e.Kg=b[2];return e};jk.prototype.da=function(){return this.Kg};var lk=function(a,b,c,e,f,g){this.id=a;this.sinkId=b;this.mediaSource=c;this.isLocal=e;this.description=f;this.iconUrl=g;this.allowStop=!0;this.customControllerPath=null;this.forDisplay=!0;this.offTheRecord=!1;this.hj=e},mk=function(a,b,c,e,f,g,k){return new lk("urn:x-org.chromium:media:route:"+a+"/"+b+"-"+c+"/"+e,c,e,f,g,k)};var nk=function(a,b,c,e){return mk(c,"cast",b.getId(),a,e,"",null)};var ok=function(a,b,c,e,f,g){this.routeId=a;this.clientId=b;this.autoJoinPolicy=e;this.origin=f;this.tabId=g;this.Dv=!1},pk=function(){this.lb=[]};d=pk.prototype;d.init=function(){qf(this)};d.N=function(){return this.lb.length};d.dd=function(a){return qb(this.lb,function(b){return b.clientId==a})};d.fg=function(a){return qb(this.lb,function(b){return b.routeId==a})};d.Ts=function(a,b,c,e,f,g){a=new ok(a,b,c,e,f,g);this.lb.push(a);return a};
d.sx=function(a){this.lb=mb(this.lb,function(b){return b.clientId!=a})};var qk=function(a){this.or=a};pk.prototype.Ra=function(){return"cast.ClientRecords"};pk.prototype.getData=function(){return[new qk(this.lb)]};pk.prototype.wb=function(){var a=nf(this);a&&(this.lb=a.or)};var rk=function(a){this.V=a},sk=function(a){var b=[];a.forEach(function(a){var e="Receiver-"+a.replace(/\./g,"_"),f=Rf.O().xl||8009;b.push({serviceName:e+"._googlecast._tcp.local",serviceHostPort:e+":"+f,ipAddress:a,serviceData:["id=mdns:"+e,"ve=02","ca=5","st=1","fn="+e,"md=Chromecast"]})});return b};rk.prototype.init=function(){var a=sk(Rf.O().ru);this.V.lH(a)};var tk=chrome.i18n.getMessage("4528089202128275824");chrome.i18n.getMessage("2810417817914017289");chrome.i18n.getMessage("3413021810593924462");chrome.i18n.getMessage("7603034707785674700");chrome.i18n.getMessage("8009014317872238527");chrome.i18n.getMessage("8636962961150071298");chrome.i18n.getMessage("1802762746589457177");var uk=function(a,b){this.Ke=[];this.td=[];this.sinkId=a;this.session=b;this.Dq=this.Fm=null;this.offTheRecord=this.wq=!1};d=uk.prototype;d.Ts=function(a){if(sb(this.Ke,a))return!1;this.Ke.push(a);return!0};d.sx=function(a){return xb(this.Ke,a)};d.de=function(a){if(sb(this.td,a))return!1;this.td.push(a);return!0};d.Ck=function(a){return xb(this.td,a)};d.sV=function(a,b){mj(a)?(this.Dq=a,this.Fm=b):mj(this.session)&&(this.Dq=this.session,this.Fm=this.sinkId,this.session=a,this.sinkId=b);return this};
var vk=function(){this.a=C("mr.cast.SessionRecords");this.lb=[]};d=vk.prototype;d.init=function(){qf(this)};d.Ws=function(a,b){F(this.a,"Adding new session: "+b+", "+a.sessionId);var c=this.Od(a.sessionId);if(c)return c.sV(a,b);a=new uk(b,a);this.lb.push(a);return a};d.t1=function(a){F(this.a,"Removing session "+a);this.lb=mb(this.lb,function(b){return b.session.sessionId!=a})};d.qC=function(a){return(a=this.Od(a))?a.Ke:[]};d.Yp=function(a){return(a=this.gm(a))?a.session:null};
d.dd=function(a){return qb(this.lb,function(b){return sb(b.Ke,a)})};d.fg=function(a){return qb(this.lb,function(b){return sb(b.td,a)})};d.dU=function(a){return qb(this.lb,function(b){return null!=qb(b.td,function(b){return kk(b).TG==a})})};d.gm=function(a){return qb(this.lb,function(b){return b.sinkId==a||b.Fm==a})};d.Od=function(a){return qb(this.lb,function(b){return b.session.sessionId==a})};d.FD=function(a){return(a=this.Od(a))?a.sinkId:null};d.ev=function(a){return(a=this.Od(a))?a.session:null};
d.C5=function(a,b){var c=this.ev(a);c&&(a=mb(b,function(a){return a.playerState!=chrome.cast.media.no.IDLE},this),a.forEach(function(a){if(!a.media){var b=qb(c.media,function(b){return b.mediaSessionId==a.mediaSessionId});b&&(a.media=b.media)}}),c.media=a)};d.t0=function(a){for(var b=0;b<this.lb.length;b++)this.lb[b].sx(a)};var wk=function(a){this.or=a};vk.prototype.Ra=function(){return"cast.SessionRecords"};vk.prototype.getData=function(){return[new wk(this.lb)]};
vk.prototype.wb=function(){var a=nf(this);if(a)for(var b=0;b<a.or.length;b++){var c=a.or[b],e=new uk(c.sinkId,c.session);e.Ke=c.Ke;e.td=c.td;e.wq=c.wq;e.Dq=c.Dq;e.Fm=c.Fm;this.lb.push(e)}};var xk=function(a){this.Uc="sender-"+bb();this.ab=new A;this.Lh=null;qf(this);this.C=a;this.Db=new pk;this.ja=new vk;this.vc=new ck(this.Uc,this);this.V=new Oi(this.vc,this);this.cP=new rk(this.V);this.$c=new bj(this.vc,this.Uc);this.Ic=new fk(this.$c,this.V);this.Yc=new Rj(this.$c,this.V,this.Db,this.ja,this.vc,this);this.oA=new hj(this.V,this.$c);this.C6=this.V.start.bind(this.V)};d=xk.prototype;d.a=C("mr.CastProvider");d.getName=function(){return"cast"};
d.jd=function(){this.$c.init();this.ja.init();this.Yc.init();this.vc.init();this.V.init();this.cP.init();this.Ic.init();this.C.mx(this.C6)};d.Ze=function(){return this.ab.A()};d.Ul=function(a){var b=new Sc;this.Gp(a).forEach(function(a){this.V.KU(a).map(function(a){return a.cg()}).forEach(function(a){b.add(a)})}.bind(this));return new hk(b.A(),-1!=a.indexOf("0F5096E8")?uh:null)};d.Di=function(a){this.Gp(a).forEach(function(a){this.Ic.lx(a)}.bind(this));this.C.Hv()&&this.V.start()};d.Fi=function(a){this.Gp(a).forEach(function(a){this.Ic.Gy(a)}.bind(this))};
d.Ci=function(){};d.Ei=function(){};d.W=function(a){return(a=this.V.W(a))?a.cg():null};d.u2=function(a){var b=new ah(tk,"warning","dismiss");b.routeId=a;this.C.We().send(b)};d.cE=function(a,b){D(this.a,"Error launching.",b);this.u2(a.id);this.C.onPresentationConnectionClosed(a.id,"error","Launch error");this.Ck(a.id,!1)};
d.kp=function(a,b,c,e,f,g,k){Rf.O().hi=new Qf(b.cc,b.la);var p=nk(a,b,c,!0);p.forDisplay=!1;p.offTheRecord=e;this.ab.set(p.id,p);this.C.rk(this,p);(e=Pj(a))&&e.Xb()&&this.wz(e,p.id,g,k);th(a)?(p.qe={tabId:k,sessionId:"",DJ:b.la||"",EJ:b.cc||""},this.C.Pn(this,p,function(e){return this.fF(a,b,c,f,g,k,e)}.bind(this)).then(function(){this.XI(p)},function(a){this.cE(p,a)},this)):this.fF(a,b,c,f,g,k,p).na(function(a){this.cE(p,a)},this);return H(p)};
d.fF=function(a,b,c,e,f,g,k){return this.Yc.gw(this.Xw(a,b,e),b).then(function(e){this.de(a,b,c,e,f,g,k);return k},null,this)};d.ge=function(a,b,c,e,f,g,k){var p=this.V.W(b);if(!p)return I(Error("No sink with ID "+b));var w=Nj(a);if(w){setTimeout(function(){this.Yc.bI(w,p,chrome.cast.nl.CAST)}.bind(this),0);var B=this.Db.dd(w);if(B)return this.tc(B.routeId).then(function(){return this.kp(a,p,c,e,f,g,k)},null,this);if(g&&k&&(b=this.XA(a,g,k,e,f,b)))return b}return this.kp(a,p,c,e,f,g,k)};
d.rP=function(a,b){this.C.Sd(this,a,b)};d.qP=function(a,b){var c=this.ab.get(a);c&&c.hj&&this.C.Vq(this,a,b)};d.Ck=function(a,b){F(this.a,"Remove route "+a);var c=this.Db.fg(a);if(c){var e=c.clientId;F(this.a,"Remove client "+e);this.ja.t0(e);this.Db.sx(e)}if(e=this.ja.fg(a))e.Ck(a),this.wF(e.td);var f=this.ab.get(a);f&&(f.hj&&e&&(this.vc.HA(f.sinkId,c?c.clientId:this.Uc,e.session.transportId,b),f.forDisplay&&c&&(this.Lh={$i:c,gI:e})),this.ab.remove(a),this.C.Yh(this,f))};
d.K7=function(a){a.td.forEach(function(b){if(b=this.ab.get(b)){var c=a.session;b.qe&&b.forDisplay?this.XI(b):(b.description=c.statusText||c.displayName,this.C.Zh(this,b))}}.bind(this))};d.D7=function(a){nb(a,function(a){a=this.ab.get(a,null);if(!a||!a.mediaSource)return!1;var c=Pj(a.mediaSource),c=c?c.zv:!1;return a.isLocal&&!c},this)&&v(a,function(a){if(a=this.ab.get(a,null))a.isLocal=!0},this)};
d.wF=function(a){var b=[],c=[],e=null;a.forEach(function(a){if(a=this.ab.get(a)){a.forDisplay=!1;var g=Pj(a.mediaSource);g&&qb(g.Tl(),tj)||(a.hj?(g=g?g.yu():null,e||g==chrome.cast.Be.CUSTOM_CONTROLLER_SCOPED||(b.push(a),e=a.sinkId)):e&&e!=a.sinkId?b.push(a):c.push(a))}}.bind(this));v(0<b.length?b:c,function(a){a.forDisplay=!0})};d.wz=function(a,b,c,e){var f=a.Xb();f&&!this.Db.dd(f)&&(F(this.a,"Add client "+f),this.Db.Ts(b,f,a.Tl(),a.yu(),c||null,l(e)?e:null))};
d.XI=function(a){var b=this.ja.fg(a.id);b&&(b=b.session,b.statusText=a.description||b.statusText)};
d.de=function(a,b,c,e,f,g,k){var p=null!=a,w;null==a?(w=new Jj([{appId:e.appId,capabilities:e.capabilities}]),a=w.toString()):w=Pj(a);a=k||nk(a,b,c||e.sessionId,p);p=a.id;F(this.a,"Add route "+p);c=null;w&&(c=w.Xb(),this.wz(w,p,f,g));(f=this.ja.gm(b.getId()))||(f=this.ja.Ws(e,b.getId()));f.de(p);a.hj&&this.vc.ZZ(b,c||this.Uc,e.transportId,!(w&&w.zv));f.offTheRecord=a.offTheRecord;this.ab.set(p,a);w=f.td;this.D7(w);this.wF(w);w=e.sessionId;g=e.appId;("0F5096E8"==g||"85CDB22F"==g)&&w&&a.qe&&(a.qe.sessionId=
w);!rj(e,wi)||null!==e&&sb(sj,e.appId)||(a.customControllerPath="cast_route_details.html?"+["sessionId="+w,"appId="+g].join("&"));a.description=e.statusText||e.displayName;k?this.C.Zh(this,a):this.C.rk(this,a);c&&f.Ts(c)&&this.Yc.gZ(e,b,c);return a};
d.tc=function(a){var b=this.ab.get(a);if(!b)return H();var c=this.ja.fg(a);if(!c)return F(this.a,"Session for route "+a+" does not exist."),this.Ck(a,!0),H();var e=this.V.W(b.sinkId);if(!e)return F(this.a,"Sink for route "+a+" is no longer reachable."),this.Yc.mn(c.sinkId,"close-route"),H();(a=this.Db.fg(a))&&this.Yc.bI(a.clientId,e,chrome.cast.nl.STOP);Ei(0);var f=J();this.$c.G1(c.session.sessionId,e).Bb(function(){this.Yc.mn(e.getId(),"close-route");f.resolve()},this);return f.promise};
d.rQ=function(a){var b=null;Hc(this.ab.lv(),function(c){if(!c.hj)return!1;var e=this.V.W(c.sinkId);if(!e||!a.bX(this.Xw(c.mediaSource,e)))return!1;b=c;return!0},this);if(!b||!b.mediaSource)return null;var c=Qj(b.mediaSource);if(!c)return null;var e=this.Db.dd(c);return e?(c=this.ja.dd(c))?{$i:e,gI:c}:null:null};
d.VM=function(a,b,c){var e=this.rQ(a);if(!e){if(!this.Lh||this.Lh.$i.origin!=b||this.Lh.$i.tabId!=c)return null;e=this.Lh}switch(a.yu()){case chrome.cast.Be.PAGE_SCOPED:return null;case chrome.cast.Be.ORIGIN_SCOPED:if(b!=e.$i.origin)return null;break;case chrome.cast.Be.TAB_AND_ORIGIN_SCOPED:if(b!=e.$i.origin||c!=e.$i.tabId)return null}return this.ja.Od(e.gI.session.sessionId)};
d.XA=function(a,b,c,e,f,g){var k=null;Hc(this.ab.lv(),function(a){var b=a.qe;return b&&null!=b.tabId&&b.tabId==c&&sh(a.mediaSource)?(k=a,!0):!1});return k?this.tc(k.id).then(function(){return this.ge(a,g||k.sinkId,"",e,f,b,null==c?void 0:c)},null,this):null};
d.dh=function(a,b,c,e,f){if(!Pj(a))return I(Error("Unsupported presentation URL"));b=kk(b);b=this.ja.Od(b.TG);if(!b)return I(Error("No matching route"));var g=this.V.W(b.sinkId);if(!g)return I(Error("No sink"));a=this.de(a,g,c,b.session,e,f);return H(a)};
d.Kh=function(a,b,c,e,f,g){var k=Pj(a);if(!k)return I(Error("Unsupported presentation URL"));var p;if(b==chrome.cast.XK){if(p=this.VM(k,f,g),!p&&k.yR()!=chrome.cast.mo.CAST_THIS_TAB&&(e=this.XA(a,f,g,c,e)))return e}else p=0==b.indexOf(chrome.cast.iz)?this.ja.Od(b.substr(chrome.cast.iz.length)):this.ja.dU(b);if(!p)return I(Error("No matching route"));if(p.offTheRecord!=c)return I(Error("Off the record mismatch"));e=this.V.W(p.sinkId);if(!e)return I(Error("No sink"));a=this.de(a,e,b,p.session,f,g);
a.offTheRecord=c;return H(a)};d.Sf=function(a){this.Ck(a,!1)};d.bg=function(a){var b=!0,c=!0;if(a=this.V.W(a))b=a.Zc,c=!!(b&1),b=!!(b&4);return ci(b,c)};d.bm=function(){return"cast_streaming"};
d.Fg=function(a,b,c){if(!c)return this.Yc.Sd(a,b),H();var e=this.ja.fg(a);if(!e)return I(Error("Not managing the route "+a));var f=this.V.W(e.sinkId);if(!f)return I(Error("Sink no longer accessible"));a=(a=this.Db.fg(a))?a.clientId:this.Uc;var g=J();this.vc.xr(f,c.namespace,b,a,e.session.transportId).Bb(function(){g.resolve()});return g.promise};d.wl=function(a,b){var c=this.V.W(b);if(!c)return!1;a=this.Xw(a,c);return(a=Oj(a))&&0!=a.length?nb(a,function(a){return Hi(c.Kd(a))}):!1};
d.Wi=function(a,b){var c=this.Gp(a);return c&&0!=c.length?b&&b.mediaSource?(a=Oj(b.mediaSource),nb(a,function(a){return sb(c,a)},this)):!0:!1};d.AU=function(a){return(a=this.ab.get(a))?Nj(a.mediaSource):null};d.Xw=function(a,b,c){return th(a)?(a={appId:0==(b.Zc&1)?"85CDB22F":"0F5096E8",capabilities:oj(b.Zc)},(new Jj([a],void 0,void 0,void 0,c)).toString()):a};d.Gp=function(a){var b=[];th(a)?(b.push("85CDB22F"),b.push("0F5096E8")):(a=Oj(a))&&(b=Bb(b,a));return b};
d.xw=function(a){this.V.xw(a.getId());Ei(2)};d.BY=function(a){this.Yc.dH(a,!0)};d.zY=function(a,b){this.oA.zV(a,b);this.Yc.CZ(a.getId(),b)};d.$h=function(a){this.C.onSinkAvailabilityUpdated(this,1);this.Qc(a);this.Yc.dH(a)};d.Xq=function(a){if(0==this.V.mc().length)this.C.onSinkAvailabilityUpdated(this,0);this.Yc.Xq(a.getId());this.eE()};d.Qc=function(a){this.Ic.xn(a);this.eE()};d.eE=function(){this.oA.bW();this.C.rc()};var yk=function(a,b,c){this.eI=a;this.routes=b;this.lX=c};xk.prototype.Ra=function(){return"cast.Provider"};
xk.prototype.getData=function(){return[new yk(this.Uc,this.ab.b(),this.Lh)]};xk.prototype.wb=function(){var a=nf(this);a&&(this.Uc=a.eI,this.ab.addAll(a.routes),this.Lh=a.lX)};xk.prototype.sf=function(){return null};var zk=function(){if(!Wc)return!1;try{return new ActiveXObject("MSXML2.DOMDocument"),!0}catch(a){return!1}},Ak=Wc&&zk();var Bk=function(){this.Jd=[];this.ee=[]};d=Bk.prototype;d.JX=function(){0==this.Jd.length&&(this.Jd=this.ee,this.Jd.reverse(),this.ee=[])};d.enqueue=function(a){this.ee.push(a)};d.Rf=function(){this.JX();return this.Jd.pop()};d.N=function(){return this.Jd.length+this.ee.length};d.Eb=function(){return 0==this.Jd.length&&0==this.ee.length};d.clear=function(){this.Jd=[];this.ee=[]};d.contains=function(a){return sb(this.Jd,a)||sb(this.ee,a)};
d.remove=function(a){var b;b=this.Jd;var c=kb(b,a);0<=c?(wb(b,c),b=!0):b=!1;return b||xb(this.ee,a)};d.A=function(){for(var a=[],b=this.Jd.length-1;0<=b;--b)a.push(this.Jd[b]);for(var c=this.ee.length,b=0;b<c;++b)a.push(this.ee[b]);return a};var Ck=function(a,b){ve.call(this);this.NF=a||0;this.Qh=b||10;if(this.NF>this.Qh)throw Error("[goog.structs.Pool] Min can not be greater than max");this.Pb=new Bk;this.ig=new Sc;this.Wt=0;this.Sv=null;this.uo()};u(Ck,ve);d=Ck.prototype;d.getObject=function(){var a=t();if(!(null!=this.Sv&&a-this.Sv<this.Wt)){var b=this.j1();b&&(this.Sv=a,this.ig.add(b));return b}};d.ii=function(a){return this.ig.remove(a)?(this.Us(a),!0):!1};
d.j1=function(){for(var a;0<this.JC()&&(a=this.Pb.Rf(),!this.vw(a));)this.uo();!a&&this.N()<this.Qh&&(a=this.Oe());return a};d.Us=function(a){this.ig.remove(a);this.vw(a)&&this.N()<this.Qh?this.Pb.enqueue(a):this.lh(a)};d.uo=function(){for(var a=this.Pb;this.N()<this.NF;)a.enqueue(this.Oe());for(;this.N()>this.Qh&&0<this.JC();)this.lh(a.Rf())};d.Oe=function(){return{}};d.lh=function(a){if("function"==typeof a.bb)a.bb();else for(var b in a)a[b]=null};
d.vw=function(a){return"function"==typeof a.NN?a.NN():!0};d.contains=function(a){return this.Pb.contains(a)||this.ig.contains(a)};d.N=function(){return this.Pb.N()+this.ig.N()};d.CS=function(){return this.ig.N()};d.JC=function(){return this.Pb.N()};d.Eb=function(){return this.Pb.Eb()&&this.ig.Eb()};d.K=function(){Ck.R.K.call(this);if(0<this.CS())throw Error("[goog.structs.Pool] Objects not released");delete this.ig;for(var a=this.Pb;!a.Eb();)this.lh(a.Rf());delete this.Pb};var Dk=function(a,b){this.bf=a;this.Ii=b};Dk.prototype.getKey=function(){return this.bf};Dk.prototype.$b=function(){return this.Ii};Dk.prototype.clone=function(){return new Dk(this.bf,this.Ii)};var Ek=function(a){this.pd=[];a&&this.BW(a)};d=Ek.prototype;d.insert=function(a,b){var c=this.pd;c.push(new Dk(a,b));this.gY(c.length-1)};d.BW=function(a){var b;if(a instanceof Ek){if(b=a.cb(),a=a.A(),0>=this.N()){for(var c=this.pd,e=0;e<b.length;e++)c.push(new Dk(b[e],a[e]));return}}else b=Rb(a),a=Qb(a);for(e=0;e<b.length;e++)this.insert(b[e],a[e])};d.remove=function(){var a=this.pd,b=a.length,c=a[0];if(!(0>=b))return 1==b?tb(a):(a[0]=a.pop(),this.fY(0)),c.$b()};
d.fY=function(a){for(var b=this.pd,c=b.length,e=b[a];a<c>>1;){var f=this.LS(a),g=this.yU(a),f=g<c&&b[g].getKey()<b[f].getKey()?g:f;if(b[f].getKey()>e.getKey())break;b[a]=b[f];a=f}b[a]=e};d.gY=function(a){for(var b=this.pd,c=b[a];0<a;){var e=this.LT(a);if(b[e].getKey()>c.getKey())b[a]=b[e],a=e;else break}b[a]=c};d.LS=function(a){return 2*a+1};d.yU=function(a){return 2*a+2};d.LT=function(a){return a-1>>1};d.A=function(){for(var a=this.pd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].$b());return b};
d.cb=function(){for(var a=this.pd,b=[],c=a.length,e=0;e<c;e++)b.push(a[e].getKey());return b};d.ej=function(a){return nb(this.pd,function(b){return b.$b()==a})};d.Oa=function(a){return nb(this.pd,function(b){return b.getKey()==a})};d.clone=function(){return new Ek(this)};d.N=function(){return this.pd.length};d.Eb=function(){return 0==this.pd.length};d.clear=function(){tb(this.pd)};var Fk=function(){Ek.call(this)};u(Fk,Ek);Fk.prototype.enqueue=function(a,b){this.insert(a,b)};Fk.prototype.Rf=function(){return this.remove()};var Gk=function(a,b){this.fB=void 0;this.sr=new Fk;Ck.call(this,a,b)};u(Gk,Ck);d=Gk.prototype;d.getObject=function(a,b){if(!a)return(a=Gk.R.getObject.call(this))&&this.Wt&&(this.fB=h.setTimeout(r(this.iq,this),this.Wt)),a;this.sr.enqueue(l(b)?b:100,a);this.iq()};d.iq=function(){for(var a=this.sr;0<a.N();){var b=this.getObject();if(b)a.Rf().apply(this,[b]);else break}};d.Us=function(a){Gk.R.Us.call(this,a);this.iq()};d.uo=function(){Gk.R.uo.call(this);this.iq()};
d.K=function(){Gk.R.K.call(this);h.clearTimeout(this.fB);this.sr.clear();this.sr=null};var Hk=function(a,b,c,e){this.Hh=a;this.Ni=!!e;Gk.call(this,b,c)};u(Hk,Gk);Hk.prototype.Oe=function(){var a=new $f,b=this.Hh;b&&b.forEach(function(b,e){a.headers.set(e,b)});this.Ni&&a.my(!0);return a};Hk.prototype.vw=function(a){return!a.isDisposed()&&!a.af()};var Ik=function(a,b,c,e,f,g){M.call(this);this.df=l(a)?a:1;this.zf=l(f)?Math.max(0,f):0;this.kl=new Hk(b,c,e,g);this.hc=new A;this.Ja=new fi(this)};u(Ik,M);var Jk="ready complete success error abort timeout".split(" ");d=Ik.prototype;d.Qr=function(a){this.zf=Math.max(0,a)};d.send=function(a,b,c,e,f,g,k,p,w,B){if(this.hc.get(a))throw Error("[goog.net.XhrManager] ID in use");b=new Kk(b,r(this.FV,this,a),c,e,f,k,l(p)?p:this.df,w,B);this.hc.set(a,b);a=r(this.vV,this,a);this.kl.getObject(a,g);return b};
d.abort=function(a,b){var c=this.hc.get(a);if(c){var e=c.Es;c.N2(!0);b&&(e&&(this.wH(e,c.Vy),Xe(e,"ready",function(){this.kl.ii(e)},!1,this)),this.hc.remove(a));e&&e.abort()}};d.vV=function(a,b){var c=this.hc.get(a);c&&!c.Es?(this.MM(b,c.Vy),b.Qr(this.zf),b.jJ(c.Dk),b.my(c.Ni),c.Es=b,this.dispatchEvent(new Lk("ready",this,a,b)),this.HH(a,b),c.rz&&b.abort()):this.kl.ii(b)};
d.FV=function(a,b){var c=b.target;switch(b.type){case "ready":this.HH(a,c);break;case "complete":return this.CV(a,c,b);case "success":this.eW(a,c);break;case "timeout":case "error":this.pm(a,c);break;case "abort":this.tV(a,c)}return null};d.HH=function(a,b){var c=this.hc.get(a);!c||c.NA||c.uv()?(c&&(this.wH(b,c.Vy),this.hc.remove(a)),this.kl.ii(b)):(c.rW(),b.send(c.getUrl(),c.$X,c.fj,c.Op()))};
d.CV=function(a,b,c){var e=this.hc.get(a);if(7==b.mg||b.kd()||e.uv())if(this.dispatchEvent(new Lk("complete",this,a,b)),e&&(e.m3(!0),e.MA))return e.MA.call(b,c);return null};d.tV=function(a,b){this.dispatchEvent(new Lk("abort",this,a,b))};d.eW=function(a,b){this.dispatchEvent(new Lk("success",this,a,b))};d.pm=function(a,b){this.hc.get(a).uv()&&this.dispatchEvent(new Lk("error",this,a,b))};d.wH=function(a,b,c){this.Ja.Xc(a,c||Jk,b)};d.MM=function(a,b,c){this.Ja.listen(a,c||Jk,b)};
d.K=function(){Ik.R.K.call(this);this.kl.bb();this.kl=null;this.Ja.bb();this.Ja=null;this.hc.clear();this.hc=null};var Lk=function(a,b,c,e){K.call(this,a,b);this.id=c;this.Es=e};u(Lk,K);var Kk=function(a,b,c,e,f,g,k,p,w){this.ts=a;this.$X=c||"GET";this.fj=e;this.Hh=f||null;this.df=l(k)?k:1;this.Uz=0;this.rz=this.NA=!1;this.Vy=b;this.MA=g;this.Dk=p||"";this.Ni=!!w;this.Es=null};d=Kk.prototype;d.getUrl=function(){return this.ts};d.Op=function(){return this.Hh};d.Sp=function(){return this.df};d.rW=function(){this.Uz++};
d.uv=function(){return this.Uz>this.df};d.m3=function(a){this.NA=a};d.N2=function(a){this.rz=a};var Mk=function(){this.name="unknown";this.state="error";this.GW=null;this.allowStop=!0;this.serviceData=this.mi=null;this.extraData={}},Pk=function(a,b,c){this.Xd=a;(a=b)||(Nk||(Nk=new Ik(3,null,1,10,2E3)),a=Nk);this.lo=a;this.ll=[];c||(Ok||(Ok=new Ik(0,null,1,10,15E3)),c=Ok);this.WK=c;this.a=C("mr.dial.Client")};Pk.prototype.abort=function(){this.ll.forEach(function(a){this.lo.abort(a,!0);this.WK.abort(a,!0)},this)};var Nk=null,Ok=null,Qk=999;
Pk.prototype.launchApp=function(a,b){var c=J(),e=(++Qk).toString();this.ll.push(e);this.WK.send(e,this.xu(a),"POST",b,null,0,this.PB("launchApp","POST",e,c));return c.promise};Pk.prototype.PJ=function(a){var b=J(),c=(++Qk).toString();this.ll.push(c);this.lo.send(c,this.xu(a),"DELETE",null,null,0,this.PB("stopApp","DELETE",c,b),0);return b.promise};var Rk=function(a,b){this.VK=a;this.Ee=b;this.k2=!!b&&"running"==b.state};
Pk.prototype.wu=function(a){return new ie(function(b){var c=(++Qk).toString();this.ll.push(c);this.lo.send(c,this.xu(a),"GET",null,null,0,r(this.NY,this,c,b))},this)};
Pk.prototype.NY=function(a,b,c){xb(this.ll,a);a=c.target;Tf(this.a,"GetAppInfo","GET",a,!0);if(a.kd()){c=a.wD();if(!c)if(c=a.Kj(),"undefined"!=typeof DOMParser)c=(new DOMParser).parseFromString(c,"application/xml");else if(Ak){var e=new ActiveXObject("MSXML2.DOMDocument");e.resolveExternals=!1;e.validateOnParse=!1;try{e.setProperty("ProhibitDTD",!0),e.setProperty("MaxXMLSize",2048),e.setProperty("MaxElementDepth",256)}catch(p){}e.loadXML(c);c=e}else throw Error("Your browser does not support loading xml documents");
if(c)if((e=c.getElementsByTagName("service"))&&1==e.length){c=new Mk;for(var f=0,g=e[0].childNodes.length;f<g;f++){var k=e[0].childNodes[f];if("state"==k.nodeName){a:switch(k.textContent){case "running":k="running";break a;case "stopped":k="stopped";break a;default:k="error"}c.state=k}else"name"==k.nodeName?c.name=k.textContent:"link"==k.nodeName?c.mi=k.getAttribute("href"):"options"==k.nodeName?c.allowStop="false"!=k.getAttribute("allowStop"):c.extraData[k.nodeName]=k.innerHTML}if("unknown"==c.name)F(this.a,
"GET response missing name value"),b(new Rk(a,null));else if("error"==c.state)F(this.a,"GET response missing state value"),b(new Rk(a,null));else{if((e=/installable=(.+)/.exec(c.state))&&e[1])c.state="installable",c.GW=e[1];else if("running"!=c.state&&"stopped"!=c.state){F(this.a,"GET response has invalid state value");b(new Rk(a,null));return}b(new Rk(a,c))}}else F(this.a,"Invalid GET response (invalid service)"),b(new Rk(a,null));else F(this.a,"Empty response"),b(new Rk(a,null))}else F(this.a,"Request to "+
a.Qp()+" failed"),b(new Rk(a,null))};Pk.prototype.xu=function(a){var b=this.Xd.Tf;"/"!=b.charAt(b.length-1)&&(b+="/");return b+a};Pk.prototype.PB=function(a,b,c,e){return r(function(f){xb(this.ll,c);f=f.target;Tf(this.a,a,b,f,!0);f.kd()?e.resolve():e.reject(Error(Uf(f.mg)))},this)};var Sk=function(a,b,c){this.appName=b;this.launchParameter=c||""},Tk=C("mr.DialProvider"),Vk=function(a){if(Ma(a,"urn:dial-multiscreen-org:dial:application:")){var b=a.indexOf("?"),c=a.substring(42,0<b?b:void 0);a=c&&0<c.length?new Sk(a,c,0<b?a.substring(b+1):void 0):null}else a=Uk(a);return a},Wk=/__dialAppName__=([A-Za-z0-9-._~!$&'()*+,;=%]+)/,Xk=/__dialPostData__=([A-Za-z0-9]+={0,2})/,Uk=function(a){var b=(new yj(a)).Vf;if(!b)return null;var c=Wk.exec(b),c=c?c[1]:null;if(!c)return null;c=decodeURIComponent(c);
if(b=(b=Xk.exec(b))?b[1]:void 0)try{b=Nf(b)}catch(e){return E(Tk,"Invalid base64 encoded postData:"+b),null}return new Sk(a,c,b)};var Yk=function(a,b){this.Fa=a;this.appName=b};var Zk=function(a){this.Sc=new la;this.Rs=a};d=Zk.prototype;d.init=function(){qf(this)};d.clear=function(){this.Sc.clear()};d.add=function(a){this.jC(a.Fa.id)||(this.Sc.set(a.Fa.id,a),this.Rs.lY(a))};d.jC=function(a){return this.Sc.get(a)||null};d.kC=function(a){for(var b=fa(this.Sc),c=b.next();!c.done;c=b.next())if(c=fa(c.value),c.next(),c=c.next().value,c.Fa.sinkId==a)return c;return null};d.f1=function(a){if(a=this.kC(a))this.Sc.delete(a.Fa.id),this.Rs.XF(a)};
d.sH=function(a){var b=this.Sc.get(a);b&&(this.Sc.delete(a),this.Rs.XF(b))};d.Ze=function(){return ja(this.Sc.values(),function(a){return a.Fa})};d.EQ=function(){return ja(this.Sc.values())};d.Ra=function(){return"dial.ActivityRecords"};d.getData=function(){return[ja(this.Sc)]};d.wb=function(){var a=nf(this);a&&(this.Sc=new la(a))};var $k={A9:0,Jaa:1,T$:2,z9:3},al={ERROR:0,kaa:1,EMPTY:2},bl=function(a){kh("MediaRouter.Dial.Create.Route",a,$k)},cl=function(a){kh("MediaRouter.Dial.Device.Description.Failure",a,al)};var dl=function(a,b){this.a=C("mr.dial.AppDiscoveryService");this.gc=new na;this.V=a;this.Gc=b;this.Jb=new la;this.It=new la;this.Zd=null;this.Hk=!1};d=dl.prototype;d.init=function(){qf(this)};d.start=function(){F(this.a,"Starting periodic scanning.");this.Hk||(this.Hk=!0,this.oB())};d.stop=function(){F(this.a,"Stopping periodic scanning.");this.Hk&&(this.Hk=!1,this.Zd&&(clearTimeout(this.Zd),this.Zd=null),this.Jb.clear(),this.It.forEach(function(a){a.abort()}))};
d.lx=function(a){if(!this.gc.has(a)||this.OM(a))this.gc.add(a),0!=this.V.Zp()&&(this.Hk?this.V.mc().forEach(this.nB.bind(this,a)):this.start())};d.Gy=function(a){this.gc.delete(a)};d.hU=function(){return ja(this.gc)};
d.oB=function(){F(this.a,"Start app status scan.");var a=[];this.V.mc().forEach(function(b){a.push.apply(a,this.xn(b))},this);this.Gc.EQ().forEach(function(b){a.push(this.m2(b))},this);pe(a).Bb(function(){this.Hk&&!this.Zd&&(G(this.a,"Scan complete; scheduling for next scan."),this.Zd=setTimeout(this.zP.bind(this),6E4))},this)};d.zP=function(){G(this.a,"Start app status scan (timer-based)");this.Zd=null;this.oB()};
d.xn=function(a){if(!a.bl)return[];for(var b=[],c=fa(this.gc),e=c.next();!e.done;e=c.next())b.push(this.nB(e.value,a));return b};d.nB=function(a,b){if("unknown"!=b.Kd(a)&&36E5>t()-b.GQ(a)||!b.bl)return H();G(this.a,"Querying "+b.getId()+" for "+a+" to update app status");return this.dC(b,a).then(this.NX.bind(this,b,a))};
d.m2=function(a){var b=this.V.W(a.Fa.sinkId);if(!b)return E(this.a,"Activity refers to nonexistent sink: "+a.Fa.id),H();if(!b.bl)return H();a=a.appName;G(this.a,"Querying "+b.getId()+" for "+a+" to update activity");return this.dC(b,a).then(this.MX.bind(this,b,a))};d.NR=function(a){var b=this.It.get(a.getId());b||(b=new Pk(a),G(this.a,"Created DIAL client for "+a.getId()),this.It.set(a.getId(),b));return b};
d.dC=function(a,b){var c=el(a,b),e=this.Jb.get(c);if(e)return e;e=this.NR(a).wu(b);this.Jb.set(c,e);e.Bb(function(){this.Jb.delete(c)},this);return e};d.OQ=function(a,b){if(404==b.VK.Qa())return"unavailable";b=b.Ee;if("Netflix"==a)return this.yP(b);switch(b.state){case "running":case "stopped":return"available";default:return"unavailable"}};
d.yP=function(a){return a.extraData&&l(a.extraData.capabilities)&&"websocket"==a.extraData.capabilities&&("running"==a.state||"stopped"==a.state)?"available":"unavailable"};var el=function(a,b){return a.getId()+":"+b};d=dl.prototype;d.NX=function(a,b,c){if(404==c.VK.Qa()||c.Ee){c=this.OQ(b,c);G(this.a,"Got app status "+c+" from "+a.getId()+" for "+b);var e=a.Kd(b);a.En(b,c);c!=e&&this.V.uY(b,a)}else E(this.a,"Failed to process app availability; "+a.getId()+" does not support app availability"),a.tJ(!1)};
d.MX=function(a,b,c){(a=this.Gc.kC(a.getId()))&&a.appName==b&&!c.k2&&this.Gc.sH(a.Fa.id)};d.OM=function(a){return this.V.mc().some(function(b){return"unknown"==b.Kd(a)})};d.Ra=function(){return"dial.AppDiscoveryService"};d.getData=function(){return[this.hU()]};d.wb=function(){var a=nf(this);this.gc=new na(a||[])};var fl=function(){this.configId=this.modelName=this.deviceType=this.lu=this.nu=this.Bo=this.ipAddress=this.friendlyName=this.deviceLabel=this.ao=null};fl.prototype.Z7=function(){return this.deviceLabel?this.ao?this.friendlyName?this.ipAddress?this.Bo?this.nu?this.lu?null:"Missing expireTimeMillis":"Missing fetchTimeMillis":"Missing appUrl":"Missing ipAddress":"Missing friendlyName":"Missing uniqueId":"Missing deviceLabel"};
fl.prototype.toString=function(){return JSON.stringify(this,function(a,b){return n(b)&&0==b.indexOf("uuid:")?"***":b})};var il=function(a){this.ut=new A;this.Jb=new Sc;this.Rw=new A;var b;(b=a)||(gl||(gl=new Ik(3,null,1,10,2E3)),b=gl);this.lo=b;a||(hl||(hl=new Ik(2,null,1,10,3E3)),a=hl);this.qM=a;this.a=C("mr.dial.DeviceDescriptionService")},gl=null,hl=null;d=il.prototype;
d.KR=function(a){var b=this.bO(a);return b?(jh("MediaRouter.Dial.Device.Description.Cached"),H(b)):this.Jb.contains(a.deviceLabel)?I(Error("Duplicate request for device "+a.deviceLabel)):this.hQ(a)};d.bO=function(a){var b=this.ut.get(a.deviceLabel);return b?b.configId!=a.configId||t()>=b.lu?(G(this.a,"Removing invalid entry "+b.toString()),this.ut.remove(a.deviceLabel),null):b:null};
d.hQ=function(a){var b=J();this.Jb.add(a.deviceLabel);this.lo.send(a.deviceLabel,a.deviceDescriptionUrl,"GET",null,null,0,r(function(c){(c=this.k0(a,c))?b.resolve(c):b.reject(Error("Failed to get device description"))},this));return b.promise};
d.k0=function(a,b){this.Jb.remove(a.deviceLabel);b=b.target;Tf(this.a,"fetchDeviceDescription","GET",b);if(!b.kd())return F(this.a,"Request to "+b.Qp()+" failed"),cl(0),null;var c=b.wD();if(!c)return F(this.a,"Invalid or empty response"),cl(2),null;b=this.s_(b,a,c);if(!b)return cl(1),F(this.a,"Invalid device description"),null;F(this.a,"Got device description for "+b.deviceLabel);G(this.a,"... device description was: "+b.toString());null!=b.configId&&(G(this.a,"Caching device description for "+b.deviceLabel),
this.ut.set(a.deviceLabel,b));return b};
d.s_=function(a,b,c){var e=new fl;e.nu=t();e.lu=e.nu+18E5;e.deviceLabel=b.deviceLabel;e.configId=b.configId;e.Bo=a.getResponseHeader("Application-URL")||null;a=e.Bo;a=a instanceof yj?a.clone():new yj(a,void 0);e.ipAddress=a.Zf();e.deviceType=jl(c,"deviceType");e.modelName=jl(c,"modelName");e.friendlyName=jl(c,"friendlyName");if(a=e.friendlyName)200<a.length&&(a=a.substring(0,197)+"..."),Xa.test(a)&&(-1!=a.indexOf("&")&&(a=a.replace(Ra,"&amp;")),-1!=a.indexOf("<")&&(a=a.replace(Sa,"&lt;")),-1!=a.indexOf(">")&&
(a=a.replace(Ta,"&gt;")),-1!=a.indexOf('"')&&(a=a.replace(Ua,"&quot;")),-1!=a.indexOf("'")&&(a=a.replace(Va,"&#39;")),-1!=a.indexOf("\x00")&&(a=a.replace(Wa,"&#0;")));e.friendlyName=a;e.ao=jl(c,"UDN");a=e.Z7();G(this.a,"Device description: "+kl(c));return a?(E(this.a,"Device description failed to validate ("+a+"): "+JSON.stringify(e)),null):e};
var jl=function(a,b){return(a=a.getElementsByTagName(b))&&0!=a.length?a[0].textContent:null},kl=function(a){var b=function(a){for(var b=0,f=a.length;b<f;b++)a[b].textContent="***"};b(a.getElementsByTagName("UDN"));b(a.getElementsByTagName("serialNumber"));return(new XMLSerializer).serializeToString(a)};
il.prototype.yl=function(a){var b=this.Rw.get(a);if(b)return b.promise;b=J();this.Rw.set(a,b);this.qM.send(a,a,"GET",null,null,0,r(function(c){this.Rw.remove(a);c=c.target;Tf(this.a,"checkAccess","GET",c,!1);b.resolve(c.kd())},this));return b.promise};var ll=function(a,b){this.Nn=a;this.iB=b||new il;this.a=C("mr.dial.SinkDiscoveryService");this.Wd=new A;this.jh=r(this.JY,this);this.yB=r(this.LZ,this);this.Rq=this.ak=!1},ml={YouTube:"https://www.youtube.com",Netflix:"https://www.netflix.com",Pandora:"https://www.pandora.com",Radio:"https://www.pandora.com",Hulu:"https://www.hulu.com",Vimeo:"https://www.vimeo.com",Dailymotion:"https://www.dailymotion.com","com.dailymotion":"https://www.dailymotion.com"};d=ll.prototype;d.init=function(){qf(this)};
d.start=function(){this.ak||(F(this.a,"Starting..."),chrome.dial?(chrome.dial.onDeviceList.addListener(this.jh),chrome.dial.onError.addListener(this.yB),this.ak=!0,this.refresh()):(E(this.a,"Dial API not available, aborting start..."),this.ak=!1))};d.stop=function(){this.ak?(this.ak=!1,chrome.dial.onDeviceList.removeListener(this.jh),chrome.dial.onError.removeListener(this.yB)):F(this.a,"Was not started.")};
d.refresh=function(){this.ak?chrome.dial.discoverNow(r(function(a){F(this.a,"chrome.dial.discoverNow = "+a)},this)):F(this.a,"Not started. Ignoring discover().")};d.JY=function(a){F(this.a,"onDeviceList returned "+a.length+" devices");G(this.a,"....the list is: "+JSON.stringify(a));this.Rq=!1;var b=[],c=new Sc;a.forEach(function(a){b.push(this.l0(a).then(function(a){c.add(a.getId());this.HX(a)},ya,this))},this);oe(b).Bb(function(){this.Rq||this.ir(c)},this)};
d.HX=function(a){if(!this.Rq){G(this.a,"mayAddSink, id = "+a.getId());var b=this.Wd.get(a.getId());b?b.update(a)&&(G(this.a,"Updated sink "+b.getId()),this.Nn.Qc(b)):(G(this.a,"Adding new sink "+a.getId()),Sd(this.a,Kd,"...sink was "+a.ZJ()),this.Wd.set(a.getId(),a),this.Nn.$h(a))}};d.ir=function(a){this.Wd.A().forEach(function(b){a.contains(b.getId())||this.aO(b).then(function(a){a||(this.Nn.gf([b]),this.Wd.remove(b.getId()))},null,this)},this)};d.aO=function(a){return a.Re?this.iB.yl(a.Re):H(!1)};
d.l0=function(a){return this.iB.KR(a).then(function(b){var c;b.ao?(c=b.ao,0==c.indexOf("uuid:")&&(c=c.substr(5)),c=c.replace(/-/g,"").toLowerCase()):c="";var e=b.ao?Rf.O().Bp(c):a.deviceLabel,f=nl.test(b.modelName);return(new Ji(b.friendlyName,c)).Gr(e).a4(b.ipAddress).x3(b.Bo).w3(a.deviceDescriptionUrl).u4(b.modelName).tJ(!f)},null,this)};var nl=/Eureka Dongle|Chromecast Audio/i;d=ll.prototype;
d.LZ=function(a){switch(a.code){case "no_valid_network_interfaces":case "network_disconnected":E(this.a,"DIAL error: "+a.code+". Clear device list now.");this.Nn.gf(this.Wd.A());this.Wd.clear();this.Rq=!0;break;case "no_listeners":case "socket_error":case "cellular_network":case "unknown":E(this.a,"DIAL error: "+a.code+". Keep device list.");break;default:E(this.a,"Unhandled DIAL error: "+a.code)}};d.W=function(a){return this.Wd.get(a,null)};
d.LU=function(a){var b=[];this.mc().forEach(function(c){"available"==c.Kd(a)&&b.push(c.cg())});var c=ml[a];return new hk(b,c?[c]:void 0)};d.mc=function(){return this.Wd.A()};d.Zp=function(){return this.Wd.N()};d.uY=function(a,b){this.Nn.Qc(b)};d.Ra=function(){return"dial.DialSinkDiscoveryService"};d.getData=function(){return[this.Wd.b()]};d.wb=function(){var a=nf(this);if(a)for(var b in a)this.Wd.set(b,Ki(a[b]))};var ol=function(a,b,c){this.C=a;this.sc=b||new ll(this);this.Gc=new Zk(this);this.Ic=c||new dl(this.sc,this.Gc);this.b2=new aj("dial.RouteIdGenerator")};d=ol.prototype;d.a=C("mr.DialProvider");d.getName=function(){return"dial"};d.jd=function(){this.b2.vB();this.Gc.init();this.sc.init();this.Ic.init();this.Km()};d.Ul=function(a){G(this.a,"GetAvailableSinks for "+a);return(a=Vk(a))?this.sc.LU(a.appName):ik};d.Di=function(a){if(a=Vk(a))this.Ic.lx(a.appName),this.Km()};
d.Fi=function(a){if(a=Vk(a))this.Ic.Gy(a.appName),this.Nq()};d.Ci=function(){this.Km()};d.Ei=function(){this.Nq()};d.Nq=function(){(0==this.sc.Zp()||0==this.Ic.gc.size&&0==this.Gc.Sc.size)&&this.Ic.stop()};d.Km=function(){this.sc.start();0<this.sc.Zp()&&(0<this.Ic.gc.size||0<this.Gc.Sc.size)&&this.Ic.start()};d.W=function(a){return(a=this.sc.W(a))?a.cg():null};d.Ze=function(){return this.Gc.Ze()};
d.ge=function(a,b,c,e){var f=this.sc.W(b);if(!f)return bl(0),I(Error("Unkown sink: "+b));Rf.O().hi=new Qf(f.cc,f.la);var g=Vk(a);if(!g)return I(Error("No app name set."));f.Ir(!0);var k=g.appName,p=new Pk(f);return p.wu(k).then(function(a){if(!a.Ee)throw Error("Failed to get app info");if("running"==a.Ee.state)return p.PJ(k)}).then(function(){return p.launchApp(k,g.launchParameter)}).then(function(){return this.de(b,a,!0,k,c,e)},null,this).na(function(a){bl(3);throw a;}).Bb(function(){f.Ir(!1)})};
d.Kh=function(){return I(Error("no supported"))};d.dh=function(){return I(Error("no supported"))};d.Sf=function(){};d.de=function(a,b,c,e,f,g){bl(1);a=mk(f,this.getName(),a,b,c,e,null);a.offTheRecord=g;this.Gc.add(new Yk(a,e));return a};d.$h=function(a){this.C.onSinkAvailabilityUpdated(this,1);this.Km();this.Ic.xn(a);this.C.rc();Rf.O().gi=new Qf(a.cc,a.la)};d.gf=function(a){if(0==this.sc.Zp())this.C.onSinkAvailabilityUpdated(this,0);this.Nq();a.forEach(function(a){this.Gc.f1(a.getId())},this);this.C.rc()};
d.Qc=function(){this.C.rc()};d.lY=function(a){this.Km();this.C.rk(this,a.Fa)};d.XF=function(a){a=a.Fa;if(a.isLocal)this.C.onPresentationConnectionStateChanged(a.id,"terminated");this.Nq();this.C.Yh(this,a)};d.tc=function(a){var b=this.Gc.jC(a);if(!b)return H();this.Gc.sH(a);a=this.sc.W(b.Fa.sinkId);if(!a)return H();(new Pk(a)).PJ(b.appName);return H()};d.bg=function(){return null};d.bm=function(){return null};d.Fg=function(){return I(Error("DIAL sending message is not supported"))};
d.wl=function(a,b){b=this.sc.W(b);return!b||th(a)?!1:(a=Vk(a))?"available"==b.Kd(a.appName):!1};d.Wi=function(){return!1};d.sf=function(){return null};var pl=function(a,b){this.UN=a;this.Yt=b;this.Hf=this.UN.V;this.a=C("mr.cast.CastDialSinkDiscoveryCallbacks")};d=pl.prototype;d.BP=function(a){return this.Hf.yl(a)};d.DD=function(a){var b=this.Hf.W(a.getId());return b?b:(a=a.la)?this.Hf.JU(a,Rf.O().xl||8009):null};d.$h=function(a){this.DD(a)?Fi(2):this.jK(a);this.Yt.$h(a)};d.jK=function(a){var b=Ni(a);b&&this.BP(b).then(function(c){c?this.DD(a)?Fi(2):(this.Hf.so(b),Fi(0)):jh("MediaRouter.Dial.Sink.Discovered.NonCast")},ya,this)};
d.gf=function(a){v(a,function(a){var c=this.Hf.W(a.getId());c&&c.Ml&&this.Hf.nn(a.getId())},this);this.Yt.gf(a)};d.Qc=function(a){var b=this.Hf.W(a.getId());b?b.Ml&&(b.update(a.Zl(),a.la,b.ub(),b.Zc)&&F(this.a,"Updated Cast sink with DIAL sink: "+a.getId()),this.Hf.Qc(b)):this.jK(a);this.Yt.Qc(a)};var ql=function(a,b){this.V=new ll(new pl(b,this));this.Fk=new A;this.C=a;this.Nx=this.An=0;this.fw=new Sc;this.La=new ol(this,this.V)},rl=/__dialAppName__/;d=ql.prototype;d.getName=function(){return this.La.getName()};d.jd=function(){this.La.jd()};d.Ze=function(){return this.La.Ze()};d.jG=function(){};d.Ul=function(a){return this.La.Ul(a)};d.Di=function(a){this.La.Di(a)};d.Fi=function(a){this.La.Fi(a)};d.Ci=function(a){this.La.Ci(a)};d.Ei=function(a){this.La.Ei(a)};d.W=function(a){return this.La.W(a)};
d.iR=function(a){return new Pk(a)};d.OR=function(a){return this.V.W(a)};
d.wP=function(a,b,c,e){var f=Vk(a),g=this.OR(b);if(!g)return I(Error("Attempting custom launch with closed route"));g.Ir(!0);var k=f.appName;if(!k)return I(Error("No app name given"));var p=null;return this.iR(g).wu(k).then(function(a){if(!a.Ee)return I(Error("Failed to get app info"));p=a.Ee},null,this).then(function(){return this.La.de(b,a,!0,k,e||"",c)},null,this).then(function(b){var c={Fa:b,LE:!1,Wr:g,appName:k,Ee:p,launchParameter:f.launchParameter,session:null,clientId:null};this.Fk.set(b.id,
c);var e=Nj(a);if(!e)return I(Error("No client ID"));this.NO(c,e);return b},null,this).Bb(function(){g.Ir(!1)})};d.MW=function(a){return rl.test(a)};d.ge=function(a,b,c,e,f,g,k){return this.MW(a)?this.wP(a,b,e,c):this.La.ge(a,b,c,e,f,g,k)};
d.tc=function(a){var b=this.Fk.get(a);return b&&b.session&&b.clientId?(a={receiver:this.Ot(b.Wr),action:chrome.cast.nl.STOP},a=new vj("receiver_action",a),a.clientId=b.clientId,this.C.Sd(this,b.Fa.id,a),a=new vj("remove_session",b.session.sessionId,void 0),a.clientId=b.clientId,this.C.Sd(this,b.Fa.id,a),b.LE=!0,H()):this.La.tc(a)};
d.Fg=function(a,b,c){var e=JSON.parse(b);switch(e.type){case "client_connect":return this.z1(a,e.clientId);case "custom_dial_launch":if(this.fw.contains(e.sequenceNumber))return this.FY(a,e);break;case "v2_message":if("STOP"==e.message.type)return this.tc(a),H()}return this.La.Fg(a,b,c)};d.ET=function(){var a=String(this.Nx);this.Nx=(this.Nx+1)%9007199254740992;return a};
d.NO=function(a,b){var c=this.Ot(a.Wr),e=new vj("receiver_action",{receiver:c,action:chrome.cast.nl.CAST});e.clientId=b;this.C.Sd(this,a.Fa.id,e);c=new chrome.cast.T(this.ET(),"",a.appName,[],c);a.session=c;a.clientId=b;c=new vj("new_session",c);c.clientId=b;this.C.Sd(this,a.Fa.id,c)};
d.FY=function(a,b){this.fw.remove(b.sequenceNumber);b=b.message;a=this.Fk.get(a);if(!a)return I(Error("Unknown route"));if(b&&!b.doLaunch)return H();var c=a.Wr;if(!c)return I(Error("Custom launch response for sink that no longer exists"));var c=new Pk(c),e=a.launchParameter,e=(b?b.launchParameter:null)||e;return c.launchApp(a.appName,e)};d.Ot=function(a){var b=new chrome.cast.Ms(a.getId(),a.Zl());b.ipAddress=a.la;b.receiverType=chrome.cast.oo.DIAL;return b};
d.DT=function(){var a=this.An;this.An=(this.An+1)%9007199254740992;return a};d.z1=function(a,b){a=this.Fk.get(a);if(!a)return I(Error("Unknown route"));var c=this.Ot(a.Wr);c.receiverType=chrome.cast.oo.DIAL;c=new vj("custom_dial_launch",new chrome.cast.ez(c,a.Ee.state,a.Ee.extraData));c.clientId=b;c.sequenceNumber=this.DT();this.fw.add(c.sequenceNumber);this.C.Sd(this,a.Fa.id,c);return H()};d.bg=function(a){return this.La.bg(a)};d.bm=function(a){return this.La.bm(a)};
d.wl=function(a,b){return this.La.wl(a,b)};d.Wi=function(a,b){return this.La.Wi(a,b)};d.dh=function(a,b,c,e,f){return this.La.dh(a,b,c,e,f)};d.Kh=function(a,b,c,e,f,g){return this.La.Kh(a,b,c,e,f,g)};d.Sf=function(a){var b=this.Fk.get(a);this.Fk.remove(a);b&&b.LE?this.La.tc(a):this.La.Sf(a)};d.rc=function(){this.C.rc()};d.onSinkAvailabilityUpdated=function(a,b){this.C.onSinkAvailabilityUpdated(a,b)};d.rk=function(a,b){this.C.rk(this,b)};d.Yh=function(a,b){this.C.Yh(this,b)};
d.Zh=function(a,b){this.C.Zh(this,b)};d.Sd=function(a,b,c){this.C.Sd(this,b,c)};d.onPresentationConnectionStateChanged=function(a,b){this.C.onPresentationConnectionStateChanged(a,b)};d.onPresentationConnectionClosed=function(a,b,c){this.C.onPresentationConnectionClosed(a,b,c)};d.Zu=function(a){return this.C.Zu(a)};d.cv=function(){return this.C.cv()};d.We=function(){return this.C.We()};d.Vq=function(a,b,c){this.C.Vq(this,b,c)};d.Dw=function(a){this.C.Dw(a)};d.$h=function(a){this.La.$h(a)};d.gf=function(a){this.La.gf(a)};
d.Qc=function(a){this.La.Qc(a)};d.Pn=function(){};d.sf=function(a,b){return this.La.sf(a,b)};d.mx=function(a){this.C.mx(a)};d.Hv=function(){return this.C.Hv()};var sl=function(a,b,c){this.name="RouteRequestError";this.message=b||"";if(c)this.stack=c;else if(Error.captureStackTrace)Error.captureStackTrace(this,sl);else if(b=Error().stack)this.stack=b;this.errorCode=a};u(sl,Error);var tl=function(a,b){this.routeId=a;this.message=b};var ul=function(a){this.ek=a;this.mf=new Bk};d=ul.prototype;d.enqueue=function(a){this.mf.N()==this.ek&&this.mf.Rf();this.mf.enqueue(a)};d.Rf=function(){return this.mf.Rf()};d.lP=function(){var a=this.mf.A();this.mf.clear();return a};d.Eb=function(){return this.mf.Eb()};d.OW=function(){return this.mf.N()==this.ek};d.A=function(){return this.mf.A()};var vl=function(){this.zk={};this.$j={};this.a=C("mr.MrRouteMessageSender")};d=vl.prototype;d.iw=function(a){if(this.jE(a))return H(this.oT(a));var b=J();this.$j[a]=b;return b.promise};d.vy=function(a){(a=this.tx(a))&&a.resolve([])};d.send=function(a,b){if(!this.LX(a,b)){var c=this.zk[a];c||(c=new ul(50),this.zk[a]=c);c.OW()&&(E(this.a,"Queue is full; dropping oldest message"),G(this.a,"   for route "+a));c.enqueue(new tl(a,b))}};d.Yh=function(a){delete this.zk[a];(a=this.tx(a))&&a.reject(Error("Route closed"))};
d.jE=function(a){return!!this.zk[a]&&!this.zk[a].Eb()};d.oT=function(a){return(a=this.zk[a])&&!a.Eb()?a.lP():[]};d.tx=function(a){var b=this.$j[a];b&&delete this.$j[a];return b||null};d.LX=function(a,b){var c=this.tx(a);c&&c.resolve([new tl(a,b)]);return!!c};var wl={oz:0,dz:1},xl=function(a){kh("MediaRouter.CastStreaming.Start.Success",a,wl)};var yl=C("mr.mirror.cast.LogUploader"),Al=function(a,b,c){zl("raw_events.log.gz",a,b,c);return b?"https://crash.corp.google.com/samples?stbtiq="+b:""},zl=function(a,b,c,e){if(0==b.size)F(yl,"Trying to upload an empty file to Crash"),e&&e(null);else{var f=new FormData;f.append("prod","Cast");f.append("ver",chrome.runtime.getManifest().version);f.append(a,b);c&&f.append("comments",c);dg("https://clients2.google.com/cr/report",function(a){a=a.target;var b=null;a.kd()?(b=a.Kj(),F(yl,"Upload to Crash succeeded: "+
b)):F(yl,"Upload to Crash failed. HTTP status: "+a.Qa());e&&e(b)},"POST",f,void 0,3E4)}};var Bl=function(){this.ym=0};za(Bl);var Cl=C("mr.mirror.cast.LogUtils");Bl.prototype.m6=function(){var a={fraction:.01,autoSubmitTimeLimitMillis:6048E5},b=a.autoSubmitTimeLimitMillis,c=t();return this.ym&&b&&c-this.ym<b?!1:Math.random()<a.fraction};
var Dl=function(){this.ext="MR";this.senderProductName="Google Chrome";this.senderVersion=qi;this.senderPlatform=bd;this.senderUserAgent=hc||""},El=function(a,b,c,e){var f=new Dl;f.extVersion=chrome.runtime.getManifest().version;f.extChannel="public";f.minBitrate=c.minVideoBitrate;f.maxBitrate=c.maxVideoBitrate;f.resolution=c.ZS();f.minResolution=c.pT();f.resolutionChangePolicy=c.pU();f.maxFrameRate=c.maxFrameRate;f.minLatency=c.minLatencyMillis;f.maxLatency=c.maxLatencyMillis;f.animatedLatency=c.animatedLatencyMillis;
f.useDscp=c.dscpEnabled;f.useTdls=c.useTdls;null!==b&&(f.receiverVersion=b);null!==a&&(f.receiverProductName=a);e.length&&(f.Ija=e);return f},Fl=function(a,b,c,e,f){F(Cl,"getRawEvents");var g=J(),k=function(b){F(Cl,"Got receiver version: "+b);b=JSON.stringify(El(c,b,e,f));chrome.cast.streaming.rtpStream.getRawEvents(a,b,function(a){g.resolve(a)})};"Chromecast"==c?lg(b).then(k,g.reject):k(null);return g.promise},Gl=function(a,b,c,e){F(Cl,"getStats");var f=J(),g=function(b){F(Cl,"Got receiver version: "+
b);var g=El(c,b,e,[]);chrome.cast.streaming.rtpStream.getStats(a,function(a){var b={tags:g};Zb(b,a);f.resolve(b)})};"Chromecast"==c?lg(b).then(g,f.reject):g(null);return f.promise};Bl.prototype.Ra=function(){return"mirror.cast.LogUtils"};Bl.prototype.getData=function(){return[null,{lastAutoSubmitMillis:this.ym}]};Bl.prototype.wb=function(){var a=of(this);this.ym=a&&a.lastAutoSubmitMillis||0};var Hl=function(a,b){ei.call(this,a,b)};u(Hl,ei);var Il=function(a){return a&&a.getAudioTracks()&&0<a.getAudioTracks().length?a.getAudioTracks()[0]:null},Jl=function(a){return a&&a.getVideoTracks()&&0<a.getVideoTracks().length?a.getVideoTracks()[0]:null};var Kl=C("mr.NetworkUtils"),Ll=function(a,b){if(!Zh)return I("TDLS feature not enabled.");var c=J();chrome.networkingPrivate.setWifiTDLSEnabledState(a,b,function(a){chrome.runtime.lastError?(Kl.ea("Unable to set TDLS state: state = "+b+", error = "+chrome.runtime.lastError.message),c.reject("Unable to set TDLS state to "+b+".")):(Kl.info("TDLS state changed: state = "+b+", status = "+a),c.resolve(a))});return c.promise};var Ml=function(a,b){this.sessionId=a;this.seqNum=b;this.type="PRESENTATION"};var Nl=function(a,b,c){this.type="GET_STATUS";this.sessionId=a;this.seqNum=b;this.get_status=c};var Ol=function(a,b){this.address=a;this.port=b},Pl=function(a,b){yh.call(this,b);this.a=C("mr.mirror.cast.Session");this.sk=a;this.Ea=a.bg().clone();this.Qd=$g.Lu(b.id);this.H=b.qe.sessionId;this.sd=new Ol(b.qe.DJ,2344);this.nr=b.qe.EJ;this.uc=null;this.Wg=!1;this.Mb=null;this.Li=!1;this.Mg=0;this.Ca=this.vo=this.wo=null;this.f0=["H264","VP8"];this.yv=new A;this.Wz=null;this.PH=r(this.KZ,this);this.OH=r(this.JZ,this);this.fm=null;this.gn=new hi(30);this.iH=!1;this.dl=null;this.Jx=new aj("mirror.cast.SeqNumGenerator");
this.Ec=this.oe=null};u(Pl,yh);d=Pl.prototype;
d.start=function(a){var b=Il(a);a=Jl(a);this.oe=new bh("MediaRouter.CastStreaming.Session.Launch");this.Ca=J();this.wW();this.Ea.useTdls&&Ll(this.sd.address,!0).then(function(a){"Connected"!=a&&(this.Ea.useTdls=!1)},function(){this.Ea.useTdls=!1},this);chrome.cast.streaming.session.create(b,a,r(function(a,b,f){this.uc=a;this.Mb=b;this.Mg=f;this.Qd.onMessage=r(this.Wq,this);this.Ix({type:"OFFER",sessionId:this.getId(),seqNum:this.Jx.Tp(),offer:this.El()})},this));return this.Ca.promise};
d.stop=function(){this.Ec&&(this.Ec.end(),this.Ec=null);F(this.a,"Stopping "+this.getId());null!==this.uc&&(chrome.cast.streaming.rtpStream.stop(this.uc),chrome.cast.streaming.rtpStream.destroy(this.uc),this.uc=null,this.Wg=!1);null!==this.Mb&&(chrome.cast.streaming.rtpStream.stop(this.Mb),chrome.cast.streaming.rtpStream.destroy(this.Mb),this.Mb=null,this.Li=!1);this.Mg&&(chrome.cast.streaming.udpTransport.destroy(this.Mg),this.Mg=0);this.Ea.useTdls&&Ll(this.sd.address,!1);this.Ca&&(this.Ca.resolve(this),
this.Ca=null);chrome.cast.streaming.rtpStream.onStarted.removeListener(this.PH);chrome.cast.streaming.rtpStream.onError.removeListener(this.OH);null!==this.fm&&(window.clearTimeout(this.fm),this.fm=null);this.wo=this.vo=null;if(this.dl&&this.dl.onSessionStop)this.dl.onSessionStop(this.sd);return!0};d.m4=function(a){this.Wg&&chrome.cast.streaming.rtpStream.toggleLogging(this.uc,a);this.Li&&chrome.cast.streaming.rtpStream.toggleLogging(this.Mb,a)};
d.getLogs=function(){if(!this.Wg&&!this.Li)return I(Error("No streams has been started yet."));var a=[];if(this.Wg){var b=Fl(this.uc,this.sd.address,this.nr,this.Ea,this.gn.A());a.push(b)}this.Li&&(b=Fl(this.Mb,this.sd.address,this.nr,this.Ea,this.gn.A()),a.push(b));return oe(a).then(function(a){a=new Blob(a,{type:"application/gzip"});F(this.a,"Events blob size: "+a.size);return a},null,this)};
d.getStats=function(){var a=[];if(this.Wg){var b=Gl(this.uc,this.sd.address,this.nr,this.Ea);a.push(b)}this.Li&&(b=Gl(this.Mb,this.sd.address,this.nr,this.Ea),a.push(b));this.gn.N()&&a.push(H({receiverStatusData:this.gn.A()}));return oe(a).then(function(a){var b={};v(a,function(a){Zb(b,a)});return b})};
d.HO=function(){var a=chrome.cast.streaming.rtpStream.getSupportedParams(this.uc)[0];a.payload.maxLatency=this.Ea.maxLatencyMillis;a.payload.minLatency=this.Ea.minLatencyMillis;a.payload.animatedLatency=this.Ea.animatedLatencyMillis;a.payload.ssrc=Math.floor(499999*Math.random())+1;a.payload.feedbackSsrc=2;a.payload.payloadType=127;a.payload.aesKey=this.wo;a.payload.aesIvMask=this.vo;return a};
d.VO=function(){var a=[];if(null===this.Mb)return a;var b=chrome.cast.streaming.rtpStream.getSupportedParams(this.Mb);this.f0.forEach(function(c){var e=qb(b,function(a){return a.payload.codecName.toLowerCase()==c.toLowerCase()},this);e&&(e.payload.maxFrameRate=this.Ea.maxFrameRate,e.payload.minBitrate=this.Ea.minVideoBitrate,e.payload.maxBitrate=this.Ea.maxVideoBitrate,e.payload.maxLatency=this.Ea.maxLatencyMillis,e.payload.minLatency=this.Ea.minLatencyMillis,e.payload.animatedLatency=this.Ea.animatedLatencyMillis,
e.payload.aesKey=this.wo,e.payload.aesIvMask=this.vo,e.payload.ssrc=Math.floor(499999*Math.random())+500001,e.payload.feedbackSsrc=12,e.payload.payloadType=96,a.push(e))},this);return a};
d.El=function(){var a=0,b=[];if(this.uc){var c=this.HO();this.Wz=c;c={index:a,type:"audio_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ea.animatedLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,bitRate:128E3,sampleRate:c.payload.clockRate,timeBase:"1/"+c.payload.clockRate,channels:c.payload.channels,rtpExtensions:["adaptive_playout_delay"]};this.Ea.enableLogging&&Zb(c,{receiverRtcpEventLog:!0});
this.Ea.dscpEnabled&&Zb(c,{receiverRtcpDscp:46});b.push(c);a++}this.VO().forEach(function(c){var f={index:a,type:"video_source",codecName:c.payload.codecName.toLowerCase(),rtpProfile:"cast",rtpPayloadType:c.payload.payloadType,ssrc:c.payload.ssrc,targetDelay:this.Ea.animatedLatencyMillis,aesKey:c.payload.aesKey,aesIvMask:c.payload.aesIvMask,maxFrameRate:Math.round(1E3*c.payload.maxFrameRate)+"/1000",timeBase:"1/90000",maxBitRate:c.payload.maxBitrate,resolutions:[{width:this.Ea.maxWidth,height:this.Ea.maxHeight}],
rtpExtensions:["adaptive_playout_delay"]};this.Ea.enableLogging&&Zb(f,{receiverRtcpEventLog:!0});this.Ea.dscpEnabled&&Zb(f,{receiverRtcpDscp:46});b.push(f);this.yv.set(a,c);a++},this);return{supportedStreams:b}};d.KZ=function(a){a==this.uc?this.Wg=!0:a==this.Mb&&(this.Li=!0);this.Wg&&(null===this.Mb||this.Li)&&(this.m4(this.Ea.enableLogging),this.Ca&&(this.Ca.resolve(this),this.Ca=null));this.Ec=new gh("MediaRouter.CastStreaming.Session.Length")};
d.JZ=function(a,b){if(a==this.uc)E(this.a,"Audio stream error "+b);else if(a==this.Mb)E(this.a,"Video stream error "+b);else{E(this.a,"Error for stream "+a+": "+b);return}this.Ca&&(this.Ca.reject(Error("Error for stream "+a+": "+b)),this.Ca=null);this.stop()};
d.J6=function(a,b){G(this.a,"Starting streaming ... "+JSON.stringify({udpTransportId:this.Mg,receiverIpEndPoint:this.sd,"audio ID":this.uc,"video ID":this.Mb,"audio params":a,"video params":b}));if(Ea(chrome.cast.streaming.udpTransport.S4)){var c={};this.Ea.dscpEnabled&&(F(this.a,"Enable DSCP in sender."),c.DSCP=!0);chrome.cast.streaming.udpTransport.S4(this.Mg,c)}chrome.cast.streaming.udpTransport.setDestination(this.Mg,{address:this.sd.address,port:this.sd.port});chrome.cast.streaming.rtpStream.onStarted.addListener(this.PH);
chrome.cast.streaming.rtpStream.onError.addListener(this.OH);a&&chrome.cast.streaming.rtpStream.start(this.uc,a);b&&chrome.cast.streaming.rtpStream.start(this.Mb,b)};
d.Wq=function(a){if("urn:x-cast:com.google.cast.webrtc"==a.namespace_){a=a.data;G(this.a,a);var b=JSON.parse(a);if("ANSWER"==b.type&&"ok"==b.result){b.answer.udpPort&&(this.sd.port=b.answer.udpPort);this.iH=!!b.answer.receiverGetStatus;if(this.dl&&this.dl.onAnswer)this.dl.onAnswer(this.sd);this.oe&&(this.oe.end(),this.oe=null);F(this.a,"Starting streaming");var c=this.Wz,e=null;b.answer.sendIndexes&&b.answer.sendIndexes.forEach(function(a){c&&0==a?b.answer.ssrcs&&b.answer.ssrcs[a]&&(c.payload.feedbackSsrc=
b.answer.ssrcs[a]):this.yv.Oa(a)&&(e?E(this.a,"Receiver selected multiple video stream"):(e=this.yv.get(a),b.answer.ssrcs&&b.answer.ssrcs[a]&&(e.payload.feedbackSsrc=b.answer.ssrcs[a])))},this);null!==this.Mb&&null===e&&(E(this.a,"Receiver is capable of video, but did not specify a video stream index in the ANSWER message."),chrome.cast.streaming.rtpStream.destroy(this.Mb),this.Mb=null);if(c||e){this.tD();this.J6(c,e);this.Ca&&(this.Ca.resolve(this),this.Ca=null);return}}if("STATUS_RESPONSE"!=b.type||
null===b.status)this.Ca&&(this.Ca.reject(Error("Invalid answer: "+b)),this.Ca=null),this.stop();else{a={};for(var f in b.status){var g=b.status[f];Ca(g)&&g.length?a[f]=g.pop():a[f]=g}f={};f[(new Date).toISOString()]=a;this.gn.add(f)}}};d.wW=function(){this.vo=Ff(window.crypto.getRandomValues(new Uint8Array(16)));this.wo=Ff(window.crypto.getRandomValues(new Uint8Array(16)))};d.$H=function(){this.Ix(this.XT())};d.Ix=function(a){this.Qd.sendMessage(a,{namespace:"urn:x-cast:com.google.cast.webrtc"})};
d.tD=function(){this.fm=null;if(this.Mg&&this.iH){var a=new Nl(this.getId(),this.Jx.Tp(),["wifiSnr","wifiSpeed","wifiFcsError"]);this.Ix(a);this.fm=window.setTimeout(r(this.tD,this),12E4)}};d.XT=function(){var a=new Ml(this.H,this.Jx.Tp());a.title=this.qx||void 0;a.icons=this.iconUrl&&!this.uq?[new chrome.cast.Image(this.iconUrl)]:[];return a};d.getId=function(){return this.H};d.Gj=function(){return this.sk};d.K=function(){this.Qd.bb();this.stop()};var Ql=function(a){xh.call(this,"cast_streaming",a)};u(Ql,xh);d=Ql.prototype;d.getName=function(){return"cast_streaming"};d.Gj=function(a,b){return new Hl(a,b)};d.Pt=function(a,b){if(a instanceof Hl)return new Pl(a,b);throw Error("Invalid parameters");};d.kx=function(){xl(0)};d.gx=function(){xl(1)};d.hx=function(){jh("MediaRouter.CastStreaming.Session.End")};d.ix=function(a){kh("MediaRouter.CastStreaming.Start.Failure",a,lh)};d.jx=function(){jh("MediaRouter.CastStreaming.Stream.End")};
d.bA=function(){var a=this.Pa,b=a.getLogs().then(function(a){return a},function(a){E(this.m,"Get cast streaming logs failed.",a)},this),a=a.getStats().then(function(a){return a},function(a){E(this.m,"Get cast streaming stats failed.",a)},this),c=J();chrome.metricsPrivate.getIsCrashReportingEnabled(function(a){c.resolve(a)});return oe([b,a,c.promise]).then(function(a){var b=a[0],c=new FileReader;c.onloadend=function(){xf("mr.temp.mirror.cast.Service.mirrorLogs",c.result)};c.readAsBinaryString(b);var k=
a[1];a[2]&&(b&&Bl.O().m6()?Al(b,void 0,this.wY.bind(this)):k&&zl("stats.json",new Blob([JSON.stringify(k)],{type:"application/json"}),void 0,void 0))},null,this)};d.wY=function(a){a&&(Bl.O().ym=t())};d.sT=function(a){F(this.m,"Received message to upload logs for "+a);return this.Pa?this.Pa.getLogs().then(function(b){return Al(b,a)},function(b){E(this.m,"Get cast streaming logs failed.",b);return this.EF(a)},this):H(this.EF(a))};
d.EF=function(a){var b=window.localStorage["mr.temp.mirror.cast.Service.mirrorLogs"];if(!b)return"";window.localStorage.removeItem("mr.temp.mirror.cast.Service.mirrorLogs");F(this.m,"Uploading saved logs for feedback.");for(var c=new Uint8Array(b.length),e=0;e<c.length;e++)c[e]=b.charCodeAt(e);return Al(new Blob([c],{type:"application/gzip"}),a)};var Rl={oz:0,dz:1},Sl=function(a){kh("MediaRouter.WebRtc.Start.Success",a,Rl)};var Ul=function(a,b){ve.call(this);this.a=Qd("cv2.PeerConnection");this.QX=Tl;this.o=this.OO(b);this.bP=this.JO(a);this.JP=!0;this.fI=J();this.Kx=!1;this.Sq=0;this.mq=null;this.TE=this.ww=0;this.jc=!1;this.cG=this.dG=this.zw=this.kG=this.DY=ya};u(Ul,ve);var Tl={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},Vl={mandatory:{IceRestart:!0,OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};d=Ul.prototype;d.M4=function(a){this.zw=a};d.L4=function(a){this.dG=a};d.K4=function(a){this.cG=a};
d.O4=function(a){this.kG=a};d.N4=function(a){this.bP.onmessage=function(b){a(b.data)}};d.Lv=function(){return this.jc};d.OT=function(a){var b={};b.iceServers=[{url:"stun:stun.l.google.com:19302"}].concat(a);return b};d.OO=function(a){a=this.OT(a);var b=new webkitRTCPeerConnection(a);b.onicecandidate=r(this.Bw,this);b.Fia=r(this.SY,this);b.oniceconnectionstatechange=r(this.RY,this);F(this.a,"Created webkitRTCPeerConnnection with config: "+JSON.stringify(a));return b};
d.JO=function(a){return this.o.createDataChannel(a,{reliable:!1})};d.start=function(){this.jc||(this.jc=!0,this.El())};d.stop=function(){F(this.a,"Stopping peer connection...");this.jc&&(this.jc=!1,"closed"!=this.o.signalingState&&this.o.close())};d.addStream=function(a){this.o.addStream(a)};d.removeStream=function(a){this.jc&&this.o.removeStream(a)};d.K=function(){this.stop();this.o=null};
d.El=function(){F(this.a,"Sending offer to peer.");var a=this;this.ww=t();this.o.createOffer(r(this.NI,this),function(b){E(a.a,"Error creating offer: "+JSON.stringify(b))},this.QX);this.fI.promise.then(function(b){a.kG(b)})};d.NI=function(a){F(this.a,"Setting local description: "+JSON.stringify(a));var b=this;this.o.setLocalDescription(a,function(){F(b.a,"Local description set successfully")},function(a){E(b.a,"Error setting local description: "+JSON.stringify(a))})};
d.wQ=function(a){return{type:a.type,sdp:a.sdp}};d.setRemoteDescription=function(a){G(this.a,"<===: "+JSON.stringify(a));a=new RTCSessionDescription(a);F(this.a,"Setting remote description: "+JSON.stringify(a));var b=this;this.o.setRemoteDescription(a,function(){F(b.a,"Remote description set successfully.")},function(a){E(b.a,"Error setting remote description: "+JSON.stringify(a))})};
d.Bw=function(a){var b=this;a.candidate?(this.Sq++,this.TE=t(),1==this.Sq?this.mq=df(function(){F(b.a,"ICE candidate gathering timed out.");b.mq=null;b.Ax()},5E3):this.Kx&&E(this.a,"Received ICE candidate after resolving session description.")):(F(this.a,"End of ICE candidates."),dh("MediaRouter.WebRtc.IceCandidateGathering.Duration.Reported",t()-this.ww),this.Ax(),0<this.Sq&&dh("MediaRouter.WebRtc.IceCandidateGathering.Duration.Real",this.TE-this.ww))};
d.SY=function(){"completed"==this.o.iceGatheringState&&this.Ax()};d.Ax=function(){ef(this.mq);this.mq=null;this.Kx||(F(this.a,"Resolving sesion description after gathering "+this.Sq+" ICE candidates."),this.fI.resolve(this.wQ(this.o.localDescription)),this.Kx=!0)};
d.RY=function(a){if(this.o){var b=this.o.iceConnectionState;F(this.a,"New ICE connection state: "+b+".");if("connected"==b)this.zw("iceconnected");else if("completed"==b)this.zw("icecompleted");else if("failed"==b)E(this.a,"Ice connection failed: "+JSON.stringify(a)),this.dG("icefailed");else if("closed"==b)this.cG("iceclosed");else if("disconnected"==b)if(E(this.a,"Ice connection state is bad."),this.JP&&this.Lv()){F(this.a,"Restarting ICE.");var c=this;this.o.createOffer(r(this.NI,this),function(a){E(c.a,
"Error creating new offer: "+JSON.stringify(a))},Vl)}else this.DY()}};var Wl=function(a,b){yh.call(this,b);this.sk=a;this.PG=J();this.o=this.PG.promise;this.Qd=$g.Lu(b.id);this.Ca=J();this.Fv=this.jc=!1;this.Ec=this.oe=null;this.hy();this.X5();this.Cc(new zh("GET_TURN_CREDENTIALS"))};u(Wl,yh);d=Wl.prototype;d.start=function(a){var b=this;return this.o.then(function(c){if(c.Lv())return I(Error("Mirroring already started"));b.oe=new bh("MediaRouter.WebRtc.Session.Launch");c.addStream(a);c.start();return b.Ca.promise})};
d.stop=function(){this.Ec&&this.Ec.end();this.Fv=this.jc=!1;this.oe=this.Ec=null;this.o.then(function(a){a.stop()});return!0};d.K=function(){this.Qd.bb();this.stop()};
d.hy=function(){var a=this;this.Qd.onMessage=function(b){if(!b.type)throw Error("Message has no type.");switch(b.type){case "TURN_CREDENTIALS":a.PG.resolve(new Ul(a.Fa.id,b.data.credentials));break;case "ANSWER":a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "KNOCK_ANSWER":a.Fv=!0;a.o.then(function(a){a.setRemoteDescription(b.data)});break;case "STOP":a.Ca.reject("Stop signal received");a.stop();break;default:throw Error("Unknown message type: "+b.type);}}};
d.X5=function(){var a=this;this.o.then(function(b){b.O4(function(b){b=new Bh(a.sk.bg(),Tl,b);a.Cc(new zh("OFFER",b))});b.N4(function(b){a.Cc(Ah(b))});b.M4(function(){a.jc=!0;a.Cc(new zh("SESSION_START_SUCCESS"));!a.Fv&&a.oe&&a.oe.end();a.oe=null;a.Ec=new gh("MediaRouter.WebRtc.Session.Length");a.Ca.resolve(a)});b.K4(function(){a.Cc(new zh("SESSION_END"))});b.L4(function(b){a.jc||a.Ca.reject(b);a.Cc(new zh("SESSION_FAILURE"))})})};var Xl={channelType:"cloud"};
Wl.prototype.Cc=function(a){this.Qd.sendMessage(a,Xl)};Wl.prototype.Gj=function(){return this.sk};var Yl=function(a){xh.call(this,"webrtc",a)};u(Yl,xh);d=Yl.prototype;d.Gj=function(a,b){return new ei(a,b)};d.Pt=function(a,b){if(a instanceof ei)return new Wl(a,b);throw Error("Invalid parameters");};d.kx=function(){Sl(0)};d.gx=function(){Sl(1)};d.hx=function(){jh("MediaRouter.WebRtc.Session.End")};d.ix=function(a){kh("MediaRouter.WebRtc.Start.Failure",a,lh)};d.jx=function(){jh("MediaRouter.WebRtc.Stream.End")};var Zl=function(a,b,c,e,f,g){this.OE=a;this.Vc=b;this.rj=e||null;this.gk=c||null;this.$d=f||null;this.li=g||null};d=Zl.prototype;d.Yf=function(){var a="";this.$d?a=this.$d:this.gk&&(a=this.gk);return a};d.getId=function(){return this.OE+"@"+this.Vc};d.getService=function(){return this.Vc};d.Zf=function(){return this.rj};d.merge=function(a){!this.li&&a.li&&(this.li=a.li);!this.$d&&a.$d&&(this.$d=a.$d);this.$d&&a.$d&&this.li&&(this.$d=a.$d)};var $l=function(a,b){this.Ug=a;this.s7=b},am=new $l("https://www.googleapis.com/clouddevices/v1","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA"),bm=new $l("https://www.googleapis.com/calendar/v3",""),cm=new $l("https://www.googleapis.com/hangouts/v1",""),dm=new $l("https://networktraversal.googleapis.com/v1alpha","AIzaSyAOZM8ZYeov685QMjXT3sC7XNizfrTEKjA");var em=function(a,b){this.sb=a;this.Wa=b;this.a=C("mr.cloud.calendar.CalendarService")};d=em.prototype;d.tQ=function(){var a=this;return this.uR(this.Wa.ae,9E5).then(function(b){F(a.a,a.$B(b.length)+" events discovered before filtering.");return a.vS(b)},function(b){E(a.a,"Error getting Hangouts from calendar: "+b);return[]})};d.$B=function(a){return 20<a?"20+":a.toString()};d.uR=function(a,b){var c=t(),e=this;return this.XQ(a,new Date(c),new Date(c+b)).then(function(a){return a.filter(e.TW)})};
d.TW=function(a){return!(!a.start||!a.end||a.start.date||a.end.date||!a.start.dateTime||!a.end.dateTime)};d.XQ=function(a,b,c){a=this.sb.tj(bm.Ug,["calendars",a,"events"],{timeMin:b.toJSON(),timeMax:c.toJSON(),singleEvents:!0});G(this.a,"Retrieving Hangouts from Calendar: "+a);return this.sb.Xg(a,"GET").then(function(a){return a.items?a.items:[]})};
d.vS=function(a){var b=this;a=a.reduce(function(a,e){if(e.hangoutLink){var f=new yj(e.hangoutLink),g=b.w_(f.qd);if(2==g.length){var f=g[0],g=g[1],k,p;-1!=f.indexOf(".")&&(k=g,p=f);a.push(new Zl(g,f,k,p,e.summary))}else E(b.a,"Invalid hangout link from calendar event: "+e.hangoutLink)}return a},[]);F(this.a,this.$B(a.length)+" events discovered with Hangout links.");return a};d.w_=function(a){return a.substring(12).split("/")};var fm=function(a,b){this.email=a;this.imageUrl=null!=b?b:null},gm=function(a){this.type=a},hm=function(a,b,c){this.type="__cloud_webrtc_session_message__";this.sessionDescription=a;this.user=null!=b?b:null;this.flungUrl=null!=c?c:null};u(hm,gm);
var im=function(a,b,c){this.name=a;this.parameters=b;this.minimalRole=null!=c?c:"user"},jm={_settings:{type:"string"},_presentationRequest:{type:"string"},_optMediaConstraints:{type:"string"},_webrtcMessage:{type:"string"},_user:{type:"string"}},km=new im("_stopSession",{},"viewer"),lm=new im("_startWebrtcSession",jm),mm=new im("_knockingStartWebrtcSession",jm,"viewer");var nm=function(a){this.pb=a;this.id=a.id;this.a=C("mr.cloud.devices.CloudDevice")};d=nm.prototype;d.isAvailable=function(){if(this.getState().appStatus){var a=this.PW(),b=this.KW(),c=this.yA(864E5);G(this.a,"Device id: "+this.id+", availability: GCM connected "+a+", app Available: "+b+", checked in: "+c);return a&&b&&c}c=this.yA(9E5);F(this.a,"Availability for legacy receiver app: "+c);return c};d.yA=function(a){var b=this.IS();return!!(b&&b>t()-a)};d.KW=function(){return"available"==this.getState().appStatus};
d.PW=function(){return"online"==this.pb.connectionStatus};d.IS=function(){return this.pb.lastUpdateTimeMs?Number(this.pb.lastUpdateTimeMs):null};d.Yf=function(){return this.getState().settings.receiverName};d.getId=function(){return this.id};d.getState=function(){return this.pb.state._cloudCast};d.IE=function(){return this.pb.invitations?0!=this.pb.invitations.length:!1};var om=function(a){this.sb=a};om.prototype.getDevice=function(a){a=this.sb.tj(am.Ug,["devices",a]);return this.sb.Xg(a,"GET").then(function(a){return new nm(a)})};om.prototype.pX=function(){return this.gF({descriptionSubstring:"Chrome Streaming Receiver"})};
om.prototype.gF=function(a){var b=this,c=this.sb.tj(am.Ug,["devices"],a);return this.sb.Xg(c,"GET").then(function(c){var f=(c.devices||[]).filter(function(a){return null!=a.commandDefs&&null!=a.commandDefs._cloudCast}).map(function(a){return new nm(a)});if(c=c.nextPageToken){var g=Wb(a);g.token=c;return b.gF(g).then(function(a){return f.concat(a)})}return f})};om.prototype.oX=function(){return this.pX().then(function(a){return a.filter(function(a){return a.isAvailable()&&!a.IE()})})};var pm={p8:0,DENIED:1,TIMEOUT:2},qm={kz:0,F9:1},rm={mM:0,QL:1,yba:2,W9:3,V9:4,E$:5,TIMEOUT:6},sm={T9:0,Waa:1},tm={eaa:0,y$:1,nba:2,O9:3},um=function(a){kh("MediaRouter.Cloud.Knock.Result",a,pm)},vm=function(a){kh("MediaRouter.Cloud.Session.Start",a,qm)},wm=function(a){kh("MediaRouter.Cloud.Session.Type",a,sm)},xm=function(a){kh("MediaRouter.Cloud.Device.UserRole",a,tm)};var ym=function(a,b,c,e,f,g,k){var p=Rf.O().Bp(a);this.qc=new Ii(p,b,g,k,f);this.deviceId=a;this.Y6=c;this.re=e};ym.prototype.TJ=function(a){return sb(this.Y6,a)};var zm=function(a,b,c,e){ym.call(this,a,b,["cloud"],"Chrome Streaming Receiver",e);this.Ps=c};u(zm,ym);var Am=function(a){var b=a.getService();a.Zf()&&(b=a.Zf());var c;a.gk&&a.Yf()!=a.gk&&(c=a.gk);ym.call(this,a.getId(),a.Yf(),["mesi"],"Hangout",b,"hangout",c);this.Bx=a.li||""};u(Am,ym);var Bm=function(a,b){this.M7=a;this.we=b;this.uf=new A;this.Xr=new A;this.Bm=null},Cm=function(a,b,c){this.sinks=a;this.JA=b;this.RE=c};d=Bm.prototype;d.mc=function(){this.ON()&&(this.Bm=t(),this.Pl());return this.uf.A()};d.so=function(a){this.uf.set(a.qc.id,a)};d.nn=function(a){return this.uf.remove(a)};d.W=function(a){return this.uf.get(a,null)};d.ON=function(){var a=this.Bm+2E4;return null==this.Bm||a<t()};d.Pl=function(){var a=this;return this.M7().then(function(b){a.L7(b)})};
d.L7=function(a){var b=new A(this.uf),c=new A,e=new A,f=[],g=[];a.forEach(function(a){var p=a.qc.id;c.set(p,a);e.set(p,a.deviceId);b.Oa(p)?b.Oa(p)&&JSON.stringify(b.get(p))!=JSON.stringify(a)&&g.push(a.qc):f.push(a.qc);b.remove(p)},this);a=b.cb().map(function(a){return b.get(a).qc});this.Xr.clear();this.Xr=e;this.uf.clear();this.uf=c;this.LN(f,g,a)};d.LN=function(a,b,c){0<a.length&&this.we.wG(a);0<b.length&&this.we.rc(b);0<c.length&&this.we.gf(c)};
d.b=function(){return new Cm(this.uf.b(),this.Xr.b(),this.Bm)};d.lF=function(a){for(var b in a.sinks){var c=a.sinks[b],e=null;"Hangout"==c.re?(e=c.deviceId.split("@"),e=new Am(new Zl(e[0],e[1],c.qc.description,c.qc.domain,c.qc.friendlyName,c.Bx))):"Chrome Streaming Receiver"==c.re&&(e=new zm(c.deviceId,c.qc.friendlyName,c.Ps,c.qc.domain));this.uf.set(b,e)}for(b in a.JA)this.Xr.set(b,a.JA[b]);a.RE&&(this.Bm=a.RE)};var Dm=function(a,b){this.rO=a;this.Ro=new Bm(this.Pl.bind(this),b);qf(this)};d=Dm.prototype;d.mc=function(){return this.Ro.mc()};d.W=function(a){return this.Ro.W(a)};d.Pl=function(){return this.rO.oX().then(function(a){return a.filter(function(a){return!a.IE()}).map(function(a){jh("MediaRouter.Cloud.CloudReceiver.Sink.Discovered");return new zm(a.getId(),a.Yf(),a.pb.personalizedInfo.maxRole,"default")})})};d.Ra=function(){return"CloudSinkDiscoveryService"};d.getData=function(){return[{cache:this.Ro.b()}]};
d.wb=function(){var a=nf(this);a&&this.Ro.lF(a.cache)};var Em=function(a,b){this.input=a;this.domain=b};var Fm=function(a,b,c){this.GN=a;this.XX=b;this.Qj=new Bm(this.Pl.bind(this),c);this.Jm=new A;qf(this)};Fm.prototype.a=C("mr.cloud.discovery.HangoutSinkDiscoveryService");Fm.prototype.Vs=function(a,b){a=new Zl(a,b,a,b);this.Jm.set(a.getId(),a);return a};Fm.prototype.addManualHangout=Fm.prototype.Vs;Fm.prototype.uH=function(a,b){this.kw(new Zl(a,b,a,b))};Fm.prototype.removeManualHangout=Fm.prototype.uH;d=Fm.prototype;d.mc=function(){return this.Qj.mc()};d.W=function(a){return this.Qj.W(a)};
d.Pl=function(){F(this.a,"Fetching hangouts");var a=this;return pe([this.XX.qQ(),this.GN.tQ()]).then(function(b){var c=y(a.Jm.A());b.forEach(function(b){b.WB?c=c.concat(b.value):D(a.a,"Error discovering Hangouts",b.reason)});var e=c.reduce(function(a,b){var c=a[b.getId()];c?c.merge(b):c=b;a[c.getId()]=c;return a},{});return Object.keys(e).map(function(b){b=e[b];jh("MediaRouter.Cloud.Hangout.Sink.Discovered");return a.kw(b)})})};d.kw=function(a){return new Am(a)};
d.CM=function(a){a=this.Vs(a.input,a.domain);a=this.kw(a);this.Qj.so(a);return a.qc};d.l1=function(a){return this.Jm.remove(a.deviceId)?(this.Qj.nn(a.qc.id),!0):!1};d.Ra=function(){return"HangoutSinkDiscoveryService"};d.getData=function(){return[{cache:this.Qj.b(),manualHangouts:this.Jm.b()}]};d.wb=function(){var a=nf(this);if(a){this.Qj.lF(a.cache);for(var b in a.manualHangouts){var c=a.manualHangouts[b];this.Jm.set(b,new Zl(c.OE,c.Vc,c.gk,c.rj,c.$d,c.li))}}};var Gm=function(a){this.Wa=a};d=Gm.prototype;d.tj=function(a,b,c){var e="";b.forEach(function(a){e+="/"+encodeURIComponent(a)});a=new yj(a+e);c&&(c=Ij(c),a.Lr(c));return a};d.Xg=function(a,b,c){var e=this;return e.Wa.getAuthToken().then(function(f){var g=e.NQ(f);return e.HN(g,a,b,c).na(function(g){if("INVALID_ACCESS_ERROR"==g)return e.bQ(f,a,b,c);throw g;})})};d.bQ=function(a,b,c,e){var f=this;return this.Wa.aQ(a).then(function(){return f.Xg(b,c,e)})};
d.HN=function(a,b,c,e){var f=J(),g=this;a.sendRequest(this.xQ(b,c,function(a){a&&!a.error?f.resolve(a):g.QW(a)?f.reject("INVALID_ACCESS_ERROR"):f.reject(g.t_(a))},e));return f.promise};d.QW=function(a){return!!a&&401==a.error.code};d.NQ=function(a){a=new ri(void 0,void 0,void 0,!1,!1,a);a.init();return a};d.t_=function(a){return a&&a.error?a.error.errors?a.error.errors[0]:a:Error(a)};d.xQ=function(a,b,c,e){a={callback:c,method:b,path:a.toString()};e&&(a.body=e);return a};var Hm=function(){this.ve=!1;this.ae=null;this.lg=!1;this.a=C("mr.cloud.identity.IdentityService");qf(this);this.qX();this.mJ()},Im="cloudview.test@gmail.com castouts.qa.nohangouts@gmail.com castouts.qa@gmail.com castouts-qa.com castouts-test.com google.com youtube.com nest.com waze.com netflix.com twitter.com yahoo.com salesforce.com whirlpool.com nytimes.com kohls.com squareup.com ivci.com".split(" ");d=Hm.prototype;d.Ev=function(){return"google.com"==this.TD()};
d.gX=function(){return this.lg||this.ve&&!!this.ae&&(-1!=Im.indexOf(this.ae)||-1!=Im.indexOf(this.TD()))};d.TD=function(){return this.ae?this.ae.substr(this.ae.indexOf("@")+1):""};d.getAuthToken=function(){return this.hC(!0)};
d.hC=function(a){return chrome.identity?new ie(function(b,c){chrome.identity.getAuthToken({interactive:a},function(a){chrome.runtime.lastError?c(Error("Unable to get user auth token: "+chrome.runtime.lastError.message)):null==a?c(Error("User is not logged in (no token found)")):b(a)})}):I(Error("chrome.identity permission required for auth."))};d.aQ=function(a){return new ie(function(b){chrome.identity.removeCachedAuthToken({token:a},function(){b()})})};
d.mJ=function(){var a=this;this.hC(!1).then(function(b){chrome.identity.getProfileUserInfo(function(c){a.ve=!!c.email||!!c.id;a.ae=c.email||null;b&&!a.ve&&(a.lg=!0)})},function(b){G(a.a,"Unable to set sign in and email.",b)})};d.qX=function(){var a=this;chrome.identity.onSignInChanged.addListener(function(b,c){a.ve=c;F(a.a,"Signed in change: "+a.ve);a.ve?a.mJ():(a.ae=null,a.lg=!1)})};
d.W0=function(){var a=this;return this.getAuthToken().then(function(b){var c=window.gapi;if(!c)return D(a.a,"gapi not loaded."),!1;F(a.a,"Setting gapi auth token");c.auth.setToken({access_token:b});return!0})};d.Ra=function(){return"IdentityService"};d.getData=function(){return[null,{signedIn:this.ve,userEmail:this.ae,kioskAuth:this.lg}]};d.wb=function(){var a=of(this);a&&(a.signedIn&&(this.ve=a.signedIn),a.userEmail&&(this.ae=a.userEmail),a.kioskAuth&&(this.lg=a.kioskAuth))};var Jm={az:{1E3:{other:"0K"},1E4:{other:"00K"},1E5:{other:"000K"},1E6:{other:"0M"},1E7:{other:"00M"},1E8:{other:"000M"},1E9:{other:"0B"},1E10:{other:"00B"},1E11:{other:"000B"},1E12:{other:"0T"},1E13:{other:"00T"},1E14:{other:"000T"}},aL:{1E3:{other:"0 thousand"},1E4:{other:"00 thousand"},1E5:{other:"000 thousand"},1E6:{other:"0 million"},1E7:{other:"00 million"},1E8:{other:"000 million"},1E9:{other:"0 billion"},1E10:{other:"00 billion"},1E11:{other:"000 billion"},1E12:{other:"0 trillion"},1E13:{other:"00 trillion"},
1E14:{other:"000 trillion"}}},Km=Jm,Km=Jm;var Mm=function(a,b){var c=["0"];b=Lm[b][0]&7;if(0<b){c.push(".");for(var e=0;e<b;e++)c.push("0")}return a.replace(/0.00/g,c.join(""))},Lm={AED:[2,"dh","\u062f.\u0625.","DH"],ALL:[0,"Lek","Lek"],AUD:[2,"$","AU$"],BDT:[2,"\u09f3","Tk"],BGN:[2,"lev","lev"],BRL:[2,"R$","R$"],CAD:[2,"$","C$"],CDF:[2,"FrCD","CDF"],CHF:[2,"CHF","CHF"],CLP:[0,"$","CL$"],CNY:[2,"\u00a5","RMB\u00a5"],COP:[32,"$","COL$"],CRC:[0,"\u20a1","CR\u20a1"],CZK:[50,"K\u010d","K\u010d"],DKK:[50,"kr.","kr."],DOP:[2,"RD$","RD$"],EGP:[2,
"\u00a3","LE"],ETB:[2,"Birr","Birr"],EUR:[2,"\u20ac","\u20ac"],GBP:[2,"\u00a3","GB\u00a3"],HKD:[2,"$","HK$"],HRK:[2,"kn","kn"],HUF:[34,"Ft","Ft"],IDR:[0,"Rp","Rp"],ILS:[34,"\u20aa","IL\u20aa"],INR:[2,"\u20b9","Rs"],IRR:[0,"Rial","IRR"],ISK:[0,"kr","kr"],JMD:[2,"$","JA$"],JPY:[0,"\u00a5","JP\u00a5"],KRW:[0,"\u20a9","KR\u20a9"],LKR:[2,"Rs","SLRs"],LTL:[2,"Lt","Lt"],MNT:[0,"\u20ae","MN\u20ae"],MVR:[2,"Rf","MVR"],MXN:[2,"$","Mex$"],MYR:[2,"RM","RM"],NOK:[50,"kr","NOkr"],PAB:[2,"B/.","B/."],PEN:[2,"S/.",
"S/."],PHP:[2,"\u20b1","Php"],PKR:[0,"Rs","PKRs."],PLN:[50,"z\u0142","z\u0142"],RON:[2,"RON","RON"],RSD:[0,"din","RSD"],RUB:[50,"\u20bd","RUB"],SAR:[2,"Rial","Rial"],SEK:[50,"kr","kr"],SGD:[2,"$","S$"],THB:[2,"\u0e3f","THB"],TRY:[2,"TL","YTL"],TWD:[2,"NT$","NT$"],TZS:[0,"TSh","TSh"],UAH:[2,"\u0433\u0440\u043d.","UAH"],USD:[2,"$","US$"],UYU:[2,"$","$U"],VND:[48,"\u20ab","VN\u20ab"],YER:[0,"Rial","Rial"],ZAR:[2,"R","ZAR"]};var Nm={cz:".",Js:",",gz:"%",Os:"0",DL:"+",vL:"-",fz:"E",hz:"\u2030",Ks:"\u221e",AL:"NaN",bz:"#,##0.###",YL:"#E0",CL:"#,##0%",bL:"\u00a4#,##0.00",eL:"USD"},Om=Nm,Om=Nm;var Pm=function(a,b,c){this.tm=b||Om.eL;this.$O=c||0;this.Kq=40;this.Rd=1;this.yi=0;this.Rh=3;this.Qq=this.ef=0;this.CJ=this.CK=!1;this.an=this.di="";this.qg="-";this.lk="";this.od=1;this.Wh=!1;this.Eh=[];this.us=this.dB=!1;this.Cl=0;this.aA=null;"number"==typeof a?this.SM(a):this.Qi(a)};d=Pm.prototype;d.s4=function(a){if(0<this.yi&&0<a)throw Error("Can't combine significant digits and minimum fraction digits");this.ef=a;return this};d.n4=function(a){this.Rh=a;return this};
d.E5=function(a){if(0<this.ef&&0<=a)throw Error("Can't combine significant digits and minimum fraction digits");this.yi=a;return this};d.Qi=function(a){a.replace(/ /g,"\u00a0");var b=[0];this.di=this.br(a,b);var c=b[0];this.S_(a,b);c=b[0]-c;this.an=this.br(a,b);b[0]<a.length&&";"==a.charAt(b[0])?(b[0]++,1!=this.od&&(this.Wh=!0),this.qg=this.br(a,b),b[0]+=c,this.lk=this.br(a,b)):(this.qg=this.di+this.qg,this.lk+=this.an)};
d.SM=function(a){switch(a){case 1:this.Qi(Om.bz);break;case 2:this.Qi(Om.YL);break;case 3:this.Qi(Om.CL);break;case 4:this.Qi(Mm(Om.bL,this.tm));break;case 5:this.Qz(1);break;case 6:this.Qz(2);break;default:throw Error("Unsupported pattern type.");}};d.Qz=function(a){this.Cl=a;this.Qi(Om.bz);this.s4(0);this.n4(2);this.E5(2)};
d.parse=function(a,b){b=b||[0];if(0!=this.Cl)throw Error("Parsing of compact numbers is unimplemented");var c;a=a.replace(/ /g,"\u00a0");var e=a.indexOf(this.di,b[0])==b[0],f=a.indexOf(this.qg,b[0])==b[0];e&&f&&(this.di.length>this.qg.length?f=!1:this.di.length<this.qg.length&&(e=!1));e?b[0]+=this.di.length:f&&(b[0]+=this.qg.length);a.indexOf(Om.Ks,b[0])==b[0]?(b[0]+=Om.Ks.length,c=Infinity):c=this.D_(a,b);if(e){if(a.indexOf(this.an,b[0])!=b[0])return NaN;b[0]+=this.an.length}else if(f){if(a.indexOf(this.lk,
b[0])!=b[0])return NaN;b[0]+=this.lk.length}return f?-c:c};
d.D_=function(a,b){var c=!1,e=!1,f=!1,g=1,k=Om.cz,p=Om.Js,w=Om.fz;if(0!=this.Cl)throw Error("Parsing of compact style numbers is not implemented");for(var B="";b[0]<a.length;b[0]++){var L=a.charAt(b[0]),U=this.EC(L);if(0<=U&&9>=U)B+=U,f=!0;else if(L==k.charAt(0)){if(c||e)break;B+=".";c=!0}else if(L==p.charAt(0)&&("\u00a0"!=p.charAt(0)||b[0]+1<a.length&&0<=this.EC(a.charAt(b[0]+1)))){if(c||e)break}else if(L==w.charAt(0)){if(e)break;B+="E";e=!0}else if("+"==L||"-"==L)B+=L;else if(1==this.od&&L==Om.gz.charAt(0)){if(1!=
g)break;g=100;if(f){b[0]++;break}}else if(1==this.od&&L==Om.hz.charAt(0)){if(1!=g)break;g=1E3;if(f){b[0]++;break}}else break}1!=this.od&&(g=this.od);return parseFloat(B)/g};d.format=function(a){if(isNaN(a))return Om.AL;var b=[],c=this.eV(null===this.aA?a:this.aA,a);a/=Math.pow(10,c.Zt);b.push(c.prefix);var e=0>a||0==a&&0>1/a;b.push(e?this.qg:this.di);isFinite(a)?(a=a*(e?-1:1)*this.od,this.us?this.V6(a,b):this.xy(a,this.Rd,b)):b.push(Om.Ks);b.push(e?this.lk:this.an);b.push(c.SJ);return b.join("")};
d.JH=function(a){var b=Math.pow(10,this.Rh),c=0>=this.yi?Math.round(a*b):Math.round(this.a2(a*b,this.yi,this.Rh));isFinite(c)?(a=Math.floor(c/b),b=Math.floor(c-a*b)):b=0;return{xE:a,AQ:b}};
d.xy=function(a,b,c){if(this.ef>this.Rh)throw Error("Min value must be less than max value");c||(c=[]);a=this.JH(a);var e=Math.pow(10,this.Rh),f=a.xE,g=a.AQ,k=0==f?0:this.rq(f)+1,p=0<this.ef||0<g||this.CJ&&k<this.yi;a=this.ef;p&&(a=this.CJ&&0<this.yi?this.yi-k:this.ef);for(var w="",k=f;1E20<k;)w="0"+w,k=Math.round(k/10);var w=k+w,B=Om.cz,k=Om.Os.charCodeAt(0),L=w.length,U=0;if(0<f||0<b){for(f=L;f<b;f++)c.push(String.fromCharCode(k));if(2<=this.Eh.length)for(b=1;b<this.Eh.length;b++)U+=this.Eh[b];
b=L-U;if(0<b)for(var f=this.Eh,U=L=0,ia,Lb=Om.Js,yb=w.length,Mb=0;Mb<yb;Mb++){if(c.push(String.fromCharCode(k+1*Number(w.charAt(Mb)))),1<yb-Mb)if(ia=f[U],Mb<b){var $i=b-Mb;(1===ia||0<ia&&1===$i%ia)&&c.push(Lb)}else U<f.length&&(Mb===b?U+=1:ia===Mb-b-L+1&&(c.push(Lb),L+=ia,U+=1))}else{b=w;w=this.Eh;f=Om.Js;ia=b.length;Lb=[];for(L=w.length-1;0<=L&&0<ia;L--){U=w[L];for(yb=0;yb<U&&0<=ia-yb-1;yb++)Lb.push(String.fromCharCode(k+1*Number(b.charAt(ia-yb-1))));ia-=U;0<ia&&Lb.push(f)}c.push.apply(c,Lb.reverse())}}else p||
c.push(String.fromCharCode(k));(this.dB||p)&&c.push(B);e=""+(g+e);for(g=e.length;"0"==e.charAt(g-1)&&g>a+1;)g--;for(f=1;f<g;f++)c.push(String.fromCharCode(k+1*Number(e.charAt(f))))};d.xz=function(a,b){b.push(Om.fz);0>a?(a=-a,b.push(Om.vL)):this.CK&&b.push(Om.DL);a=""+a;for(var c=Om.Os,e=a.length;e<this.Qq;e++)b.push(c);b.push(a)};
d.V6=function(a,b){if(0==a)this.xy(a,this.Rd,b),this.xz(0,b);else{var c=Math.floor(Math.log(a)/Math.log(10)+2E-15);a/=Math.pow(10,c);var e=this.Rd;if(1<this.Kq&&this.Kq>this.Rd){for(;0!=c%this.Kq;)a*=10,c--;e=1}else 1>this.Rd?(c++,a/=10):(c-=this.Rd-1,a*=Math.pow(10,this.Rd-1));this.xy(a,e,b);this.xz(c,b)}};d.EC=function(a){a=a.charCodeAt(0);if(48<=a&&58>a)return a-48;var b=Om.Os.charCodeAt(0);return b<=a&&a<b+10?a-b:-1};
d.br=function(a,b){for(var c="",e=!1,f=a.length;b[0]<f;b[0]++){var g=a.charAt(b[0]);if("'"==g)b[0]+1<f&&"'"==a.charAt(b[0]+1)?(b[0]++,c+="'"):e=!e;else if(e)c+=g;else switch(g){case "#":case "0":case ",":case ".":case ";":return c;case "\u00a4":if(b[0]+1<f&&"\u00a4"==a.charAt(b[0]+1))b[0]++,c+=this.tm;else switch(this.$O){case 0:c+=Lm[this.tm][1];break;case 2:var g=this.tm,k=Lm[g],c=c+(g==k[1]?g:g+" "+k[1]);break;case 1:c+=Lm[this.tm][2]}break;case "%":if(!this.Wh&&1!=this.od)throw Error("Too many percent/permill");
if(this.Wh&&100!=this.od)throw Error("Inconsistent use of percent/permill characters");this.od=100;this.Wh=!1;c+=Om.gz;break;case "\u2030":if(!this.Wh&&1!=this.od)throw Error("Too many percent/permill");if(this.Wh&&1E3!=this.od)throw Error("Inconsistent use of percent/permill characters");this.od=1E3;this.Wh=!1;c+=Om.hz;break;default:c+=g}}return c};
d.S_=function(a,b){for(var c=-1,e=0,f=0,g=0,k=-1,p=a.length,w=!0;b[0]<p&&w;b[0]++)switch(a.charAt(b[0])){case "#":0<f?g++:e++;0<=k&&0>c&&k++;break;case "0":if(0<g)throw Error('Unexpected "0" in pattern "'+a+'"');f++;0<=k&&0>c&&k++;break;case ",":0<k&&this.Eh.push(k);k=0;break;case ".":if(0<=c)throw Error('Multiple decimal separators in pattern "'+a+'"');c=e+f+g;break;case "E":if(this.us)throw Error('Multiple exponential symbols in pattern "'+a+'"');this.us=!0;this.Qq=0;b[0]+1<p&&"+"==a.charAt(b[0]+
1)&&(b[0]++,this.CK=!0);for(;b[0]+1<p&&"0"==a.charAt(b[0]+1);)b[0]++,this.Qq++;if(1>e+f||1>this.Qq)throw Error('Malformed exponential pattern "'+a+'"');w=!1;break;default:b[0]--,w=!1}0==f&&0<e&&0<=c&&(f=c,0==f&&f++,g=e-f,e=f-1,f=1);if(0>c&&0<g||0<=c&&(c<e||c>e+f)||0==k)throw Error('Malformed pattern "'+a+'"');a=e+f+g;this.Rh=0<=c?a-c:0;0<=c&&(this.ef=e+f-c,0>this.ef&&(this.ef=0));this.Rd=(0<=c?c:a)-e;this.us&&(this.Kq=e+this.Rd,0==this.Rh&&0==this.Rd&&(this.Rd=1));this.Eh.push(Math.max(0,k));this.dB=
0==c||c==a};var Qm={prefix:"",SJ:"",Zt:0};Pm.prototype.OD=function(a,b){var c=1==this.Cl?Km.az:Km.aL;null==c&&(c=Km.az);if(3>a)return Qm;a=Math.min(14,a);var e=c[Math.pow(10,a)];for(--a;!e&&3<=a;)e=c[Math.pow(10,a)],a--;if(!e)return Qm;b=e[b];return b&&"0"!=b?(b=/([^0]*)(0+)(.*)/.exec(b))?{prefix:b[1],SJ:b[3],Zt:a+1-(b[2].length-1)}:Qm:Qm};
Pm.prototype.eV=function(a){if(0==this.Cl)return Qm;a=Math.abs(a);var b=this.OD(1>=a?0:this.rq(a),"other").Zt;return this.OD(b+this.rq(this.JH(a/Math.pow(10,b)).xE),"other")};Pm.prototype.rq=function(a){for(var b=0;1<=(a/=10);)b++;return b};Pm.prototype.a2=function(a,b,c){if(!a)return a;b=b-this.rq(a)-1;if(b<-c)return c=Math.pow(10,c),Math.round(a/c)*c;c=Math.pow(10,b);return Math.round(a*c)/c};var Rm=function(a){return 1==a%10&&11!=a%100?"one":2==a%10&&12!=a%100?"two":3==a%10&&13!=a%100?"few":"other"},Sm=Rm,Sm=Rm;var Tm=function(a,b){if(void 0===b){b=a+"";var c=b.indexOf(".");b=Math.min(-1==c?0:b.length-c-1,3)}return 1==(a|0)&&0==b?"one":"other"},Um=Tm,Um=Tm;var Vm=function(a){this.bk=[];this.Pw=[];this.uw=new Pm(1);this.F_(a)},Wm=/'([{}#].*?)'/g,Xm=/''/g;d=Vm.prototype;d.format=function(a){return this.zp(a,!1)};d.zp=function(a,b){if(0==this.Pw.length)return"";var c=[];this.uu(this.Pw,a,b,c);for(a=c.join("");0<this.bk.length;)a=a.replace(this.rt(this.bk),this.bk.pop());return a};
d.uu=function(a,b,c,e){for(var f=0;f<a.length;f++)switch(a[f].type){case 4:e.push(a[f].value);break;case 3:var g=a[f].value;this.zQ(g,b,e);break;case 2:g=a[f].value;this.yQ(g,b,c,e);break;case 0:g=a[f].value;this.UB(g,b,Um,c,e);break;case 1:g=a[f].value;this.UB(g,b,Sm,c,e);break;default:hb("Unrecognized block type: "+a[f].type)}};d.zQ=function(a,b,c){b=b[a];l(b)?(this.bk.push(b),c.push(this.rt(this.bk))):c.push("Undefined parameter - "+a)};
d.yQ=function(a,b,c,e){var f=a.Co;l(b[f])?(f=a[b[f]],l(f)||(f=a.other),this.uu(f,b,c,e)):e.push("Undefined parameter - "+f)};d.UB=function(a,b,c,e,f){var g=a.Co,k=a.Sz,p=+b[g];isNaN(p)?f.push("Undefined or invalid parameter - "+g):(k=p-k,g=a[b[g]],l(g)||(c=this.uw.qT?c(k,this.uw.qT()):c(k),g=a[c],l(g)||(g=a.other)),a=[],this.uu(g,b,e,a),b=a.join(""),e?f.push(b):(e=this.uw.format(k),f.push(b.replace(/#/g,e))))};d.F_=function(a){a&&(a=this.DW(a),this.Pw=this.cr(a))};
d.DW=function(a){var b=this.bk,c=r(this.rt,this);a=a.replace(Xm,function(){b.push("'");return c(b)});return a=a.replace(Wm,function(a,f){b.push(f);return c(b)})};d.tp=function(a){var b=0,c=[],e=[],f=/[{}]/g;f.lastIndex=0;for(var g;g=f.exec(a);){var k=g.index;"}"==g[0]?(c.pop(),0==c.length&&(g={type:1},g.value=a.substring(b,k),e.push(g),b=k+1)):(0==c.length&&(b=a.substring(b,k),""!=b&&e.push({type:0,value:b}),b=k+1),c.push("{"))}b=a.substring(b);""!=b&&e.push({type:0,value:b});return e};
var Ym=/^\s*(\w+)\s*,\s*plural\s*,(?:\s*offset:(\d+))?/,Zm=/^\s*(\w+)\s*,\s*selectordinal\s*,/,$m=/^\s*(\w+)\s*,\s*select\s*,/;d=Vm.prototype;d.d_=function(a){return Ym.test(a)?0:Zm.test(a)?1:$m.test(a)?2:/^\s*\w+\s*/.test(a)?3:5};
d.cr=function(a){var b=[];a=this.tp(a);for(var c=0;c<a.length;c++){var e={};if(0==a[c].type)e.type=4,e.value=a[c].value;else if(1==a[c].type)switch(this.d_(a[c].value)){case 2:e.type=2;e.value=this.K_(a[c].value);break;case 0:e.type=0;e.value=this.G_(a[c].value);break;case 1:e.type=1;e.value=this.E_(a[c].value);break;case 3:e.type=3;e.value=a[c].value;break;default:hb("Unknown block type for pattern: "+a[c].value)}else hb("Unknown part of the pattern.");b.push(e)}return b};
d.K_=function(a){var b="";a=a.replace($m,function(a,c){b=c;return""});var c={};c.Co=b;a=this.tp(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.cr(a[e].value);else hb("Expected block type.");c[f.replace(/\s/g,"")]=g;e++}return c};
d.G_=function(a){var b="",c=0;a=a.replace(Ym,function(a,e,f){b=e;f&&(c=parseInt(f,10));return""});var e={};e.Co=b;e.Sz=c;a=this.tp(a);for(var f=0;f<a.length;){var g=a[f].value;f++;if(1==a[f].type)var k=this.cr(a[f].value);else hb("Expected block type.");e[g.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=k;f++}return e};
d.E_=function(a){var b="";a=a.replace(Zm,function(a,c){b=c;return""});var c={};c.Co=b;c.Sz=0;a=this.tp(a);for(var e=0;e<a.length;){var f=a[e].value;e++;if(1==a[e].type)var g=this.cr(a[e].value);else hb("Expected block type.");c[f.replace(/\s*(?:=)?(\w+)\s*/,"$1")]=g;e++}return c};d.rt=function(a){return"\ufddf_"+(a.length-1).toString(10)+"_"};var an=chrome.i18n.getMessage("1522140683318860351"),bn=chrome.i18n.getMessage("4246483347873264186"),cn=chrome.i18n.getMessage("5991427458288444010"),dn=chrome.i18n.getMessage("5412436174832024705"),en=chrome.i18n.getMessage("7735695102441495789"),fn=chrome.i18n.getMessage("4575332923598659024"),gn=chrome.i18n.getMessage("2297080986956220930"),hn=new Vm(gn),jn=function(a,b){return hn.format({ORGANIZER:a,PARTICIPANTS:b})};var kn=function(a){this.sb=a;this.a=C("mr.cloud.mesi.MesiService")},ln={request_header:{client_version:{client_id:"39"}},search_sources:["0"]};
kn.prototype.qQ=function(){var a=cm.Ug;.1>Math.random()&&(a=a.replace("v1","v1_preprod"));a=this.sb.tj(a,["hangouts","search"]);F(this.a,"Retrieving Hangouts from MESI: "+a);return this.sb.Xg(a,"POST",ln).then(function(a){var c=[];a.result&&(c=a.result.map(function(a){var b=a.hangout,c,k;b.external_key?(c=b.external_key.value.replace(/@.*/,""),k=b.external_key.service):b.sharing_url&&(k=b.sharing_url.split("/"),c=k[4],k=k[3]);var p=b.meeting_room_name,w;b.meeting_domain?(w=b.meeting_domain,p&&(c=
p,k=w)):"BUSINESS"==b.type&&b.company_title&&(w=b.company_title.toLowerCase());var B=jn("",0);if((a=a.participant)&&0<a.length){var L=a[0].display_name;a=a.reduce(function(a,b){a.add(b.user_id);"ORGANIZER"==b.role&&(L=b.display_name);return a},new Sc);B=jn(L,a.N())}return new Zl(c,k,p,w,B,b.hangout_id)}));return c})};var mn=function(a,b,c){this.state=a;this.type=null!=b?b:null;this.results=null!=c?c:null},nn=function(a){this.sb=a};nn.$inject=["gapiService"];d=nn.prototype;d.x2=function(a,b,c){var e=this;return this.aI(mm,a,b,c,35E3).then(function(a){return e.bE(a)})};d.z2=function(a,b,c){var e=this;return this.aI(lm,a,b,c,23E3).then(function(a){var b=a.state;return"done"==b?(a=e.MG(a),new mn(b,a.type,new hm(a.sessionDescription))):new mn(b)})};d.D2=function(a){return this.te(a,km,{})};
d.aI=function(a,b,c,e,f){c={_settings:c.settings.By(),_optMediaConstraints:JSON.stringify(c.mediaConstraints),_webrtcMessage:JSON.stringify(new hm(c.description))};e&&(c._user=JSON.stringify(e));return this.te(b,a,c,f)};d.bE=function(a){var b=a.state;switch(b){case "done":return H(this.p_(a));case "queued":case "inProgress":var c=this;return c.b8(a).then(function(a){return c.bE(a)});default:return H(new mn(b))}};
d.b8=function(a){var b=this,c=J(),e=setInterval(function(){b.gQ(a.id).then(function(a){"queued"!=a.state&&"inProgress"!=a.state&&(clearInterval(e),c.resolve(a))})},2E3);return c.promise};d.p_=function(a){a=this.MG(a);return"__cloud_webrtc_session_message__"==a.type?new mn("done","knocking_cloud_webrtc_session_message",new hm(a.sessionDescription)):new mn("done",a.type)};
d.te=function(a,b,c,e){a={deviceId:a,name:"_cloudCast."+b.name,parameters:c,expirationTimeoutMs:e||1E4};b={};e&&(b.responseAwaitMs=Math.min(e+5E3,25E3));e=this.sb.tj(am.Ug,["commands"],b);return this.sb.Xg(e,"POST",a)};d.MG=function(a){return a.results&&a.results.results?JSON.parse(a.results.results):null};d.gQ=function(a){a=this.sb.tj(am.Ug,["commands",a]);return this.sb.Xg(a,"GET")};var on=function(a,b,c,e){this.Ve=a;this.Wa=b;this.Zn=c;this.fc=e};d=on.prototype;d.OV=function(a,b,c){var e=this;return this.t2(a,b,c).then(function(a){return e.BV(a,b.id)})};d.HV=function(a){var b=this;return this.Zn.tR().then(function(c){b.fc.ud(new zh("TURN_CREDENTIALS",{credentials:c}),a.id)})};
d.t2=function(a,b,c){b=c.deviceId;var e=this.Wa.ae,e=e?new fm(e):void 0;a=a.data;switch(c.Ps){case "owner":xm(0);break;case "manager":xm(1);break;case "user":xm(2);break;case "viewer":xm(3)}return"viewer"==c.Ps?this.Ve.x2(b,a,e):this.Ve.z2(b,a,e)};
d.BV=function(a,b){if("done"!=a.state)return I(Error("Offer not executed by receiver. State: "+a.state));switch(a.type){case "__cloud_webrtc_session_message__":a=new zh("ANSWER",a.results.sessionDescription);this.fc.ud(a,b);break;case "knocking_cloud_webrtc_session_message":um(0);a=new zh("KNOCK_ANSWER",a.results.sessionDescription);this.fc.ud(a,b);break;case "knock_denied":um(1);this.aE(bn,b);break;case "knock_timeout":um(2);this.aE(cn,b);break;default:return I(Error("Invalid message type: "+a.type))}return H()};
d.aE=function(a,b){a=new ah(a,"warning","dismiss");a.b4(!0);this.fc.We().send(a);this.fc.ud(new zh("STOP"),b)};var pn=function(a,b){this.Wa=a;this.fc=b};
pn.prototype.LV=function(a,b,c){switch(a.type){case "REFRESH_AUTH":var e=c.deviceId,f=c.Bx,g=this;return this.Wa.W0().then(function(){g.fc.ud(new zh("AUTH_READY",{hangoutId:e,resolvedId:f}),b.id)});case "LOCAL_PRESENT":return e=c.deviceId,f=c.Bx,this.fc.ud(new zh("AUTH_READY",{hangoutId:e,resolvedId:f,conferenceMode:!a.data.local}),b.id),H();case "STATUS_REQUEST":return this.fc.ud(a,b.id),H();case "STATUS_RESPONSE":return this.fc.ud(a,b.id,!0),a.data.routeDescription||this.fc.ud(a,b.id),H();case "HANGOUT_INACTIVE":return this.fc.Hi(b,
4,new ah(en,"warning","dismiss"));case "HANGOUT_INVALID":return this.fc.Hi(b,3,new ah(fn,"warning","dismiss"));default:return I(Error("Unknown type: "+a.type))}};var qn=function(a,b,c){this.aj=a;this.qm=b;this.fc=c};
qn.prototype.m0=function(a,b,c,e){switch(a){case "cloud":break;case "mesi":break;default:return I(Error("Unrecognized channel type"))}if(!b.type)return I(Error("Message has no type"));switch(b.type){case "STOP":return this.fc.Hi(c,1,null);case "SESSION_START_SUCCESS":return vm(0),H();case "SESSION_END":return H();case "SESSION_FAILURE":return vm(1),this.fc.Hi(c,2,new ah(an,"warning","dismiss"));case "__webrtc_stats__":return H();case "OFFER":return this.aj.OV(b,c,e);case "GET_TURN_CREDENTIALS":return this.aj.HV(c);
case "REFRESH_AUTH":case "LOCAL_PRESENT":case "MUTE":case "STATUS_REQUEST":case "STATUS_RESPONSE":case "HANGOUT_INACTIVE":case "HANGOUT_INVALID":return this.qm.LV(b,c,e);default:return I(Error("Unknown type: "+b.type))}};var rn=function(){var a=this;this.a=C("mr.cloud.settings.SettingsService");this.yw=null;chrome.settingsPrivate.onPrefsChanged.addListener(function(b){if(a.yw){b=fa(b);for(var c=b.next();!c.done;c=b.next())if(c=c.value,"media_router.cloudservices.enabled"==c.key){a.yw.call(null,c.value);break}}})};d=rn.prototype;d.J4=function(a){this.yw=a};d.r7=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.cloudEnabled":!0},function(){chrome.runtime.lastError&&E(a,"Error setting cloud setting: "+JSON.stringify(chrome.runtime.lastError))})};
d.pR=function(){var a=this;return this.sC().na(function(){return a.sC().na(function(b){E(a.a,"Error retrieving cloud on setting: "+JSON.stringify(b));return!1})})};d.sC=function(){return this.TC("mr.cloud.cloudEnabled").then(function(a){return!!a["mr.cloud.cloudEnabled"]})};d.TC=function(a){var b=J();chrome.storage.sync.get(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};
d.nR=function(){var a=this;return this.rC().na(function(){return a.rC().na(function(b){E(a.a,"Error retrieving cloud enabled setting: "+JSON.stringify(b));return!1})})};d.rC=function(){return this.VT("media_router.cloudservices.enabled").then(function(a){return!!a.value})};d.VT=function(a){var b=J();chrome.settingsPrivate.getPref(a,function(a){chrome.runtime.lastError?b.reject(chrome.runtime.lastError):b.resolve(a)});return b.promise};
d.I4=function(){var a=this.a;chrome.storage.sync.set({"mr.cloud.notifiedHangouts":!0},function(){chrome.runtime.lastError&&E(a,"Error setting notified Hangout privacy: "+JSON.stringify(chrome.runtime.lastError))})};d.HT=function(){var a=this;return this.iD().na(function(){return a.iD().na(function(b){E(a.a,"Error retrieving hangouts notified setting: "+JSON.stringify(b));return!1})})};d.iD=function(){return this.TC("mr.cloud.notifiedHangouts").then(function(a){return!!a["mr.cloud.notifiedHangouts"]})};var sn=function(a){this.a=C("mr.cloud.CredentialService");this.sb=a};sn.prototype.tR=function(){var a=this,b=J(),c=dm.Ug+"/iceconfig?key="+dm.s7;F(this.a,"Requesting TURN credentials from "+c);var e=dg(c,function(){return a.XZ(e,b)},"POST",void 0,{"Content-Type":"application/json"});return b.promise};sn.prototype.XZ=function(a,b){a.kd()?(F(this.a,"Got TURN credentials: "+a.Kj()),b.resolve(this.OY(a.rU()))):b.resolve(this.PY(null))};
sn.prototype.OY=function(a){try{var b=[];a.iceServers.forEach(function(a){a.urls.forEach(function(e){0==e.indexOf("turn:")&&b.push({url:e,credential:a.credential,username:a.username})})});return b}catch(c){return D(this.a,"Error parsing TURN credentials.",c),[]}};sn.prototype.PY=function(a){D(this.a,"XHR failed fetching TURN credentials.",a instanceof Error?a:void 0);return[]};var tn=function(){this.Zn=this.Vd=this.ik=this.qm=this.aj=this.Ve=this.pv=this.vt=this.ow=this.Kt=this.Jt=this.sb=this.ht=null};za(tn);d=tn.prototype;d.Bj=function(){null==this.ht&&(this.ht=new Hm);return this.ht};d.$l=function(){null==this.sb&&(this.sb=new Gm(this.Bj()));return this.sb};d.mR=function(){null==this.Jt&&(this.Jt=new om(this.$l()));return this.Jt};d.qR=function(a){null==this.Kt&&(this.Kt=new Dm(this.mR(),a));return this.Kt};
d.mT=function(){null==this.ow&&(this.ow=new kn(this.$l()));return this.ow};d.YQ=function(){null==this.vt&&(this.vt=new em(this.$l(),this.Bj()));return this.vt};d.uS=function(a){null==this.pv&&(this.pv=new Fm(this.YQ(),this.mT(),a));return this.pv};d.KC=function(){null==this.Ve&&(this.Ve=new nn(this.$l()));return this.Ve};d.oR=function(a){null==this.aj&&(this.aj=new on(this.KC(),this.Bj(),this.bV(),a));return this.aj};d.nS=function(a){null==this.qm&&(this.qm=new pn(this.Bj(),a));return this.qm};
d.nT=function(a){null==this.ik&&(this.ik=new qn(this.oR(a),this.nS(a),a));return this.ik};d.GU=function(){null==this.Vd&&(this.Vd=new rn);return this.Vd};d.bV=function(){null==this.Zn&&(this.Zn=new sn(this.$l()));return this.Zn};var un=function(a,b,c){ve.call(this);this.sX=null!=c?r(a,c):a;this.kg=b;this.vl=r(this.TZ,this);this.et=[]};u(un,ve);d=un.prototype;d.Vk=!1;d.Xm=0;d.Cb=null;d.qu=function(a){this.et=arguments;this.Cb||this.Xm?this.Vk=!0:this.$t()};d.stop=function(){this.Cb&&(ef(this.Cb),this.Cb=null,this.Vk=!1,this.et=[])};d.pause=function(){this.Xm++};d.resume=function(){this.Xm--;this.Xm||!this.Vk||this.Cb||(this.Vk=!1,this.$t())};d.K=function(){un.R.K.call(this);this.stop()};
d.TZ=function(){this.Cb=null;this.Vk&&!this.Xm&&(this.Vk=!1,this.$t())};d.$t=function(){this.Cb=df(this.vl,this.kg);this.sX.apply(null,this.et)};var wn=function(a){this.Ma={};if(a)for(var b=0;b<a.length;b++)this.Ma[vn(a[b])]=null;for(var c in Object.prototype)hb(c+" should not be enumerable in Object.prototype.")},xn={},vn=function(a){return a in xn||32==String(a).charCodeAt(0)?" "+a:a},yn=function(a){return 32==a.charCodeAt(0)?a.substr(1):a};d=wn.prototype;d.add=function(a){this.Ma[vn(a)]=null};d.uz=function(a){for(var b=0;b<a.length;b++)this.Ma[vn(a[b])]=null};d.KM=function(a){for(var b in a.Ma)this.Ma[b]=null};
d.clear=function(){this.Ma={}};d.clone=function(){var a=new wn;a.KM(this);return a};d.contains=function(a){return vn(a)in this.Ma};d.equals=function(a){return this.xq(a)&&a.xq(this)};d.forEach=function(a,b){for(var c in this.Ma)a.call(b,yn(c),void 0,this)};d.N=Object.keys?function(){return Object.keys(this.Ma).length}:function(){var a=0,b;for(b in this.Ma)a++;return a};d.A=Object.keys?function(){return Object.keys(this.Ma).map(yn,this)}:function(){var a=[],b;for(b in this.Ma)a.push(yn(b));return a};
d.Eb=function(){for(var a in this.Ma)return!1;return!0};d.xq=function(a){for(var b in this.Ma)if(!(b in a.Ma))return!1;return!0};d.remove=function(a){a=vn(a);return a in this.Ma?(delete this.Ma[a],!0):!1};d.zd=function(){return Fc(this.A())};var zn=function(){this.bc=null;this.a=C("mr.IssueSenderImpl")};zn.prototype.init=function(a){this.bc=a};zn.prototype.send=function(a){if(this.bc)if(this.bc.onIssue)this.bc.onIssue(a);else D(this.a,"MediaRouterService.onIssue not defined.");else D(this.a,"MediaRouterService is not set.")};var An=new Sc;var Bn=function(a,b){K.call(this,"internal_message");this.routeId=a;this.message=b};u(Bn,K);var Cn=function(a,b,c){ve.call(this);this.LH=a;this.te=b;this.YX=c;this.onMessage=ya;c.listen("internal_message",this.Wq,!1,this)};u(Cn,ve);Cn.prototype.sendMessage=function(a,b){return this.te(this.LH,a,b)};Cn.prototype.Wq=function(a){if(a.routeId==this.LH)this.onMessage(a.message)};Cn.prototype.K=function(){this.YX.Xc("internal_message",this.Wq,!1,this)};var Dn=new Cn("",function(){return H()},new M),En=function(a){this.C=a};
En.prototype.Lu=function(a){var b=this.C.Zu(a);return b?new Cn(a,r(b.Fg,b),this.C.cv()):Dn};var Fn=function(){this.a=C("mr.ProviderManager");this.Rc=[];this.Tc=new A;this.vn=new A;this.xe=new wn;this.pi=new wn;this.kk=new A;this.bc=null;this.Wk=!1;this.MH=new M;this.NH=new un(this.B2,500,this);this.v6=new un(this.YP,500,this);this.Om=new vl;this.Vw=0;this.ME=new zn;this.Xk=new A;this.Pq=-1==window.navigator.userAgent.indexOf("Windows");this.Oq=[];this.createRoute=this.ge;this.joinRoute=this.Kh;this.connectRouteByRouteId=this.dh;this.closeRoute=this.terminateRoute=this.tc;this.startObservingMediaSinks=
this.Di;this.stopObservingMediaSinks=this.Fi;this.sendRouteMessage=this.Fg;this.sendRouteBinaryMessage=this.A2;this.listenForRouteMessages=this.iw;this.stopListeningForRouteMessages=this.vy;this.startObservingMediaRoutes=this.Ci;this.stopObservingMediaRoutes=this.Ei;this.onPresentationSessionDetached=this.detachRoute=this.Sf;this.enableMdnsDiscovery=this.uB;this.searchSinksAndCreateRoute=this.o2;this.searchSinks=this.sf;this.updateMediaSinks=this.E7};d=Fn.prototype;d.rT=function(a){return this.kk.get(a).Hm().then(function(a){return a})};
d.X0=function(a){a.forEach(this.$0,this)};d.jd=function(a,b){this.kk.set("webrtc",new Ch(new Yl(this)));this.kk.set("cast_streaming",new Ch(new Ql(this)));var c=Yh.O();c.t4(this);c.X3(tn.O().Bj());this.kk.set("hangouts",c);c=new En(this);$g||($g=c);this.bc=a;this.ME.init(a);this.X0(b);qf(this)};
d.$0=function(a){if(this.Vp(a.getName()))E(this.a,"Provider "+a.getName()+" already registered.");else try{a.jd(),this.Rc.push(a),this.Xk.set(a.getName(),0)}catch(b){E(this.a,"Provider "+a.getName()+" failed to initialize.",b)}};
d.Xn=function(a,b){var c=this,e=new Promise(function(e,g){var k=null;b&&(c.i0(),k=window.setTimeout(function(){k=null;g(new sl(1,"timeout after "+b+" ms."));a.cancel()},b));a.then(function(a){null!=k&&window.clearTimeout(k);e(a)},function(a){null!=k&&window.clearTimeout(k);g(a instanceof sl?a:new sl(0,a.message,a.stack))})});b&&(e=e.then(function(a){c.Lz();return a},function(a){c.Lz();throw a;}));return e};d.i0=function(){this.Vw++;this.Lm()};d.Lz=function(){this.Vw--;this.Lm()};
d.ge=function(a,b,c,e,f,g,k){var p=this,w=this.$T(a,b);if(!w)return Promise.reject(new sl(2,"No provider supports createRoute with source: "+a+" and sink: "+b));An.add(b);this.rc();g=g&&0<g?g:6E4;a=w.ge(a,b,c,k||!1,g,e,f);return this.Xn(a,g).then(function(a){An.remove(b);p.rc();return a},function(a){D(p.a,"Error creating route.",a);An.remove(b);p.rc();throw a;})};
d.dh=function(a,b,c,e,f,g){var k=this.Tc.get(b);if(!k)return Promise.reject(new sl(2,"No provider supports join "+b));a=k.dh(a,b,c,e,f);return this.Xn(a,g&&0<g?g:3E4)};d.Kh=function(a,b,c,e,f,g){var k=this.ZT(a);if(!k)return Promise.reject(new sl(2,"No provider supports join "+b));f=f&&0<f?f:3E4;a=k.Kh(a,b,g||!1,f,c,e);return this.Xn(a,f)};d.tc=function(a){var b=this.Tc.get(a);b?this.DF(a).Bb(function(){b.tc(a)}):E(this.a,"Route "+a+" does not exist.")};
d.Di=function(a){this.xe.contains(a)||(this.xe.add(a),this.Rc.forEach(function(b){b.Di(a)}));this.jr(a)};d.Fi=function(a){this.xe.remove(a)?this.qB(a):F(this.a,"No existing query "+a)};d.qB=function(a){this.Rc.forEach(function(b){b.Fi(a)})};
d.jr=function(a){if("urn:x-org.chromium.media:source:tab:-1"==a)E(this.a,"No sinks for sourceUrn: "+a);else{var b=new A,c=[];this.Rc.forEach(function(e){var f=e.Ul(a);0<f.sinks.length&&(c=f.origins);f.sinks.forEach(function(a){b.Oa(a.id)?E(this.a,"Detected duplicate sink "+a.id+" from provider: "+e.getName()):b.set(a.id,a)},this)},this);this.C2(a,b.A(),c||[])}};d.C2=function(a,b,c){F(this.a,"Sending "+b.length+" sinks to MR for "+a);Gn(b);this.bc.onSinksReceived(a,b,c)};
var Gn=function(a){a.forEach(function(a){a.isLaunching_=An.contains(a.id)})};d=Fn.prototype;d.Fg=function(a,b,c){var e=this.Tc.get(a);return e?this.Xn(e.Fg(a,b,c),3E4):Promise.reject(Error("Invalid route ID "+a))};d.A2=function(a){return Promise.reject(Error("Route "+a+" does not support sending binary data"))};d.iw=function(a){return this.Tc.Oa(a)?this.Xn(this.Om.iw(a)):Promise.reject(Error("Invalid route ID"))};d.vy=function(a){this.Om.vy(a)};
d.Sf=function(a){var b=this.Tc.get(a);b?b.Sf(a):F(this.a,"Route "+a+" does not exist.")};d.uB=function(){this.Pq=!0;this.Oq.forEach(function(a){a()});this.Oq.length=0;var a=this;this.xe.forEach(function(b){a.jr(b)})};d.$T=function(a,b){return this.Rc.find(function(c){return c.wl(a,b)})||null};d.ZT=function(a){return this.Rc.find(function(b){return b.Wi(a)})||null};d.YP=function(){this.xe.forEach(function(a){this.jr(a)},this)};d.Lm=function(){this.bc.setKeepAlive(this.kW()||0<this.Vw)};
d.Ci=function(a){this.pi.contains(a)||(this.Wk=!0,this.pi.add(a),this.Rc.forEach(function(b){b.Ci(a)}));this.NH.qu();this.Lm()};d.Ei=function(a){this.pi.remove(a)?(0==this.pi.length&&(this.Wk=!1),this.Rc.forEach(function(b){b.Ei(a)}),this.Lm()):F(this.a,"No existing route query "+a)};
d.B2=function(){if(this.Wk){var a=[];this.Rc.forEach(function(b){a=a.concat(b.Ze())});this.pi.forEach(function(b){var c=[];this.Rc.forEach(function(a){a.Ze().forEach(function(f){!f.hj&&a.Wi(b,f)&&c.push(f.id)})});this.bc.onRoutesUpdated(a,b,c)},this)}};var Hn=function(a,b,c,e,f,g,k){this.u6=b;this.c2=c;this.p6=e;this.KH=f;this.t6=g;this.PX=k};d=Fn.prototype;d.Ra=function(){return"ProviderManager"};
d.getData=function(){var a={};this.Tc.forEach(function(b,c){a[c]=b.getName()});return[new Hn(this.Rc.map(function(a){return a.getName()}),this.xe.A(),this.pi.A(),this.Wk,a,this.Xk.b(),this.Pq)]};d.wb=function(){var a=nf(this);if(a){this.xe.uz(a.u6);this.pi.uz(a.c2);this.Wk=a.p6;for(var b in a.KH){var c=this.Vp(a.KH[b]);this.Tc.set(b,c)}this.Xk.addAll(a.t6);a.PX&&this.uB()}};d.Zu=function(a){return this.Tc.get(a)};d.rk=function(a,b){this.Tc.set(b.id,a);this.Zh(a,b)};
d.Yh=function(a,b){this.DF(b.id);var c=this,e=function(){c.Tc.remove(b.id);c.Om.Yh(b.id);c.Zh(a,b)};this.Om.jE(b.id)?df(e,50,this):e()};d.Zh=function(){this.Lm();this.Wk&&this.NH.qu()};d.jG=function(a){var b=this.Tc.get(a.id);b&&this.Zh(b,a)};d.Sd=function(a,b,c){this.Tc.Oa(b)?this.Om.send(b,JSON.stringify(c)):E(this.a,"Got route message for closed route "+b)};d.onPresentationConnectionStateChanged=function(a,b){this.bc.onPresentationConnectionStateChanged(a,b)};
d.onPresentationConnectionClosed=function(a,b,c){if("function"!=typeof this.bc.onPresentationConnectionClosed)this.onPresentationConnectionStateChanged(a,"closed");else this.bc.onPresentationConnectionClosed(a,b,c)};d.Dw=function(a){this.vn.remove(a);var b=this.Tc.get(a);b&&b.tc(a)};d.Vq=function(a,b,c){this.MH.dispatchEvent(new Bn(b,c))};d.rc=function(){this.v6.qu()};
d.onSinkAvailabilityUpdated=function(a,b){if("function"==typeof this.bc.onSinkAvailabilityUpdated&&this.Xk.get(a.getName())!=b){var c=this.OA();this.Xk.set(a.getName(),b);a=this.OA();c!=a&&(this.bc.onSinkAvailabilityUpdated(a),0==a&&(this.xe.forEach(function(a){this.qB(a)},this),this.xe.clear()))}};d.OA=function(){return this.Xk.A().reduce(function(a,b){return Math.max(a,b)},0)};d.cv=function(){return this.MH};d.We=function(){return this.ME};d.kW=function(){return this.Rc.some(function(a){return a.Ze().some(function(a){return a.isLocal})})};
d.DF=function(a){if(this.vn.Oa(a)){var b=this;return this.kk.get(this.vn.get(a)).Hm().then(function(c){b.vn.remove(a);return c.QJ()})}return H(!1)};d.Pn=function(a,b,c){var e=a.bm(b.sinkId);this.vn.set(b.id,e);return this.kk.get(e).Hm().then(function(e){return e.Pn(b,b.mediaSource,a.bg(b.sinkId),c)})};d.mx=function(a){this.Pq?a():-1==this.Oq.indexOf(a)&&this.Oq.push(a)};d.Hv=function(){return this.Pq};d.Vp=function(a){return this.Rc.find(function(b){return b.getName()==a})||null};
d.pD=function(a){return a.startsWith("pseudo:")?a.substring(7):null};d.o2=function(a,b,c,e,f,g,k,p){var w=this.pD(a),w=w?this.Vp(w):null,B=null;w&&(B=w.sf(b,c));if(B)return this.bc.onSearchSinkIdReceived(a,B.id),this.ge(b,B.id,e,f,g,k,p);this.bc.onSearchSinkIdReceived(a,"");return Promise.reject(new sl(0,"No sink found for search input: "+c.input+" and source: "+b))};d.sf=function(a,b,c){a=(a=this.pD(a))?this.Vp(a):null;var e=null;a&&(e=a.sf(b,c));return e?e.id:""};
d.E7=function(a){this.xe.contains(a)||this.jr(a)};var In=function(a){this.C=a;this.ab=new A;this.zi=[];this.Vd=this.ik=this.Wa=this.Ve=this.Pd=null;this.Rj=this.pk=this.bh=this.Lf=!1;qf(this)};In.prototype.a=C("mr.CloudProvider");var Jn=new Ii("pseudo:cloud","","hangout","Add a hangout","default");d=In.prototype;d.getName=function(){return"cloud"};
d.jd=function(){var a=this;F(this.a,"Initializing Cloud MRP");var b=tn.O(),c=b.qR(this);this.zi.push(c);this.Pd=b.uS(this);this.zi.push(this.Pd);this.Ve=b.KC();this.Wa=b.Bj();this.ik=b.nT(this);this.Vd=b.GU();this.Vd.nR().then(function(b){a.Lf=b;F(a.a,"Cloud enabled setting: "+a.Lf)});this.Vd.pR().then(function(b){a.bh=b;F(a.a,"Cloud on setting: "+a.bh)});this.Vd.J4(function(b){a.Lf=b;F(a.a,"Cloud enabled setting: "+a.Lf);a.Lf&&a.uE()});this.Vd.HT().then(function(b){a.pk=b;F(a.a,"Privacy notified setting: "+
a.pk)})};d.Ze=function(){return this.ab.A()};d.Ul=function(a){if(!this.tq(a))return ik;G(this.a,"GetAvailableSinks for "+a);var b=[];if(this.bh||this.n6())b=this.uE();G(this.a,"Available sinks are..."+JSON.stringify(b));b=b.map(function(a){return a.qc});this.Pd&&(b=b.concat(Jn));return new hk(b,-1!=a.indexOf("0F5096E8")?uh:null)};d.uE=function(){var a=[];F(this.a,"Checking cloud discovery services");Rf.O().zq=t();this.zi.forEach(function(b){b=b.mc();a=a.concat(b)});return a};
d.Di=function(a){if((this.Wa.lg||this.Wa.Ev())&&!this.Rj){var b=Kn(a);F(this.a,"startObservingMediaSinks");G(this.a,"urn: "+a);b&&(this.Pd.Vs(b,"google.com"),this.Rj=!0,this.C.rc(),this.C.onSinkAvailabilityUpdated(this,2),F(this.a,"sinkAvailability changed to AVAILABLE"))}};d.Fi=function(a){this.tq(a)&&(F(this.a,"stopObservingMediaSinks"),G(this.a,"urn: "+a),(this.Wa.lg||this.Wa.Ev())&&this.Rj&&(a=Kn(a)))&&(this.Pd.uH(a,"google.com"),this.Rj=!1)};d.Ci=function(){};d.Ei=function(){};
d.W=function(a){return(a=this.xj(a))?a.qc:null};d.ge=function(a,b,c,e,f,g,k){F(this.a,"createRoute called");G(this.a,"urn: "+a+" sinkId:"+b);f=this.xj(b);return this.kp(a,f,b,c,e,g,k)};
d.kp=function(a,b,c,e,f,g,k){var p=this;if(f)return I(Error("not supported"));f=!1;switch(this.Yu(b)){case "cloud":wm(1);break;case "mesi":f=!0,this.pk||(this.pk=!0,this.Vd.I4(),g=new ah(dn,"notification","learn_more"),g.w5(["dismiss"]),g.V3(6320939),this.C.We().send(g)),wm(0)}Rf.O().hi=new Qf(b.re,null);var w=mk(e,this.getName(),c,a,!0,"",null);f&&(w.customControllerPath="cloud_route_details/view.html?routeId="+w.id);this.ab.set(w.id,w);this.C.rk(this,w);F(this.a,"starting mirroring on route: "+
w.id);w.qe={tabId:k,sessionId:"",DJ:"",EJ:b.re};return this.C.Pn(this,w).na(function(a){a instanceof he?p.Hi(w,6,null):(D(p.a,"Error on start mirroring",a),p.Hi(w,5,new ah(an,"warning","dismiss")));p.Pd&&p.Pd.l1(b)&&p.gf([b.qc]);throw a;})};d.tc=function(a){F(this.a,"terminating route: "+a);return(a=this.ab.get(a))?this.Hi(a,0,null):H()};
d.Hi=function(a,b,c){this.ab.remove(a.id);c&&this.We().send(c);kh("MediaRouter.Cloud.Session.End",b,rm);switch(b){case 1:break;default:this.qO(a)}this.C.Yh(this,a);return H()};d.Fg=function(a,b,c){if(c&&c.channelType){c=c.channelType;var e=(a=this.ab.get(a)||void 0)?this.xj(a.sinkId):void 0;return this.ik.m0(c,b,a,e)}if(n(b)){b=JSON.parse(b);if("STATUS_REQUEST"==b.type||"LOCAL_PRESENT"==b.type||"MUTE"==b.type)return this.ud(b,a),H();if(b.clientId)return this.yV(b,a)}return I(Error("Channel type missing"))};
d.bg=function(){return ci(!0,!0)};d.bm=function(a){var b=null;a=this.xj(a);switch(this.Yu(a)){case "cloud":b="webrtc";break;case "mesi":b="hangouts"}F(this.a,"mirror service: "+b);return b};d.wl=function(a,b){G(this.a,"Checking canRoute: "+a+" for sinkId: "+b);return this.tq(a)&&!!this.W(b)};d.Wi=function(a){return"chrome://media-router/cloudmrp-mirroring"==a};d.Kh=function(a,b){return(a=this.ab.get(b))?H(a):I(Error("not supported"))};d.dh=function(){return I(Error("not supported"))};d.Sf=function(){};
d.wG=function(a){F(this.a,a.length+" sinks added");0<a.length&&!this.bh&&(this.Vd.r7(),this.bh=!0);a=this.xj(a[0].id);Rf.O().gi=new Qf(a.re,null);this.C.rc();this.C.onSinkAvailabilityUpdated(this,2);F(this.a,"sinkAvailability changed to AVAILABLE")};d.gf=function(a){F(this.a,a.length+" sinks removed");this.zi.some(function(a){return 0<a.mc().length})||(this.C.onSinkAvailabilityUpdated(this,0),F(this.a,"sinkAvailability changed to UNAVAILABLE"));this.C.rc()};
d.rc=function(a){F(this.a,a.length+" sinks updated");this.C.rc()};d.We=function(){return this.C.We()};d.ud=function(a,b,c){c?this.C.Sd(this,b,a):this.C.Vq(this,b,a)};d.xj=function(a){var b=null;this.zi.some(function(c){if(c=c.W(a))return b=c,!!c});return b};d.qO=function(a){a=this.xj(a.sinkId);switch(this.Yu(a)){case "cloud":this.Ve.D2(a.deviceId)}};d.Yu=function(a){return a.TJ("cloud")?"cloud":a.TJ("mesi")?"mesi":null};d.n6=function(){var a=Rf.O().zq;return 3E5<=t()-a};
d.tq=function(a){var b=this;a=th(a);if(this.Wa.lg&&!this.Wa.ve&&a)return this.C.onSinkAvailabilityUpdated(this,2),!0;var c=!1;this.Lf&&this.Wa.ve&&(c=!0);c=c&&a;chrome.declarativeWebRequest||this.Wa.gX()||!this.Pd||(this.zi=this.zi.filter(function(a){return a!=b.Pd}),this.Pd=null);return c};d.sf=function(a,b){if(!this.tq(a))return null;(a=this.Pd.CM(b))&&this.wG([a]);return a};var Kn=function(a){return(a=(new yj(a)).Vf.match("__castMeetingName__=([^/]*)"))?a[1]:null};In.prototype.Ra=function(){return"CloudProvider"};
In.prototype.getData=function(){return[{hasPresentationUrlSink:this.Rj},{cloudEnabled:this.Lf,cloudOn:this.bh,notifiedHangoutsPrivacy:this.pk}]};In.prototype.wb=function(){var a=nf(this);a&&(this.Rj=a.hasPresentationUrlSink);if(a=of(this))a.cloudEnabled&&(this.Lf=a.cloudEnabled),a.cloudOn&&(this.bh=a.cloudOn),a.notifiedHangoutsPrivacy&&(this.pk=a.notifiedHangoutsPrivacy)};
In.prototype.yV=function(a,b){var c=a.clientId;return c?("client_connect"==a.type?this.ud({message:{sessionId:"castouts"},clientId:c,type:"new_session"},b,!0):"v2_message"==a.type&&"STOP"==a.message.type&&(this.ud({message:"castouts",clientId:c,type:"remove_session"},b,!0),this.tc(b)),H()):I(Error("Invalid cast message"))};var Ln=C("mr.external.MessageHandler"),Mn=["idmofbkcelhplfjnmmdolenpigiiiecc","ggedfkijiiammpnbdadhllnehapomdge","njjegkblellcjnakomndbaloifhcoccg"],Nn=0,On=function(a,b,c,e){if(c.id&&-1!=Mn.indexOf(c.id)){F(Ln,"Received a message from "+c.id+" type: "+b.type);var f=chrome.runtime.id;if("start"==b.type)b=b.message,b=a.sf("pseudo:cloud","urn:x-org.chromium.media:source:desktop",new Em(b.meetingName,b.domain)),c="PresentationId"+c.id+Nn++,a.ge("urn:x-org.chromium.media:source:desktop",b,c).then(function(a){e(new mg(f,
"route",a.id))}).catch(function(a){e(new mg(f,"error",a))});else if("stop"==b.type)a.tc(b.message.routeId),e(new mg(f,"stopped"));else return;return!0}};var Pn=function(){this.$G=r(this.BM,this);this.Id=new oi;this.Id.oy=!1;this.Id.Vr=!1;this.CE=this.Id.Pz=!1;this.pF="";this.nQ={}};Pn.prototype.e3=function(a){if(a!=this.CE){var b=Pd();a?b.yz(this.$G):b.k1(this.$G);this.CE=a}};Pn.prototype.BM=function(a){if(!this.nQ[a.sF]){var b=this.Id.VB(a),c=Qn;if(c)switch(a.Mh){case Ed:Rn(c,"info",b);break;case Fd:Rn(c,"error",b);break;case Gd:Rn(c,"warn",b);break;default:Rn(c,"debug",b)}else this.pF+=b}};var Qn=h.console,Rn=function(a,b,c){if(a[b])a[b](c);else a.log(c)};var Sn=function(){this.He=new hi(1E3);this.Id=new oi};za(Sn);d=Sn.prototype;d.init=function(){var a=this.AR();Qd("mr").Qk(a);Qd("goog").Qk(Hd);ud(Rd(Qd("browser")));Pd().yz(r(this.fZ,this));this.Id.py=!0;this.Id.Vr=!0;if(a=window.localStorage["debug.logs"]){var b={all:Ld,fine:Jd,info:Hd,warning:Gd,severe:Fd,off:Dd};Qd("mr").Qk(b[a.toLowerCase()]||Jd)}window.localStorage["debug.console"]&&(a=new Pn,a.Id.py=!0,a.Id.Vr=!0,a.Id.oy=!0,a.e3(!0))};
d.fZ=function(a){this.He.add(this.Id.VB(a));(a=a.sp)&&a.stack&&this.He.add(a.stack)};d.getLogs=function(){return 0==this.He.N()?"NA":this.He.A().join("")};d.AR=function(){return Hd};d.Y0=function(){qf(this)};d.Ra=function(){return"LogManager"};d.getData=function(){return[this.He.A()]};d.wb=function(){var a=this.He.A();this.He.clear();(nf(this)||[]).forEach(function(a){this.He.add(a)},this);a.forEach(function(a){this.He.add(a)},this)};var Tn,Un=C("mr.Init"),Vn=function(a){var b;b=new xk(a);var c=new ql(a,b);b=[b,c];b.push(new In(a));return b};Sn.O().init();Tn=new eh("MediaRouter.Provider.WakeDuration");
var Wn=new Fn,Xn=function(){var a=J();switch(window.location.host){case "enhhojjnijigcajfphajepfemndkmdlo":a.resolve();break;case "pkedcjkdefgpdelpbcmbmeomcjbeemfm":chrome.management.get("enhhojjnijigcajfphajepfemndkmdlo",function(b){chrome.runtime.lastError||!b.enabled?a.resolve():a.reject("Dev extension is enabled")});break;default:a.reject("Unknown extension id")}return a.promise}().then(function(){if(!chrome.mojoPrivate||!chrome.mojoPrivate.requireAsync)return I(Error("No mojo service loaded"));var a=
J();chrome.mojoPrivate.requireAsync("media_router_bindings").then(function(b){b.start().then(function(c){a.resolve({mrService:b,mrInstanceId:c})})});return a.promise}).then(function(a){if(!a.mrService)throw Error("Failed to get MR service");var b=a.mrInstanceId;if(!b)throw Error("Failed to get MR instance ID.");F(Un,"MR instance ID: "+b);a=a.mrService;if(!Wn)throw Error("providerManager not initialized.");a.setHandlers(Wn);sf(b)&&Tn.Rk("MediaRouter.Provider.FirstWakeDuration");chrome.runtime.onSuspend.addListener(Tn.end.bind(Tn));
wf(b);Sn.O().Y0();b=Vn(Wn);ue=function(a){var b=a;b.stack||(b=Error(a));D(Un,"Unhandled promise rejection.",b)};Wn.jd(a,b)}).na(function(a){E(Un,a.message);throw a;});
(function(a){chrome.runtime.onMessage.addListener(function(b,c,e){if(c.id==chrome.runtime.id&&"chrome-extension://"+c.id+"/feedback.html"==c.url&&"retrieve_log_data"==b.type){var f={logs:Sn.O().getLogs(),device:Rf.O().cU()},g="Chromecast"==f.device.model?lg(f.device.ip):H();a.rT("cast_streaming").then(function(a){return a.sT(b.source)}).then(function(a){f.castStreamingLogs=a}).Bb(function(){g.then(function(a){a&&(f.device.version=a)}).Bb(function(){e(f)})});return!0}});chrome.runtime.onMessageExternal.addListener(On.bind(void 0,
a))})(Wn);Xn.na(function(){window.close()});
